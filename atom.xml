<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>éšç¬”</title>
  
  <subtitle>æŠ€æœ¯ | ç”Ÿæ´»</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://mrzzcn.github.io/"/>
  <updated>2019-07-22T15:02:51.954Z</updated>
  <id>https://mrzzcn.github.io/</id>
  
  <author>
    <name>Jack</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="https://mrzzcn.github.io/2019/07/20/react-redux-1-connect/"/>
    <id>https://mrzzcn.github.io/2019/07/20/react-redux-1-connect/</id>
    <published>2019-07-20T07:15:29.000Z</published>
    <updated>2019-07-22T15:02:51.954Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0-ç¼˜èµ·"><a href="#0-ç¼˜èµ·" class="headerlink" title="0 ç¼˜èµ·"></a>0 ç¼˜èµ·</h1><p>ä¹‹å‰æœ‰æ¬¡é¢è¯•è¢«é—®èµ· <code>connect</code> æ–¹æ³•æ˜¯å¦‚ä½•æŠŠ store çš„ state ä¼ é€’åˆ° Component çš„ï¼Œå½“æ—¶æ²¡æœ‰å›ç­”åˆ°ç‚¹å­ä¸Šï¼Œæ‹–åˆ°ç°åœ¨ç»ˆäºå¼ºè¿«è‡ªå·±åä¸‹æ¥ææ¸…æ¥šè¿™ä¸ªäº‹æƒ…ã€‚</p><h1 id="1-API"><a href="#1-API" class="headerlink" title="1 API"></a>1 API</h1><p>å…ˆçœ‹çœ‹å®˜æ–¹æ–‡æ¡£å…³äº connect() æ–¹æ³•çš„è¯´æ˜ï¼š<a href="https://react-redux.js.org/api/connect" target="_blank" rel="noopener">Connect Â· React Redux</a> | <a href="https://cn.redux.js.org/docs/react-redux/api.html#connectmapstatetoprops-mapdispatchtoprops-mergeprops-options" target="_blank" rel="noopener">ä¸­æ–‡ç‰ˆ</a></p><p>å¤§æ¦‚ç¿»è¯‘ä¸€ä¸‹ï¼š<br><code>connect()</code> æ–¹æ³•æŠŠä¸€ä¸ª React ç»„ä»¶ç»‘å®šåˆ° Redux store ä¸Šã€‚<br>æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œæ–°ç»„ä»¶åŒ…å«æ‰€æœ‰ä¼ å…¥ç»„ä»¶éœ€è¦ä» store ä¸Šè·å–çš„æ•°æ®æˆ–è€…å‘ store è§¦å‘çš„æ–¹æ³•<br>connect ä¸ä¼šä¿®æ”¹ç»„ä»¶ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„<strong>ç»‘å®šç»„ä»¶</strong>åŒ…è£¹åŸç»„ä»¶ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params">mapStateToProps?, mapDispatchToProps?, mergeProps?, options?</span>)</span></span><br></pre></td></tr></table></figure></p><p>æ›´å¤šå†…å®¹è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚</p><h1 id="2-å®ç°"><a href="#2-å®ç°" class="headerlink" title="2 å®ç°"></a>2 å®ç°</h1><p>é‚£ä¹ˆ <code>connect</code> åº•å±‚æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ<br>é€šè¿‡æºç çœ‹ä¸€ä¸‹:<br>æºä»£ç ä½äºï¼š<a href="https://github.com/reduxjs/react-redux/blob/master/src/connect/connect.js#L104" target="_blank" rel="noopener">github.com/reduxjs/react-redux/connect/connect.js</a><br>è¿™é‡Œå¯¹ <code>connect</code> çš„å‚æ•°è¿›è¡Œäº†ä¸€ä¸ªé»˜è®¤å€¼å¤„ç†ï¼Œæ²¡æœ‰æ¶‰åŠæ ¸å¿ƒåŠŸèƒ½ï¼Œç»§ç»­è°ƒç”¨äº† <code>connectAdvanced</code>ï¼š<br><a href="https://github.com/reduxjs/react-redux/blob/master/src/components/connectAdvanced.js#L47" target="_blank" rel="noopener">github.com/reduxjs/react-redux/components/connectAdvanced.js</a><br>æ–¹æ³•å¾ˆé•¿ï¼Œå‰é¢éƒ½æ˜¯å¯¹ä¸€äº›è¿‡æœŸé€‰é¡¹çš„è­¦å‘Šå’Œä¸€äº›å€¼çš„å¤„ç†ã€‚æ ¸å¿ƒä»£ç ä½äº <code>ConnectFunction</code> å†…éƒ¨<br>ç¬¬ 171 è¡Œå¤„ è·å–åˆ°å½“å‰ä½¿ç”¨çš„ context<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ContextToUse = useMemo(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Users may optionally pass in a custom context instance to use instead of our ReactReduxContext.</span></span><br><span class="line">    <span class="comment">// Memoize the check that determines which context instance we should use.</span></span><br><span class="line">    <span class="keyword">return</span> propsContext &amp;&amp;</span><br><span class="line">      propsContext.Consumer &amp;&amp;</span><br><span class="line">      isContextConsumer(<span class="xml"><span class="tag">&lt;<span class="name">propsContext.Consumer</span> /&gt;</span>)</span></span><br><span class="line"><span class="xml">      ? propsContext</span></span><br><span class="line"><span class="xml">      : Context</span></span><br><span class="line"><span class="xml">  &#125;, [propsContext, Context])</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">// Retrieve the store and ancestor subscription via context, if available</span></span><br><span class="line"><span class="xml">const contextValue = useContext(ContextToUse)</span></span><br></pre></td></tr></table></figure></p><p>ç¬¬ 385 è¡Œå¤„ï¼Œæ‰§è¡Œäº†å…·ä½“çš„ <code>connect</code> è¿‡ç¨‹<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// Now that all that's done, we can finally try to actually render the child component.</span></span><br><span class="line">  <span class="comment">// We memoize the elements for the rendered child component as an optimization.</span></span><br><span class="line">  <span class="keyword">const</span> renderedWrappedComponent = useMemo(</span><br><span class="line">    () =&gt; <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...actualChildProps</span>&#125; <span class="attr">ref</span>=<span class="string">&#123;forwardedRef&#125;</span> /&gt;</span>,</span></span><br><span class="line"><span class="xml">    [forwardedRef, WrappedComponent, actualChildProps]</span></span><br><span class="line"><span class="xml">  )</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">  // If React sees the exact same element reference as last time, it bails out of re-rendering</span></span><br><span class="line"><span class="xml">  // that child, same as if it was wrapped in React.memo() or returned false from shouldComponentUpdate.</span></span><br><span class="line"><span class="xml">  const renderedChild = useMemo(() =&gt; &#123;</span></span><br><span class="line"><span class="xml">    if (shouldHandleStateChanges) &#123;</span></span><br><span class="line"><span class="xml">      // If this component is subscribed to store updates, we need to pass its own</span></span><br><span class="line"><span class="xml">      // subscription instance down to our descendants. That means rendering the same</span></span><br><span class="line"><span class="xml">      // Context instance, and putting a different value into the context.</span></span><br><span class="line"><span class="xml">      return (</span></span><br><span class="line">        &lt;ContextToUse.Provider value=&#123;overriddenContextValue&#125;&gt;</span><br><span class="line">          &#123;renderedWrappedComponent&#125;</span><br><span class="line">        &lt;/ContextToUse.Provider&gt;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return renderedWrappedComponent</span><br><span class="line">  &#125;, [ContextToUse, renderedWrappedComponent, overriddenContextValue])</span><br><span class="line"></span><br><span class="line">  return renderedChild</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå…¶å®åº•å±‚å°±æ˜¯ä½¿ç”¨ Context.Provider å‘è¢«ç»‘å®šçš„ç»„ä»¶æ³¨å…¥éœ€è¦çš„å±æ€§(åŒ…æ‹¬ mapStateToProps å’Œ dispatchç›¸å…³æ–¹æ³•)ã€‚</p><h1 id="3-è¸©å‘"><a href="#3-è¸©å‘" class="headerlink" title="3 è¸©å‘"></a>3 è¸©å‘</h1><p>æœ€åˆçœ‹ä»£ç çš„æ—¶å€™æä¸æ¸…æ¥š <code>ReactReduxContext</code> è¿™ä¸ª Context æ˜¯å¦‚ä½•è·Ÿå¤–å±‚çš„ store å…³è”èµ·æ¥çš„ï¼Œå› ä¸ºæ¼æ‰äº†æœ€å¤–å±‚çš„ <code>Provider</code> <a href="https://react-redux.js.org/api/provider" target="_blank" rel="noopener">https://react-redux.js.org/api/provider</a>ã€‚<br>react-redux æä¾›ä¸¤ç§å¼•ç”¨æ–¹å¼ï¼šåœ¨æœ€å¤–å±‚ä½¿ç”¨ react-redux æä¾›çš„ Provider ç»„ä»¶åŒ…è£¹ æˆ–è€… æ¯æ¬¡ connect æ—¶å€™éƒ½è¦ä¼ å…¥ context å®ä¾‹çš„æ–¹å¼ï¼Œä»¥æ­¤ä¿è¯å”¯ä¸€æ•°æ®æºã€‚</p><h1 id="4-å…¶ä»–"><a href="#4-å…¶ä»–" class="headerlink" title="4 å…¶ä»–"></a>4 å…¶ä»–</h1><p>æ•´ä¸ªå®ç°è¿‡ç¨‹éå¸¸å·§å¦™ï¼ŒåŒ…æ‹¬ä¸€äº›é»˜è®¤å€¼çš„å¤„ç†ï¼Œä¸€äº›æ–¹æ³•é‡è½½çš„å®ç°ï¼Œéå¸¸å€¼å¾—å‚è€ƒã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;0-ç¼˜èµ·&quot;&gt;&lt;a href=&quot;#0-ç¼˜èµ·&quot; class=&quot;headerlink&quot; title=&quot;0 ç¼˜èµ·&quot;&gt;&lt;/a&gt;0 ç¼˜èµ·&lt;/h1&gt;&lt;p&gt;ä¹‹å‰æœ‰æ¬¡é¢è¯•è¢«é—®èµ· &lt;code&gt;connect&lt;/code&gt; æ–¹æ³•æ˜¯å¦‚ä½•æŠŠ store çš„ state ä¼ é€’åˆ° Compon
      
    
    </summary>
    
      <category term="React" scheme="https://mrzzcn.github.io/categories/React/"/>
    
    
      <category term="React" scheme="https://mrzzcn.github.io/tags/React/"/>
    
      <category term="React Redux" scheme="https://mrzzcn.github.io/tags/React-Redux/"/>
    
      <category term="connect" scheme="https://mrzzcn.github.io/tags/connect/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ Heroku å’Œ mongoDB Atlas å…è´¹æ‰˜ç®¡ YApi</title>
    <link href="https://mrzzcn.github.io/2019/04/27/host-yapi-with-heroku-and-mongodb-atlas/"/>
    <id>https://mrzzcn.github.io/2019/04/27/host-yapi-with-heroku-and-mongodb-atlas/</id>
    <published>2019-04-27T01:56:48.000Z</published>
    <updated>2019-04-27T04:50:27.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0-èƒŒæ™¯"><a href="#0-èƒŒæ™¯" class="headerlink" title="0. èƒŒæ™¯"></a>0. èƒŒæ™¯</h2><p>å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸åç«¯çº¦å®šæ¥å£æ ‡å‡†ä¹‹åï¼ŒåŒæ–¹åŒæ—¶å¼€å§‹å¼€å‘ï¼Œå¯èƒ½ä¼šå‡ºç°åç«¯æ²¡æœ‰ Readyï¼Œä½†æ˜¯å‰ç«¯å·²ç»éœ€è¦ä½¿ç”¨æ¥å£çš„æƒ…å†µã€‚è¿™æ—¶å€™å°±éœ€è¦ Fake æ¥å£ã€‚æœ‰å‡ ç§æ–¹å¼ï¼š</p><table><thead><tr><th></th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>1. é¡¹ç›®ä¸­ä½¿ç”¨ Fake Promise</td><td>æ–¹ä¾¿å¿«é€Ÿ</td><td>ä¸èƒ½æ¨¡æ‹ŸçœŸå®ç½‘ç»œè¯·æ±‚ï¼Œå¯¹ä»£ç æœ‰ä¾µå…¥ï¼Œéœ€è¦åœ¨ webpack ä¸­é…ç½®è·¯å¾„æ›¿æ¢æˆ–æ‰‹åŠ¨åˆ‡æ¢æ–‡ä»¶</td></tr><tr><td>2. é¡¹ç›®ä¸­ä½¿ç”¨ mockjs ç­‰æœåŠ¡ç«¯æ–¹å¼å¯åŠ¨è‡ªæ‰˜ç®¡ mock server</td><td>æ–¹ä¾¿å¿«é€Ÿï¼ŒçœŸå®ç½‘ç»œè¯·æ±‚</td><td>å¢åŠ é¡¹ç›®ä½“ç§¯ï¼Œä¸åˆ©äºå¤šé¡¹ç›®å…±äº«åŸºç¡€è®¾æ–½ï¼Œè€—è´¹å¼€å‘æœåŠ¡å™¨æ€§èƒ½</td></tr><tr><td>3. ä½¿ç”¨å•ç‹¬çš„ mock server</td><td>çœŸå®ç½‘ç»œè¯·æ±‚ï¼Œå¯é›†æˆåç«¯æ¥å£æµ‹è¯•ï¼ŒTS ä»£ç æ¨¡æ¿ç­‰åŠŸèƒ½</td><td>éœ€è¦èŠ±ç¨å¤šæ—¶é—´ç»´æŠ¤æ¥å£</td></tr></tbody></table><p>è¿™é‡Œä»‹ç»ä¸€ä¸‹ä½¿ç”¨ç¬¬ä¸‰ç§æ–¹å¼çš„ä¸€ä¸ªå®ç°æ–¹æ³•ï¼š<strong>YApi</strong>ï¼Œå¯ä»¥å»<a href="http://yapi.demo.qunar.com/" target="_blank" rel="noopener">è¿™é‡Œ</a>ä½“éªŒã€‚<br>YApi æ˜¯ node + mongoDB é¡¹ç›®ï¼Œæœ¬ç¯‡ä»‹ç»ä¸€ä¸‹è‡ªå·±ä½¿ç”¨ Heroku å’Œ mongoDB Atlas å…è´¹éƒ¨ç½² YApi çš„è¿‡ç¨‹ã€‚</p><h2 id="1-æ³¨å†Œå¸å·"><a href="#1-æ³¨å†Œå¸å·" class="headerlink" title="1. æ³¨å†Œå¸å·"></a>1. æ³¨å†Œå¸å·</h2><p><a href="https://cloud.mongodb.com/" target="_blank" rel="noopener">https://cloud.mongodb.com/</a> æä¾›å…è´¹çš„ mongoDB æ•°æ®åº“æœåŠ¡<br><a href="https://www.heroku.com/" target="_blank" rel="noopener">https://www.heroku.com/</a> æä¾›å…è´¹çš„ node ç¨‹åºæ‰˜ç®¡æœåŠ¡</p><a id="more"></a><h2 id="2-å‡†å¤‡"><a href="#2-å‡†å¤‡" class="headerlink" title="2. å‡†å¤‡"></a>2. å‡†å¤‡</h2><h3 id="2-1-å»ºç«‹æ•°æ®åº“"><a href="#2-1-å»ºç«‹æ•°æ®åº“" class="headerlink" title="2.1 å»ºç«‹æ•°æ®åº“"></a>2.1 å»ºç«‹æ•°æ®åº“</h3><p>ç™»å½• <a href="https://cloud.mongodb.com/" target="_blank" rel="noopener">https://cloud.mongodb.com/</a> åˆ›å»º sandbox å®ä¾‹ã€‚å¾—åˆ°ç±»ä¼¼<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &lt;username&gt; ä¸ºç”¨æˆ·å</span></span><br><span class="line"><span class="comment"># &lt;password&gt; ä¸ºå¯†ç </span></span><br><span class="line"><span class="comment"># ä¿®æ”¹ç»“å°¾å¤„ test =&gt; yapi</span></span><br><span class="line">mongodb+srv://&lt;username&gt;:&lt;password&gt;@xxxx.mongodb.net/yapi?retryWrites=<span class="literal">true</span></span><br></pre></td></tr></table></figure></p><p>çš„è¿æ¥å­—ç¬¦ä¸²ã€‚</p><h3 id="2-3-å…‹éš†ä»£ç "><a href="#2-3-å…‹éš†ä»£ç " class="headerlink" title="2.3 å…‹éš†ä»£ç "></a>2.3 å…‹éš†ä»£ç </h3><p>YApi æºç ä½äº <code>https://github.com/YMFE/yapi</code> ä½ å¯ä»¥ Fork åˆ°ä½ è‡ªå·±çš„ä»“åº“ï¼Œç„¶åå…‹éš†ã€‚<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">git</span>@github.com:YMFE/yapi.git</span><br></pre></td></tr></table></figure></p><h3 id="2-4-ä¿®æ”¹å‡ è¡Œä»£ç é€‚åº”-Heroku-éƒ¨ç½²"><a href="#2-4-ä¿®æ”¹å‡ è¡Œä»£ç é€‚åº”-Heroku-éƒ¨ç½²" class="headerlink" title="2.4 ä¿®æ”¹å‡ è¡Œä»£ç é€‚åº” Heroku éƒ¨ç½²"></a>2.4 ä¿®æ”¹å‡ è¡Œä»£ç é€‚åº” Heroku éƒ¨ç½²</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> yapi</span><br><span class="line"><span class="comment"># è¿™é‡Œä½¿ç”¨æœ€æ–°ç‰ˆ 1.7.0 ï¼Œå¦‚æœæ‹…å¿ƒæœ€æ–°ç‰ˆæœ‰é—®é¢˜ä¹Ÿå¯ä»¥åˆ‡æ¢åˆ«çš„ç‰ˆæœ¬</span></span><br><span class="line"><span class="comment"># https://github.com/YMFE/yapi/releases</span></span><br><span class="line">git checkout -b dev v1.7.0 </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé…ç½®æ–‡ä»¶</span></span><br><span class="line">cp ./config_example.json ./config.js</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”±äº YApi é¡¹ç›®ä½¿ç”¨ JSON é…ç½®æ–‡ä»¶ï¼Œè€Œ JSON ä¸­ä¸èƒ½ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œæ”¹ä¸ºä½¿ç”¨ JS é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># æ‰“å¼€ config.js åœ¨ç¬¬ä¸€è¡Œ å¢åŠ  module.exports = </span></span><br><span class="line"><span class="comment"># æ‰¾åˆ° db æ®µé…ç½®</span></span><br><span class="line"><span class="comment">#    æ·»åŠ  connecString å±æ€§ï¼Œå€¼ä¸º 2.1 æ­¥å¾—åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">#    ä¿®æ”¹ user å±æ€§å€¼ä¸º 2.1 æ­¥çš„ ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">#    ä¿®æ”¹ pass å±æ€§å€¼ä¸º 2.1 æ­¥çš„ å¯†ç </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ server/yapi.js æ–‡ä»¶ </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹ä»¥ä¸‹è¡Œå†…å®¹</span></span><br><span class="line">const config = require(<span class="string">'../../config.json'</span>);</span><br><span class="line"><span class="comment"># =&gt;</span></span><br><span class="line">const config = require(<span class="string">'../config.js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ ykit.config.js </span></span><br><span class="line">configPlugin = require(<span class="string">'../config.json'</span>).plugins;</span><br><span class="line"><span class="comment"># =&gt;</span></span><br><span class="line">configPlugin = require(<span class="string">'../config.js'</span>).plugins;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ server/utils/initConfig.js</span></span><br><span class="line"><span class="built_in">let</span> configPath = path.join(runtimePath, <span class="string">'config.json'</span>);</span><br><span class="line"><span class="comment"># =&gt; </span></span><br><span class="line"><span class="built_in">let</span> configPath = path.join(runtimePath, <span class="string">'config.js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ—¥å¿—è·¯å¾„ï¼Œå› ä¸º Heroku æ ¹ç›®å½•ä¸ºåªè¯»è·¯å¾„ï¼Œä¸å…è®¸ç¨‹åºåˆ›å»ºæˆ–å†™å…¥</span></span><br><span class="line">const WEBROOT_LOG = path.join(WEBROOT_RUNTIME, <span class="string">'log'</span>);</span><br><span class="line">=&gt;</span><br><span class="line">const WEBROOT_LOG = path.resolve(__dirname, <span class="string">'log'</span>);</span><br></pre></td></tr></table></figure><h3 id="2-5-åˆå§‹åŒ–æ•°æ®åº“"><a href="#2-5-åˆå§‹åŒ–æ•°æ®åº“" class="headerlink" title="2.5 åˆå§‹åŒ–æ•°æ®åº“"></a>2.5 åˆå§‹åŒ–æ•°æ®åº“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br><span class="line">npm run install-server</span><br><span class="line"><span class="comment"># å‡ºç°ä»¥ä¸‹æ—¥å¿—ï¼Œå³è¡¨ç¤ºæ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ</span></span><br><span class="line"><span class="built_in">log</span>: mongodb load success...</span><br><span class="line">åˆå§‹åŒ–ç®¡ç†å‘˜è´¦å·æˆåŠŸ,è´¦å·åï¼š<span class="string">"admin@admin.com"</span>ï¼Œå¯†ç ï¼š<span class="string">"ymfe.org"</span></span><br></pre></td></tr></table></figure><h3 id="2-6-å¢åŠ ç¯å¢ƒå˜é‡"><a href="#2-6-å¢åŠ ç¯å¢ƒå˜é‡" class="headerlink" title="2.6 å¢åŠ ç¯å¢ƒå˜é‡"></a>2.6 å¢åŠ ç¯å¢ƒå˜é‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€ config.js</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹ port èŠ‚ç‚¹ï¼šprocess.env.PORT</span></span><br><span class="line"><span class="comment"># å› ä¸º Heroku ä¼šæä¾›ä¸€ä¸ªç«¯å£ç”¨æ¥åšè½¬å‘ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»é€šè¿‡ç¯å¢ƒå˜é‡è·å–è¿™ä¸ªç«¯å£å¹¶ç›‘å¬ï¼Œå¦åˆ™åº”ç”¨æ— æ³•å¯åŠ¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹ db èŠ‚ç‚¹åˆ°ä»¥ä¸‹å†…å®¹ï¼š</span></span><br><span class="line">  <span class="string">"db"</span>: &#123;</span><br><span class="line">    <span class="string">"connectString"</span>: process.env.connectString,</span><br><span class="line">    <span class="string">"servername"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="string">"DATABASE"</span>: <span class="string">"yapi"</span>,</span><br><span class="line">    <span class="string">"port"</span>: 27017,</span><br><span class="line">    <span class="string">"user"</span>: process.env.connectUser,</span><br><span class="line">    <span class="string">"pass"</span>: process.env.connectPass,</span><br><span class="line">    <span class="string">"authSource"</span>: <span class="string">"yapi"</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">git add .</span><br><span class="line">git commit</span><br></pre></td></tr></table></figure><h2 id="3-éƒ¨ç½²"><a href="#3-éƒ¨ç½²" class="headerlink" title="3. éƒ¨ç½²"></a>3. éƒ¨ç½²</h2><h3 id="3-1-åˆ›å»ºé¡¹ç›®"><a href="#3-1-åˆ›å»ºé¡¹ç›®" class="headerlink" title="3.1 åˆ›å»ºé¡¹ç›®"></a>3.1 åˆ›å»ºé¡¹ç›®</h3><p>ç™»å½• <a href="https://dashboard.heroku.com/" target="_blank" rel="noopener">https://dashboard.heroku.com/</a> åˆ›å»º appï¼Œä¾‹å¦‚ <code>yapi-demo</code>ï¼ˆå·²ä½¿ç”¨ï¼Œè¯·å¦å¤–å‘½åï¼‰ï¼Œåˆ›å»ºå®Œæˆä¹‹åæ¥åˆ°é¡¹ç›®é¡µé¢ï¼š<a href="https://dashboard.heroku.com/apps/yapi-demo" target="_blank" rel="noopener">https://dashboard.heroku.com/apps/yapi-demo</a></p><h3 id="3-2-é…ç½®ç¯å¢ƒå˜é‡"><a href="#3-2-é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="3.2 é…ç½®ç¯å¢ƒå˜é‡"></a>3.2 é…ç½®ç¯å¢ƒå˜é‡</h3><p>ç‚¹å‡» Settings -&gt; Reveal Config Vars<br>ä¾æ¬¡æ·»åŠ ï¼š<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">connectString:</span> <span class="string">mongodb+srv://&lt;username&gt;:&lt;password&gt;@xxxx.mongodb.net/yapi?retryWrites=true</span></span><br><span class="line"><span class="attr">connectUser:</span> <span class="string">admin</span></span><br><span class="line"><span class="attr">connectPass:</span> <span class="string">xxxxx</span></span><br></pre></td></tr></table></figure></p><h3 id="3-3-æ¨é€ä»£ç "><a href="#3-3-æ¨é€ä»£ç " class="headerlink" title="3.3 æ¨é€ä»£ç "></a>3.3 æ¨é€ä»£ç </h3><p>åœ¨é¡¹ç›®ä¸»é¡µç‚¹å‡» Deployï¼Œæ ¹æ®æç¤ºå®‰è£… <code>Heroku CLI</code> å¹¶ç™»å½•ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd yapi</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹ package.json -&gt; engines -&gt; node ä¸ºï¼š"&gt;= 7.6.0 &lt; 11"</span></span><br><span class="line"><span class="comment"># å› ä¸ºé¡¹ç›®ä½¿ç”¨äº† node-sass. node-sass çš„ linux æ”¯æŒåˆ°æ­¤ç‰ˆæœ¬ã€‚</span></span><br><span class="line">heroku git:remote -a yapi-demo</span><br><span class="line">git push heroku dev:master --force</span><br><span class="line"><span class="comment"># ç­‰å¾…æœåŠ¡å™¨å¤„ç†å®Œæˆå³å¯</span></span><br></pre></td></tr></table></figure></p><h3 id="3-4-éªŒè¯éƒ¨ç½²"><a href="#3-4-éªŒè¯éƒ¨ç½²" class="headerlink" title="3.4 éªŒè¯éƒ¨ç½²"></a>3.4 éªŒè¯éƒ¨ç½²</h3><p>æ‰“å¼€ <a href="https://yapi-demo.herokuapp.com/" target="_blank" rel="noopener">https://yapi-demo.herokuapp.com/</a>ï¼ˆå½“ç„¶ï¼Œä½ è¦æ›¿æ¢æˆä½ è‡ªå·±çš„åº”ç”¨åï¼‰ã€‚<br>é¦–æ¬¡åŠ è½½å¯èƒ½å¾ˆæ…¢ï¼Œæœ‰ä¸€ä¸ªè¶…å¤§JSï¼Œéœ€è¦åŠ è½½ä¸€åˆ†é’Ÿå·¦å³ï¼ˆå›¢é˜Ÿéœ€è¦è§£å†³ä¸‹ï¼‰ã€‚<br>ä½¿ç”¨å…ˆå‰çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•å³å¯ä½“éªŒã€‚</p><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <a href="mailto:demo@demo.com" target="_blank" rel="noopener">demo@demo.com</a>/demo ç™»å½•<a href="https://yapi-demo.herokuapp.com/" target="_blank" rel="noopener">YApi Demo</a> ä½“éªŒï¼Œè¯·å‹¿ä¿®æ”¹å¯†ç ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0-èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#0-èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;0. èƒŒæ™¯&quot;&gt;&lt;/a&gt;0. èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸åç«¯çº¦å®šæ¥å£æ ‡å‡†ä¹‹åï¼ŒåŒæ–¹åŒæ—¶å¼€å§‹å¼€å‘ï¼Œå¯èƒ½ä¼šå‡ºç°åç«¯æ²¡æœ‰ Readyï¼Œä½†æ˜¯å‰ç«¯å·²ç»éœ€è¦ä½¿ç”¨æ¥å£çš„æƒ…å†µã€‚è¿™æ—¶å€™å°±éœ€è¦ Fake æ¥å£ã€‚æœ‰å‡ ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;ä¼˜ç‚¹&lt;/th&gt;
&lt;th&gt;ç¼ºç‚¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1. é¡¹ç›®ä¸­ä½¿ç”¨ Fake Promise&lt;/td&gt;
&lt;td&gt;æ–¹ä¾¿å¿«é€Ÿ&lt;/td&gt;
&lt;td&gt;ä¸èƒ½æ¨¡æ‹ŸçœŸå®ç½‘ç»œè¯·æ±‚ï¼Œå¯¹ä»£ç æœ‰ä¾µå…¥ï¼Œéœ€è¦åœ¨ webpack ä¸­é…ç½®è·¯å¾„æ›¿æ¢æˆ–æ‰‹åŠ¨åˆ‡æ¢æ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2. é¡¹ç›®ä¸­ä½¿ç”¨ mockjs ç­‰æœåŠ¡ç«¯æ–¹å¼å¯åŠ¨è‡ªæ‰˜ç®¡ mock server&lt;/td&gt;
&lt;td&gt;æ–¹ä¾¿å¿«é€Ÿï¼ŒçœŸå®ç½‘ç»œè¯·æ±‚&lt;/td&gt;
&lt;td&gt;å¢åŠ é¡¹ç›®ä½“ç§¯ï¼Œä¸åˆ©äºå¤šé¡¹ç›®å…±äº«åŸºç¡€è®¾æ–½ï¼Œè€—è´¹å¼€å‘æœåŠ¡å™¨æ€§èƒ½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3. ä½¿ç”¨å•ç‹¬çš„ mock server&lt;/td&gt;
&lt;td&gt;çœŸå®ç½‘ç»œè¯·æ±‚ï¼Œå¯é›†æˆåç«¯æ¥å£æµ‹è¯•ï¼ŒTS ä»£ç æ¨¡æ¿ç­‰åŠŸèƒ½&lt;/td&gt;
&lt;td&gt;éœ€è¦èŠ±ç¨å¤šæ—¶é—´ç»´æŠ¤æ¥å£&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è¿™é‡Œä»‹ç»ä¸€ä¸‹ä½¿ç”¨ç¬¬ä¸‰ç§æ–¹å¼çš„ä¸€ä¸ªå®ç°æ–¹æ³•ï¼š&lt;strong&gt;YApi&lt;/strong&gt;ï¼Œå¯ä»¥å»&lt;a href=&quot;http://yapi.demo.qunar.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ä½“éªŒã€‚&lt;br&gt;YApi æ˜¯ node + mongoDB é¡¹ç›®ï¼Œæœ¬ç¯‡ä»‹ç»ä¸€ä¸‹è‡ªå·±ä½¿ç”¨ Heroku å’Œ mongoDB Atlas å…è´¹éƒ¨ç½² YApi çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;1-æ³¨å†Œå¸å·&quot;&gt;&lt;a href=&quot;#1-æ³¨å†Œå¸å·&quot; class=&quot;headerlink&quot; title=&quot;1. æ³¨å†Œå¸å·&quot;&gt;&lt;/a&gt;1. æ³¨å†Œå¸å·&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://cloud.mongodb.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://cloud.mongodb.com/&lt;/a&gt; æä¾›å…è´¹çš„ mongoDB æ•°æ®åº“æœåŠ¡&lt;br&gt;&lt;a href=&quot;https://www.heroku.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.heroku.com/&lt;/a&gt; æä¾›å…è´¹çš„ node ç¨‹åºæ‰˜ç®¡æœåŠ¡&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end" scheme="https://mrzzcn.github.io/categories/Front-end/"/>
    
    
      <category term="Heroku" scheme="https://mrzzcn.github.io/tags/Heroku/"/>
    
      <category term="mongoDB" scheme="https://mrzzcn.github.io/tags/mongoDB/"/>
    
      <category term="YApi" scheme="https://mrzzcn.github.io/tags/YApi/"/>
    
      <category term="development" scheme="https://mrzzcn.github.io/tags/development/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯å¼€å‘åŸºç¡€ä¹‹ - Webpack</title>
    <link href="https://mrzzcn.github.io/2019/04/13/Front-end-Development-1/"/>
    <id>https://mrzzcn.github.io/2019/04/13/Front-end-Development-1/</id>
    <published>2019-04-13T13:06:03.000Z</published>
    <updated>2019-05-04T08:23:44.530Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š<a href="https://www.valentinog.com/blog/webpack-tutorial" target="_blank" rel="noopener">https://www.valentinog.com/blog/webpack-tutorial</a></p></blockquote><p>Webpack 4 æ›´æ–°ä¸çŸ­æ—¶é—´äº†ï¼Œç®€å•åšä¸ªæ•´ç†ã€‚</p><blockquote><p>æœ¬æ–‡æ¼”ç¤ºåŸºäºä»“åº“ï¼š<a href="https://github.com/mrzzcn/webpack-playground" target="_blank" rel="noopener">https://github.com/mrzzcn/webpack-playground</a></p></blockquote><h2 id="1-å®Œå…¨-0-é…ç½®çš„æ¨¡å—åŒ–æ‰“åŒ…åˆ©å™¨"><a href="#1-å®Œå…¨-0-é…ç½®çš„æ¨¡å—åŒ–æ‰“åŒ…åˆ©å™¨" class="headerlink" title="1. å®Œå…¨ 0 é…ç½®çš„æ¨¡å—åŒ–æ‰“åŒ…åˆ©å™¨"></a>1. å®Œå…¨ 0 é…ç½®çš„æ¨¡å—åŒ–æ‰“åŒ…åˆ©å™¨</h2><p>ä¹ æƒ¯äº†<code>webpack.config.js</code>çš„åŒå­¦å¯èƒ½ä¸çŸ¥é“è¿™ä¸ªå˜åŒ–ï¼ŒWebpack 4 é»˜è®¤ä¸éœ€è¦é…ç½®æ–‡ä»¶äº†ï¼Œåœ¨ä¸€ä¸ªæ²¡æœ‰é…ç½®æ–‡ä»¶çš„é¡¹ç›®é‡Œè¿è¡Œ<code>webpack</code>ä¼šé»˜è®¤æŸ¥æ‰¾<code>./src/index.js</code>ï¼Œè¾“å‡ºåˆ°<code>./dist/main.js</code>ã€‚å†…éƒ¨ä½¿ç”¨äº†ä¸€ä¸ªé»˜è®¤é…ç½®æ–‡ä»¶ä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(<span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'main.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>æºç ï¼š<a href="https://github.com/mrzzcn/webpack-playground/tree/step-0" target="_blank" rel="noopener">https://github.com/mrzzcn/webpack-playground/tree/step-0</a></p></blockquote><a id="more"></a><h2 id="2-mode-production-amp-development"><a href="#2-mode-production-amp-development" class="headerlink" title="2. mode: production &amp; development"></a>2. mode: production &amp; development</h2><p>çœŸå®é¡¹ç›®ä¸­æˆ‘ä»¬ç»å¸¸ä¼šæœ‰å¤šä¸ªé…ç½®æ–‡ä»¶å¯¹åº”å¤šä¸ªç¯å¢ƒï¼š<br>development: æœ¬åœ°å¼€å‘ç¯å¢ƒï¼Œéœ€è¦å¤„ç† webpack-dev-server proxy ç­‰é…ç½®<br>testingï¼šæœ¬åœ°æµ‹è¯•<br>stageï¼šbeta ç¯å¢ƒï¼Œæ›¿æ¢åŸŸåï¼Œå‘å¸ƒåˆ°æµ‹è¯•æœåŠ¡å™¨<br>productionï¼šç”Ÿäº§ç¯å¢ƒï¼Œæ›¿æ¢åŸŸåï¼Œå‹ç¼©ï¼Œå¢åŠ æ–‡ä»¶æŒ‡çº¹æ›´æ–°ç¼“å­˜ï¼Œå‘å¸ƒåˆ° CDN ç­‰</p><p>Webpack ä¸ºæˆ‘ä»¬æä¾› <code>mode</code> é€‰é¡¹ç”¨æ¥ä½¿ç”¨ä¸€äº›é»˜è®¤çš„é…ç½®ï¼Œæœ‰ä¸‰ä¸ªå€¼ï¼š<code>development</code> | <code>production</code> | <code>none</code>ã€‚<br>å…ˆçœ‹ä¸‹ä¸æ·»åŠ  <code>mode</code> æ—¶å€™è¿è¡Œçš„ä¸€ä¸ªè­¦å‘Šï¼š<br><img src="/2019/04/13/Front-end-Development-1/webpack%20mode%20warning.png" title="Webpack mode warning"></p><blockquote><p>åŠ¨æ€æ¼”ç¤ºï¼š<a href="https://asciinema.org/a/240832" target="_blank" rel="noopener">https://asciinema.org/a/240832</a></p></blockquote><p>å¯ä»¥çœ‹åˆ° Webpack æ˜¯å¿…é¡»ä½¿ç”¨ <code>mode</code> é€‰é¡¹çš„ï¼Œå¦‚æœæ²¡æœ‰æä¾›ï¼Œå°†ä¼šä½¿ç”¨é»˜è®¤å€¼ <code>production</code>ï¼ŒåŒæ—¶ä¼šå°† <code>DefinePlugin</code> ä¸­ <code>process.env.NODE_ENV</code> çš„å€¼è®¾ç½®ä¸º <code>production</code>ã€‚<br>ä¸‰ä¸ªå€¼åŒºåˆ«å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:center">é€‰é¡¹</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">development</td><td style="text-align:left">ä¼šå°† <code>DefinePlugin</code> ä¸­ <code>process.env.NODE_ENV</code> çš„å€¼è®¾ç½®ä¸º <code>development</code>ã€‚ å¯ç”¨ <code>NamedChunksPlugin</code> å’Œ <code>NamedModulesPlugin</code>ã€‚</td></tr><tr><td style="text-align:center">production</td><td style="text-align:left">ä¼šå°† <code>DefinePlugin</code> ä¸­ <code>process.env.NODE_ENV</code> çš„å€¼è®¾ç½®ä¸º <code>production</code>ã€‚ å¯ç”¨ <code>FlagDependencyUsagePlugin</code>, <code>FlagIncludedChunksPlugin</code>, <code>ModuleConcatenationPlugin</code>, <code>NoEmitOnErrorsPlugin</code>, <code>OccurrenceOrderPlugin</code>, <code>SideEffectsFlagPlugin</code> å’Œ <code>TerserPlugin</code>ã€‚</td></tr><tr><td style="text-align:center">none</td><td style="text-align:left">ä¼šå°† <code>DefinePlugin</code> ä¸­ <code>process.env.NODE_ENV</code> çš„å€¼è®¾ç½®ä¸º <code>none</code>ã€‚ é€€å‡ºä»»ä½•é»˜è®¤ä¼˜åŒ–é€‰é¡¹</td></tr></tbody></table><blockquote><p>å…³äº <code>mode</code> çš„æ›´å¤šå…·ä½“ä¿¡æ¯ï¼Œè¯·æŸ¥é˜…ï¼š<a href="https://webpack.docschina.org/concepts/mode/" target="_blank" rel="noopener">https://webpack.docschina.org/concepts/mode/</a><br>æºç ï¼š<a href="https://github.com/mrzzcn/webpack-playground/tree/step-1" target="_blank" rel="noopener">https://github.com/mrzzcn/webpack-playground/tree/step-1</a></p></blockquote><h2 id="3-æ›´æ”¹é»˜è®¤çš„å…¥å£æ–‡ä»¶å’Œè¾“å‡ºï¼Ÿä¹Ÿå¯ä»¥ï¼"><a href="#3-æ›´æ”¹é»˜è®¤çš„å…¥å£æ–‡ä»¶å’Œè¾“å‡ºï¼Ÿä¹Ÿå¯ä»¥ï¼" class="headerlink" title="3. æ›´æ”¹é»˜è®¤çš„å…¥å£æ–‡ä»¶å’Œè¾“å‡ºï¼Ÿä¹Ÿå¯ä»¥ï¼"></a>3. æ›´æ”¹é»˜è®¤çš„å…¥å£æ–‡ä»¶å’Œè¾“å‡ºï¼Ÿä¹Ÿå¯ä»¥ï¼</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// package.json</span><br><span class="line">"scripts": &#123;</span><br><span class="line">  "start": "webpack",</span><br><span class="line">  "build:dev": "webpack --mode development ./src/index.js --output ./dist/foo/main.js",</span><br><span class="line">  "build": "webpack --mode production ./src/index.js --output ./dist/bar/main.js"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æºç ï¼š<a href="https://github.com/mrzzcn/webpack-playground/tree/step-2" target="_blank" rel="noopener">https://github.com/mrzzcn/webpack-playground/tree/step-2</a></p></blockquote><h2 id="4-ES6-with-Babel-7"><a href="#4-ES6-with-Babel-7" class="headerlink" title="4. ES6 with Babel 7"></a>4. ES6 with Babel 7</h2><p>ç°åœ¨å†™ JS åŸºæœ¬ç¦»ä¸å¼€ ES6ï¼Œä½¿ç”¨ ES6 å°±æ„å‘³ç€å¿…é¡»ä½¿ç”¨ç¼–è¯‘å™¨ã€‚webpack ä½¿ç”¨ babel-loader å¤„ç† JSï¼ŒæŠŠ ES6 ä»¥ä¸Šçš„è¯­æ³•ç¼–è¯‘åˆ° ES5 é€‚é…å¤§å¤šæ•°æµè§ˆå™¨ã€‚<br>Babel 7 æ˜¯ Babel çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä½¿ç”¨ä¹‹å‰éœ€è¦å¼•ç”¨ä»¥ä¸‹ä¾èµ–ï¼š</p><ol><li>babel core</li><li>babel loader</li><li>babel preset env</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @babel/core babel-loader @babel/preset-env --save-dev</span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®æ ¹ç›®å½•å¢åŠ æ–‡ä»¶ï¼š<code>.babelrc</code><br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"presets"</span>: [</span><br><span class="line">        <span class="string">"@babel/preset-env"</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸‹ä¸€æ­¥ï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ç”¨ babel-loader:</p><ul><li>æ·»åŠ é…ç½®æ–‡ä»¶<code>webpack.config.js</code></li><li>ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°é€‰é¡¹<code>--module-bind</code></li></ul><p>webpack4 å·ç§°æ˜¯ <strong>0é…ç½®</strong> çš„ï¼Œè¿™é‡Œä¸ºå•¥åˆå‡ºæ¥é…ç½®æ–‡ä»¶å‘¢ï¼Ÿå…¶å® webpack4 <strong>0é…ç½®</strong> çš„ä½œç”¨æ˜¯æœ‰é™çš„ï¼š</p><ul><li>å…¥å£ (entry point)ï¼Œé»˜è®¤å€¼ä¸ºï¼š<code>src/index.js</code></li><li>è¾“å‡º (output)ï¼Œé»˜è®¤å€¼ä¸ºï¼š<code>dist/main.js</code></li><li>mode (production or development)</li></ul><p>ä¸€èˆ¬çš„ä½¿ç”¨æ˜¯è¶³å¤Ÿäº†çš„ï¼Œä¸è¿‡å¦‚æœæƒ³è¦ä½¿ç”¨è‡ªå®šä¹‰çš„ loader è¿˜æ˜¯å¿…é¡»åˆ›å»º config æ–‡ä»¶çš„ï¼Œæºå¼•ä½œè€… Sean çš„ä¸€æ®µå›ç­”ï¼š</p><blockquote><p>Q: Will loaders in webpack 4 work the same as webpack 3? Is there any plan to provide 0 conf for common loaders like babel-loader?<br>A: â€œFor the future (after v4, maybe 4.x or 5.0), we have already started the exploration of how a preset or addon system will help define this. What we donâ€™t want: To try and shove a bunch of things into core as defaults What we do want: Allow other to extendâ€</p></blockquote><h3 id="å€ŸåŠ©é…ç½®æ–‡ä»¶webpack-config-jsä½¿ç”¨-babel-loader"><a href="#å€ŸåŠ©é…ç½®æ–‡ä»¶webpack-config-jsä½¿ç”¨-babel-loader" class="headerlink" title="å€ŸåŠ©é…ç½®æ–‡ä»¶webpack.config.jsä½¿ç”¨ babel-loader"></a>å€ŸåŠ©é…ç½®æ–‡ä»¶<code>webpack.config.js</code>ä½¿ç”¨ babel-loader</h3><p>æŒ‰ä½ ç†Ÿæ‚‰çš„æ–¹å¼æ·»åŠ æ–‡ä»¶<code>webpack.config.js</code>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">"babel-loader"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>åœ¨ <code>src/index.js</code> é‡Œé¢æ·»åŠ ä¸€äº› ES6 ä»£ç ã€‚é‡æ–°ç¼–è¯‘ï¼Œçœ‹çœ‹ç»“æœæ˜¯ä¸æ˜¯å’Œä½ é¢„æƒ³çš„ä¸€æ ·å‘¢ï¼Ÿä½¿ç”¨è¿™ç§æ–¹å¼è¿˜å¯ä»¥æŸ¥çœ‹ ES6 ç±»çš„è¿è¡Œæœºåˆ¶ã€‚</p><h3 id="ä¸æ·»åŠ é…ç½®æ–‡ä»¶å¯ç”¨-babel-loader-çš„æ–¹æ³•"><a href="#ä¸æ·»åŠ é…ç½®æ–‡ä»¶å¯ç”¨-babel-loader-çš„æ–¹æ³•" class="headerlink" title="ä¸æ·»åŠ é…ç½®æ–‡ä»¶å¯ç”¨ babel-loader çš„æ–¹æ³•"></a>ä¸æ·»åŠ é…ç½®æ–‡ä»¶å¯ç”¨ babel-loader çš„æ–¹æ³•</h3><p>çš„ç¡®æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥ä¸éœ€è¦é…ç½®æ–‡ä»¶ï¼Œé‚£å°±æ˜¯<code>--module-bind</code>é€‰é¡¹ï¼Œè¿™æ˜¯ webpack3 å¼•å…¥çš„ã€‚<br>åˆ é™¤ <code>webpack.config.js</code>ã€‚<br>æ›´æ”¹ npm scriptsï¼Œæ·»åŠ å‚æ•°ï¼š<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "start": "webpack",</span><br><span class="line">  "build:dev": "webpack --mode development ./src/index.js --output ./dist/foo/main.js --module-bind js=babel-loader",</span><br><span class="line">  "build": "webpack --mode production ./src/index.js --output ./dist/bar/main.js --module-bind js=babel-loader"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é‡æ–°ç¼–è¯‘ï¼Œçœ‹å’Œä¸Šä¸€æ­¥çš„ç¼–è¯‘ç»“æœæ˜¯å¦ç›¸åŒã€‚</p><blockquote><p><em>è¿™ç§ç”¨æ³•ä¼šè®© ç¼–è¯‘å‘½ä»¤å˜é•¿ä»è€Œç ´åå¯è¯»æ€§ï¼Œäº†è§£å³å¯ï¼Œä¸æ¨èåœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</em></p></blockquote><blockquote><p>æºç ï¼š<a href="https://github.com/mrzzcn/webpack-playground/tree/step-3" target="_blank" rel="noopener">https://github.com/mrzzcn/webpack-playground/tree/step-3</a></p></blockquote><h2 id="5-React"><a href="#5-React" class="headerlink" title="5. React"></a>5. React</h2><p>ç»å¸¸æœ‰äººä¼šè¯´ React æ¯”è¾ƒé‡ï¼Œå­¦ä¹ æ›²çº¿é™¡å³­ï¼Œå…¶å®ï¼Œå¦‚æœä½ ä½¿ç”¨ ES6 å’Œ babelï¼Œé…ç½® React ç›¸å½“å®¹æ˜“ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i react react-dom --save-dev</span><br><span class="line">npm i @babel/preset-react --save-dev</span><br></pre></td></tr></table></figure></p><p>åœ¨<code>.babelrc</code> ä¸­é…ç½® React preset<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [<span class="string">"@babel/preset-env"</span>, <span class="string">"@babel/preset-react"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®Œäº†ï¼<br>å¦‚æœä½ æ›´å–œæ¬¢<code>.jsx</code>åç¼€åæ¥åŒºåˆ†æ™®é€šçº¯ JS æ–‡ä»¶å’Œ åŒ…å« <code>JSX</code> è¯­æ³•çš„ React é¡µé¢æˆ–ç»„ä»¶ï¼Œéœ€è¦åœ¨<code>webpack.config.js</code>æ–‡ä»¶ä¸­é…ç½® JSX æ”¯æŒï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(js|jsx)$/</span>, <span class="comment">// æ­¤å¤„å¢åŠ  jsx åç¼€åè¯†åˆ«</span></span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">"babel-loader"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œæ·»åŠ æ–‡ä»¶ï¼š<code>./src/App.jsx</code>:<br><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;React here!<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">export default App;</span></span><br><span class="line"><span class="regexp">ReactDOM.render(&lt;App /</span>&gt;, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>));</span><br></pre></td></tr></table></figure></p><p>åœ¨å…¥å£æ–‡ä»¶<code>./src/index.js</code>ä¸­æ·»åŠ ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.jsx'</span>;</span><br></pre></td></tr></table></figure></p><p>é‡æ–°ç¼–è¯‘ï¼Œä½ ä¼šå‘ç°è¾“å‡ºå†…å®¹å˜å¤šäº†ä¸å°‘ï¼Œå› ä¸º React åº“è¢«æ‰“åŒ…è¿›æ¥ï¼Œä¸è¿‡åœ¨æ–‡ä»¶ç»“å°¾å¤„ï¼Œä½ ä»ç„¶å¯ä»¥åˆ†è¾¨å‡ºæ¥æˆ‘ä»¬ç¼–å†™çš„ React ç»„ä»¶è¢«ç¼–è¯‘ä¹‹åçš„æ ·å­ã€‚</p><blockquote><p><em>ä¸€æ—¦ç†è§£äº†åº”ç”¨ç¨‹åºçš„æœ¬è´¨ï¼šæ•°æ®ç»“æ„+ç®—æ³•ï¼Œä½ ä¼šè§‰å¾— React çš„è®¾è®¡æœ‰å¤šä¹ˆå¹²å‡€ã€çº¯ç²¹ï¼Œä½ ä¼šè§‰å¾—è‡ªå·±åŸæ¥ä½¿ç”¨æ¨¡æ¿å¼•æ“æ‹¼å‡‘ä»£ç çš„æ–¹å¼ç®€ç›´åƒæ•°å­—æ—¶ä»£çš„åŸå§‹äººã€‚è€Œä¸€æ—¦å†™åˆ°è¡¨å•éƒ¨åˆ†ï¼Œä½ ä¼šçªç„¶å‘ç°åšä¸ªåŸå§‹äººæŒºå¿«ä¹çš„ã€‚ã€‚ã€‚ğŸ˜‚</em></p></blockquote><h3 id="HTML-webpack-plugin"><a href="#HTML-webpack-plugin" class="headerlink" title="HTML webpack plugin"></a>HTML webpack plugin</h3><p>ç»„ä»¶éœ€è¦å±•ç¤ºå‡ºæ¥ï¼Œå¦‚æœæƒ³è¦â€œçœ‹è§â€ï¼Œéœ€è¦æŠŠç¼–è¯‘çš„ç»“æœå‘ˆç°åœ¨ç½‘é¡µä¸Šï¼Œwebpack ä½¿ç”¨ <code>html-webpack-plugin</code> å’Œ <code>html-loader</code> æ¥å¤„ç† HTML æ–‡ä»¶ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i html-webpack-plugin html-loader --save-dev</span><br></pre></td></tr></table></figure></p><p>æ·»åŠ <code>src/index.html</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>webpack 4 quickstart<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç¼–è¾‘<code>webpack.config.js</code>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebPackPlugin = <span class="built_in">require</span>(<span class="string">"html-webpack-plugin"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(js|jsx)$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">"babel-loader"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.html$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">"html-loader"</span>,</span><br><span class="line">            options: &#123; <span class="attr">minimize</span>: <span class="literal">false</span> &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebPackPlugin(&#123;</span><br><span class="line">      template: <span class="string">"./src/index.html"</span>,</span><br><span class="line">      filename: <span class="string">"./index.html"</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>é‡æ–°ç¼–è¯‘ï¼Œçœ‹ä¸€ä¸‹<code>dist</code>æ–‡ä»¶å¤¹ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°ç¼–è¯‘äº§ç”Ÿçš„ html æ–‡ä»¶ï¼Œä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå³å¯é¢„è§ˆåˆšæ‰ç¼–å†™çš„ React ç»„ä»¶ã€‚<br>æ— éœ€æ‰‹åŠ¨æ·»åŠ  JS å¼•ç”¨ï¼Œwebpack ä¼šæŠŠç¼–è¯‘è¾“å‡ºçš„ <strong>èµ„æº</strong> è‡ªåŠ¨æ³¨å…¥åˆ° Html æ–‡ä»¶ç›¸åº”ä½ç½®ã€‚</p><blockquote><p>æºç ï¼š<a href="https://github.com/mrzzcn/webpack-playground/tree/step-4" target="_blank" rel="noopener">https://github.com/mrzzcn/webpack-playground/tree/step-4</a></p></blockquote><h2 id="6-VUE"><a href="#6-VUE" class="headerlink" title="6. VUE"></a>6. VUE</h2><p>VUE å¯¹åˆå­¦è€…éå¸¸å‹å¥½ï¼Œæœ‰å¾ˆå¤šAPIï¼Œå‡ ä¹ä½ èƒ½æƒ³åˆ°çš„ä»–å…¨éƒ½ä¸ºä½ åšäº†ã€‚è€Œä¸”å®˜ç½‘çš„æ–‡æ¡£å¾ˆè¯¦ç»†ï¼Œå„ç§è¯­è¨€ç‰ˆæœ¬éƒ½æœ‰ã€‚é‡è¦çš„æ˜¯ï¼Œå¯¹äºæ—§é¡¹ç›®ï¼ˆéMV**æ¡†æ¶çš„é¡¹ç›®ï¼‰è€Œè¨€ï¼Œä½¿ç”¨ VUE é‡æ„éå¸¸æ–¹ä¾¿ã€‚<br>åœ¨ webpack é¡¹ç›®é‡Œä½¿ç”¨ VUEä¹Ÿå¾ˆæ–¹ä¾¿ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i vue --save-dev</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹ <code>./src/index.js</code>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    message: <span class="string">'Hello Vue!'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  template: <span class="string">`&lt;div&gt;&#123;&#123;message&#125;&#125;&lt;/div&gt;`</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹<code>webpack.config.js</code>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">resolve: &#123;</span><br><span class="line">  alias: &#123;</span><br><span class="line">    vue$: <span class="string">"vue/dist/vue.esm.js"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p>å…³äº VUE çš„ ä¸åŒæ„å»ºç‰ˆæœ¬çš„è§£é‡Š è¯·ç§»æ­¥ï¼š<a href="https://cn.vuejs.org/v2/guide/installation.html#%E5%AF%B9%E4%B8%8D%E5%90%8C%E6%9E%84%E5%BB%BA%E7%89%88%E6%9C%AC%E7%9A%84%E8%A7%A3%E9%87%8A" target="_blank" rel="noopener">ä¸åŒæ„å»ºç‰ˆæœ¬çš„è§£é‡Š</a></p></blockquote><p>é‡æ–°ç¼–è¯‘ï¼Œåˆ·æ–°é¢„è§ˆï¼Œå¯ä»¥çœ‹åˆ° VUE å®ä¾‹å·²ç»æ³¨å…¥åˆ°é¡µé¢ä¸­ã€‚</p><blockquote><p>æºç ï¼š<a href="https://github.com/mrzzcn/webpack-playground/tree/step-5" target="_blank" rel="noopener">https://github.com/mrzzcn/webpack-playground/tree/step-5</a></p></blockquote><h2 id="7-CSS"><a href="#7-CSS" class="headerlink" title="7. CSS"></a>7. CSS</h2><p>webpack é»˜è®¤ä¸ä¼šå§ CSS å†…å®¹æå–åˆ°å•ç‹¬çš„ css æ–‡ä»¶é‡Œã€‚ä¹‹å‰æˆ‘ä»¬ç”¨ <code>extract-text-webpack-plugin</code> åšè¿™ä»¶äº‹ï¼Œä¸å¹¸çš„æ˜¯ è¿™ä¸ªæ’ä»¶å¯¹ webpack4 çš„æ”¯æŒå¹¶ä¸ååˆ†å‹å¥½ã€‚</p><blockquote><p>Michael Ciniawsky: <strong>extract-text-webpack-plugin</strong> <em>reached a point where maintaining it become too much of a burden and itâ€™s not the first time upgrading a major webpack version was complicated and cumbersome due to issues with it.</em></p></blockquote><p>ä¸è¿‡ä¸ç”¨ç€æ€¥ï¼Œæˆ‘ä»¬æœ‰ <code>mini-css-extract-plugin</code>ï¼ˆéœ€è¦ webpack 4.2.X ä»¥ä¸Šï¼‰ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mini-css-extract-plugin css-loader --save-dev</span><br></pre></td></tr></table></figure></p><p>æ·»åŠ  loader å’Œ æå–æ’ä»¶<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebPackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(js|jsx)$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'babel-loader'</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.html$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'html-loader'</span>,</span><br><span class="line">            options: &#123; <span class="attr">minimize</span>: <span class="literal">false</span> &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [MiniCssExtractPlugin.loader, <span class="string">'css-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      vue$: <span class="string">'vue/dist/vue.esm.js'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebPackPlugin(&#123;</span><br><span class="line">      template: <span class="string">'./src/index.html'</span>,</span><br><span class="line">      filename: <span class="string">'./index.html'</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'[name].css'</span>,</span><br><span class="line">      chunkFilename: <span class="string">'[name].[id].css'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>æ·»åŠ  css æ–‡ä»¶<code>src/main.css</code>:<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">2</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨ <code>src/index.js</code>ä¸­å¼•å…¥ css æ–‡ä»¶ï¼š<code>import &#39;./main.css&#39;;</code><br>é‡æ–°ç¼–è¯‘ï¼Œåˆ·æ–°é¢„è§ˆï¼Œä½ ä¼šå‘ç°é¡µé¢æ–‡å­—å˜å¾—æ›´é«˜ï¼ŒèƒŒæ™¯ä¹Ÿå˜æˆæ›´æ¸…æ–°çš„ç»¿è‰²ã€‚</p><blockquote><p>æºç ï¼š<a href="https://github.com/mrzzcn/webpack-playground/tree/step-6" target="_blank" rel="noopener">https://github.com/mrzzcn/webpack-playground/tree/step-6</a></p></blockquote><h2 id="8-webpack-dev-server"><a href="#8-webpack-dev-server" class="headerlink" title="8. webpack dev server"></a>8. webpack dev server</h2><p>æ¯æ¬¡æ›´æ”¹ä»£ç éƒ½è¦é‡æ–°ç¼–è¯‘ï¼Œæ‰‹åŠ¨åˆ·æ–°ï¼Œæ˜¯ä¸æ˜¯å¾ˆçƒ¦ï¼Œä½¿ç”¨ <a href="https://github.com/webpack/webpack-dev-server" target="_blank" rel="noopener">webpack dev server</a>å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œå¯ä»¥å¤§å¤§æ–¹ä¾¿æˆ‘ä»¬çš„å¼€å‘è°ƒè¯•è¿‡ç¨‹ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack-dev-server --save-dev</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹ npm scripts:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "start": "webpack-dev-server --mode development --open", // ä½¿ç”¨ webpack-dev-server å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span><br><span class="line">  "build:dev": "webpack --mode development",</span><br><span class="line">  "build": "webpack --mode production"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç»ˆç«¯å¯åŠ¨ <code>npm start</code> ã€‚<br>webpack ä¼šå¯åŠ¨å¼€å‘æœåŠ¡å™¨å¹¶åœ¨é»˜è®¤æµè§ˆå™¨ä¸­æ‰“å¼€é¢„è§ˆé¡µé¢ï¼Œéšæ„æ›´æ”¹æºä»£ç ï¼Œç¨ç­‰å‡ ç§’é¡µé¢å³å¯è‡ªåŠ¨åˆ·æ–°ã€‚</p><blockquote><p>æºç ï¼š<a href="https://github.com/mrzzcn/webpack-playground/tree/step-7" target="_blank" rel="noopener">https://github.com/mrzzcn/webpack-playground/tree/step-7</a></p></blockquote><h2 id="9-Proxy"><a href="#9-Proxy" class="headerlink" title="9. Proxy"></a>9. Proxy</h2><p>å‰ç«¯å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°å¤šç«¯åŒæ­¥å¼€å§‹çš„æƒ…å†µã€‚æ¯”å¦‚ï¼Œéœ€æ±‚å®šä¸‹æ¥ä¹‹åï¼Œè®¾è®¡ã€å‰ç«¯ã€åç«¯éƒ½å¼€å§‹å·¥ä½œï¼Œå‰ã€åç«¯ä¾èµ–ä¸å…±åŒçº¦å®šçš„æ¥å£å¼€å‘ï¼Œæœ€ååŒæ–¹éƒ½ Ready å†è”è°ƒã€‚åç«¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨æµè§ˆå™¨ã€Postmanã€CURLç­‰å·¥å…·å‘èµ·è¯·æ±‚è¿›è¡Œæµ‹è¯•ã€‚ä½†æ˜¯å‰ç«¯åœ¨æ²¡æœ‰åç«¯æ¥å£çš„æƒ…å†µä¸‹ä¹Ÿè¦ç»§ç»­å·¥ä½œï¼Œè¿™æ—¶å€™å°±éœ€è¦æ¨¡æ‹Ÿåç«¯æ¥å£ã€‚<br>ä¿®æ”¹<code>webpack.config.js</code>ï¼Œ<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¢åŠ ä»¥ä¸‹èŠ‚ç‚¹ï¼š</span></span><br><span class="line">devServer: &#123;</span><br><span class="line">  proxy: &#123;</span><br><span class="line">    <span class="string">'/api'</span>: &#123;</span><br><span class="line">      target: <span class="string">'https://yapi-demo.herokuapp.com/mock/16'</span>,</span><br><span class="line">      changeOrigin: <span class="literal">true</span>,</span><br><span class="line">      pathRewrite: &#123; <span class="string">'^/api'</span>: <span class="string">''</span> &#125;,</span><br><span class="line">      toProxy: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹ <code>src/index.js</code>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./main.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    message: <span class="string">'Hello Vue !'</span> + <span class="keyword">new</span> <span class="built_in">Date</span>().toTimeString(),</span><br><span class="line">    posts: []</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    fetch(<span class="string">'/api/posts'</span>)</span><br><span class="line">      .then(<span class="function"><span class="params">res</span> =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function"><span class="params">posts</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.posts = posts;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  template: <span class="string">`&lt;div&gt;</span></span><br><span class="line"><span class="string">  &#123;&#123;message&#125;&#125;</span></span><br><span class="line"><span class="string">  &lt;hr/&gt;</span></span><br><span class="line"><span class="string">  Total &#123;&#123;posts.length&#125;&#125; posts: </span></span><br><span class="line"><span class="string">  &lt;ul&gt;</span></span><br><span class="line"><span class="string">    &lt;li v-for="post in posts" key=&#123;&#123;post.id&#125;&#125;&gt;&#123;&#123;post.title&#125;&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="string">  &lt;/ul&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;`</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>ä¿å­˜ï¼Œé‡æ–°å¯åŠ¨å¼€å‘æœåŠ¡å™¨ã€‚<br>åœ¨æ‰“å¼€çš„æµè§ˆå™¨çª—å£ä¸­å¯ä»¥é¢„è§ˆåˆ©ç”¨ mock server æ¨¡æ‹Ÿåç«¯æ¥å£çš„åº”ç”¨ç¨‹åºé¢„è§ˆã€‚</p><blockquote><p>å…³äºä»£ç†æœåŠ¡å™¨ <code>https://yapi-demo.herokuapp.com/mock/16</code> çš„æ­å»ºï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://mrzzcn.github.io/2019/04/27/host-yapi-with-heroku-and-mongodb-atlas/">ä½¿ç”¨ Heroku å’Œ mongoDB Atlas å…è´¹æ‰˜ç®¡ YApi</a> å’Œ <a href="https://yapi.ymfe.org/" target="_blank" rel="noopener">YApi å®˜ç½‘</a><br>YApi æ˜¯æˆ‘è§è¿‡æœ€ä¼˜ç§€çš„ Api ç®¡ç†è½¯ä»¶ï¼ŒåŒç±»è½¯ä»¶è¿˜æœ‰ zan-proxy å’Œ nei ç­‰ï¼Œä¸è¿‡åŠŸèƒ½ç›¸å¯¹è¾ƒå¼±ã€‚åé¢æˆ‘ä¼šå†™æ–‡ç« ç»§ç»­ä»‹ç» YApi çš„é«˜çº§ç”¨æ³•ï¼ŒåŒ…æ‹¬æ•°æ®æ¨¡æ‹Ÿã€åŠ¨æ€æœŸæœ›ã€é›†æˆå¯¹åç«¯Apiçš„è‡ªåŠ¨åŒ–æµ‹è¯•ç­‰ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://www.valentinog.com/blog/webpack-tutorial&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.valentinog.com/blog/webpack-tutorial&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Webpack 4 æ›´æ–°ä¸çŸ­æ—¶é—´äº†ï¼Œç®€å•åšä¸ªæ•´ç†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡æ¼”ç¤ºåŸºäºä»“åº“ï¼š&lt;a href=&quot;https://github.com/mrzzcn/webpack-playground&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/mrzzcn/webpack-playground&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;1-å®Œå…¨-0-é…ç½®çš„æ¨¡å—åŒ–æ‰“åŒ…åˆ©å™¨&quot;&gt;&lt;a href=&quot;#1-å®Œå…¨-0-é…ç½®çš„æ¨¡å—åŒ–æ‰“åŒ…åˆ©å™¨&quot; class=&quot;headerlink&quot; title=&quot;1. å®Œå…¨ 0 é…ç½®çš„æ¨¡å—åŒ–æ‰“åŒ…åˆ©å™¨&quot;&gt;&lt;/a&gt;1. å®Œå…¨ 0 é…ç½®çš„æ¨¡å—åŒ–æ‰“åŒ…åˆ©å™¨&lt;/h2&gt;&lt;p&gt;ä¹ æƒ¯äº†&lt;code&gt;webpack.config.js&lt;/code&gt;çš„åŒå­¦å¯èƒ½ä¸çŸ¥é“è¿™ä¸ªå˜åŒ–ï¼ŒWebpack 4 é»˜è®¤ä¸éœ€è¦é…ç½®æ–‡ä»¶äº†ï¼Œåœ¨ä¸€ä¸ªæ²¡æœ‰é…ç½®æ–‡ä»¶çš„é¡¹ç›®é‡Œè¿è¡Œ&lt;code&gt;webpack&lt;/code&gt;ä¼šé»˜è®¤æŸ¥æ‰¾&lt;code&gt;./src/index.js&lt;/code&gt;ï¼Œè¾“å‡ºåˆ°&lt;code&gt;./dist/main.js&lt;/code&gt;ã€‚å†…éƒ¨ä½¿ç”¨äº†ä¸€ä¸ªé»˜è®¤é…ç½®æ–‡ä»¶ä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; path = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;path&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  entry: &lt;span class=&quot;string&quot;&gt;&#39;./src/index.js&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  output: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    path: path.resolve(&lt;span class=&quot;string&quot;&gt;&#39;dist&#39;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    filename: &lt;span class=&quot;string&quot;&gt;&#39;main.js&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;æºç ï¼š&lt;a href=&quot;https://github.com/mrzzcn/webpack-playground/tree/step-0&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/mrzzcn/webpack-playground/tree/step-0&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Technology" scheme="https://mrzzcn.github.io/categories/Technology/"/>
    
      <category term="Front-end" scheme="https://mrzzcn.github.io/categories/Technology/Front-end/"/>
    
    
      <category term="Front-end" scheme="https://mrzzcn.github.io/tags/Front-end/"/>
    
      <category term="Development" scheme="https://mrzzcn.github.io/tags/Development/"/>
    
  </entry>
  
  <entry>
    <title>å¼ºåŒ–ç½‘ç«™å®‰å…¨ - ç¬¬ä¸€ç¯‡ï¼šå®‰å…¨ç›¸å…³çš„Headers (Hardening Website Security â€“ Part 1: HTTP Security Headers)</title>
    <link href="https://mrzzcn.github.io/2019/01/11/HTTP-Security-Headers/"/>
    <id>https://mrzzcn.github.io/2019/01/11/HTTP-Security-Headers/</id>
    <published>2019-01-11T07:40:44.000Z</published>
    <updated>2019-04-27T01:43:35.927Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åŸæ–‡ï¼š<a href="https://int64software.com/blog/2018/11/05/hardening-website-security-part-1-http-security-headers/" target="_blank" rel="noopener">Hardening Website Security â€“ Part 1: HTTP Security Headers</a></p></blockquote><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æ„Ÿè§‰æ¯å‘¨éƒ½ä¼šå‡ºç°æ–°çš„ä¸ªäººä¿¡æ¯è¢«ç›—äº‹ä»¶ï¼ŒåŸå› æ˜¯æŸä¸€å®¶å…¬å¸ç½‘ç«™è¢«<strong>é»‘</strong>äº†ã€‚   </p><p>å¤§éƒ¨åˆ†æ”»å‡»éƒ½æ˜¯é€šè¿‡ç¤¾ä¼šå·¥ç¨‹å­¦è¯±éª—æŸäº›ç”¨æˆ·ä¸»åŠ¨æäº¤ä¸€äº›ä¿¡æ¯ï¼Œé»‘å®¢å€ŸåŠ©è¿™äº›ä¿¡æ¯è·å–æ›´é«˜æƒé™å¹¶æœ€ç»ˆè·å–ä¸ªäººèµ„æ–™ã€‚   </p><p>å¦‚æœä½ æƒ³è¦åœ¨21ä¸–çºªè¿è¥ä¸€ä¸ªå®‰å…¨çš„ç½‘ç«™ï¼Œä½ éœ€è¦éµå¾ªä¸€äº›å®‰å…¨å‡†åˆ™ï¼Œæˆ‘ä¼šå†™ä¸€ä¸ªç³»åˆ—ä¸“æ è¯´æ˜è¿™äº›å®‰å…¨å‡†åˆ™ï¼Œè¿™æ˜¯ç¬¬ä¸€ç¯‡ã€‚<br><a id="more"></a></p><h2 id="æœ¬æ–‡ä¸ä¼šä»‹ç»ä»¥ä¸‹å†…å®¹"><a href="#æœ¬æ–‡ä¸ä¼šä»‹ç»ä»¥ä¸‹å†…å®¹" class="headerlink" title="æœ¬æ–‡ä¸ä¼šä»‹ç»ä»¥ä¸‹å†…å®¹"></a>æœ¬æ–‡ä¸ä¼šä»‹ç»ä»¥ä¸‹å†…å®¹</h2><p>å› ä¸ºç½‘ç»œåŸºç¡€æ¶æ„çš„å®‰å…¨é…ç½®å†…å®¹å¤ªå¤šï¼ˆè‡ªæ‰˜ç®¡æˆ–è€…VPSï¼ŒOSï¼Œç®¡ç†ä¸­å°ï¼Œé˜²ç«å¢™ç­‰ï¼‰è€Œä¸”ç»†å¾®å·®å¼‚ä¼—å¤šï¼Œæˆ‘ä¸ä¼šåœ¨è¿™ä¸ªç³»åˆ—ä¸­ä»‹ç»ã€‚æˆ‘å¯èƒ½åé¢ä¼šä¸“é—¨å†™ç›¸å…³æ–‡ç« ä»‹ç»é‚£äº›å†…å®¹ã€‚</p><h2 id="å…è´£å£°æ˜"><a href="#å…è´£å£°æ˜" class="headerlink" title="å…è´£å£°æ˜"></a>å…è´£å£°æ˜</h2><blockquote><p>æ–‡ç« å†…å®¹æ¥è‡ªäºæˆ‘å¤šå¹´çš„å·¥ä½œç»éªŒã€å°è¯•ï¼Œä»¥åŠï¼ˆé¢‘ç¹ï¼‰çŠ¯é”™çš„æ€»ç»“ã€‚åœ¨æ­£å¸¸ç»è¥çš„ç½‘ç«™å¿½ç•¥<code>HTTP headers</code> è®¾ç½®ï¼ˆææœ‰ï¼‰å¯èƒ½å¯¼è‡´ä¸€äº›æ„å¤–çš„ç”šè‡³æ˜¯ç¾éš¾æ€§çš„åæœã€‚æœ¬æ–‡æ‰€å†™å†…å®¹éƒ½æ˜¯ä¸ªäººä¾æ®è‡ªèº«çŸ¥è¯†æ°´å¹³æ€»ç»“çš„æœ€ä½³å®è·µï¼Œä½†æ˜¯æ¶‰åŠåˆ°<strong>å®‰å…¨</strong>é—®é¢˜ï¼Œæˆ‘å¼ºçƒˆå»ºè®®è¯»è€…åœ¨å¯¹ä½ è‡ªå·±çš„ç³»ç»Ÿæˆ–ç½‘ç«™åšä»»ä½•æ”¹åŠ¨ä¹‹å‰ç¡®ä¿ä½ çŸ¥é“è‡ªå·±åœ¨å¹²ä»€ä¹ˆä»¥åŠè¿™ä¹ˆå¹²çš„åæœã€‚æœ¬æ–‡æ‰€æœ‰çš„ä»£ç ä»…ä½œç¤ºä¾‹å±•ç¤ºï¼Œå¯èƒ½å¹¶ä¸å®Œå–„ç”šè‡³æœ‰ä¸€äº›é”™è¯¯ã€‚è¯»è€…ä»ç½‘é¡µä¸Šæ‹·è´ç²˜è´´ä½¿ç”¨ä»£ç æ—¶éœ€è¦æ ¼å¤–å°å¿ƒï¼Œ<abbr title="æŒ‡åŸæ–‡å‘è¡¨å¹³å° int64software">è¿™ä¸ªç½‘ç«™</abbr>ä¹ŸåŒ…å«åœ¨å†…ã€‚<abbr title="æŒ‡åŸæ–‡å‘è¡¨å¹³å°æ‰€å±å…¬å¸">Int64 Software Ltd</abbr>å…¬å¸æ‰€æœ‰å‘˜å·¥ä¸ä¼ä¸šæ³•äººä»£è¡¨ä¸å¯¹å› æ•…æ„æˆ–æ— æ„è¯¯ç”¨å…¶å¸–å­å’Œæ–‡ç« ä¸­æ‰€æä¾›ä¿¡æ¯è€Œé€ æˆçš„æŸå®³æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚   </p></blockquote><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å½“WebæœåŠ¡å™¨æ¥æ”¶ä¸€ä¸ªæ ‡å‡†çš„ HTTP Get è¯·æ±‚ä¹‹åï¼Œå®ƒä¼šæŠŠè¯·æ±‚çš„èµ„æºå’Œä¸€äº›Headerä¿¡æ¯ä¸€èµ·è¿”å›ã€‚è¿™å¯¹äºæµè§ˆå™¨å¦‚ä½•å¤„ç†å“åº”æ•°æ®æ¥è¯´æ˜¯å¿…è¦çš„ï¼Œæ¯”å¦‚èµ„æºçš„ç¼–ç ï¼Œå†…å®¹é•¿åº¦ç­‰ã€‚</p><p>ç¬¬ä¸€ç¯‡æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®‰å…¨ç›¸å…³çš„ Headeræœ‰å“ªäº›ï¼Œä»–ä»¬çš„ä½œç”¨ä»¥åŠå¦‚ä½•è®¾ç½®ä»–ä»¬ã€‚</p><h2 id="é…ç½®æœåŠ¡å™¨"><a href="#é…ç½®æœåŠ¡å™¨" class="headerlink" title="é…ç½®æœåŠ¡å™¨"></a>é…ç½®æœåŠ¡å™¨</h2><p>ç½‘ç«™æ‰˜ç®¡ç¯å¢ƒä¸åŒï¼Œè®¾ç½®Headerçš„æ–¹æ³•ä¸åŒã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„æ¯”è¾ƒæµè¡Œçš„æœåŠ¡å™¨è½¯ä»¶/ç¼–ç¨‹è¯­è¨€çš„Headeré…ç½®æ–¹æ³•ã€‚</p><h3 id="Apache-Web-Server"><a href="#Apache-Web-Server" class="headerlink" title="Apache Web Server"></a>Apache Web Server</h3><p>Apacheçš„è™šæ‹Ÿä¸»æœºé…ç½®æ–‡ä»¶ä½äº<code>.htaccess</code> æˆ–<code>.httpd.conf</code>ï¼Œä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤è®¾ç½®ï¼š<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Header set <span class="string">[HeaderName]</span> <span class="string">[HeaderValue]</span></span><br></pre></td></tr></table></figure></p><h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><p>åœ¨Nginx çš„<code>config</code> ç›®å½•ä¸‹ï¼Œæ‰“å¼€<code>nginx.conf</code>ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_header </span>[HeaderName] <span class="string">"[HeaderValue]"</span><span class="comment">;</span></span><br></pre></td></tr></table></figure></p><h3 id="IIS"><a href="#IIS" class="headerlink" title="IIS"></a>IIS</h3><p>(è¯‘è€…åŠ : åœ¨æ¯ä¸ªè™šæ‹Ÿä¸»æœºç›®å½•ä¸‹)æ‰“å¼€<code>Web.Config</code>æ–‡ä»¶ï¼Œåœ¨<code>&lt;system.webServer&gt;</code>èŠ‚ç‚¹ä¸‹æ·»åŠ <code>&lt;customHeaders&gt;</code>èŠ‚ç‚¹ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">httpProtocol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">customHeaders</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"[HeaderName]"</span> <span class="attr">value</span>=<span class="string">"[HeaderValue]"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">customHeaders</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">httpProtocol</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p>PHP å¯ä»¥åœ¨æ–‡ä»¶é¡¶éƒ¨ï¼ˆåœ¨ä»»æ„è¾“å‡ºå†…å®¹è®¾ç½®ä¹‹å‰ï¼ŒåŒ…æ‹¬ç©ºç™½ï¼‰ä½¿ç”¨<code>header</code> æ–¹æ³•è®¾ç½®ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">'[HeaderName]: [HeaderValue]'</span>, <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure></p><blockquote><p>å¤‡æ³¨ï¼šä¸€ä¸ªè¯·æ±‚åªéœ€è¦è®¾ç½®ä¸€æ¬¡Headerï¼Œä¸éœ€è¦åœ¨æ¯ä¸ªåŒ…å«çš„PHPæ–‡ä»¶é‡Œé¢é…ç½®ã€‚<code>true</code> è¡¨ç¤ºä¼šè¦†ç›–å·²å­˜åœ¨çš„åŒå Header ã€‚</p></blockquote><h3 id="Asp-Net"><a href="#Asp-Net" class="headerlink" title="Asp.Net"></a><span>Asp.Net</span></h3><p>åœ¨<code>global.asax</code> æ–‡ä»¶å¢åŠ ä»¥ä¸‹ä»£ç ï¼š<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Application_BeginRequest</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">HttpContext.Current.Response.AddHeader(<span class="string">"[HeaderName]"</span>, <span class="string">"[HeaderValue]"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Headers"><a href="#Headers" class="headerlink" title="Headers"></a>Headers</h2><h3 id="X-Frame-Options"><a href="#X-Frame-Options" class="headerlink" title="X-Frame-Options"></a>X-Frame-Options</h3><p><code>X-Frame-Options</code>ç”¨æ¥é˜²æ­¢ <strong>ç‚¹å‡»åŠ«æŒ</strong>ï¼Œç‚¹å‡»åŠ«æŒæŒ‡çš„æ˜¯æ”»å‡»è€…è¯•å›¾åœ¨ç”¨æˆ·æµè§ˆ/ä½¿ç”¨ç½‘é¡µè¿‡ç¨‹ä¸­åœ¨è¯¸å¦‚ç‚¹å‡»æŒ‰é’®ç­‰äº‹ä»¶ä¸­æ‰§è¡Œä¸€äº›éé¢„æœŸçš„æ“ä½œã€‚å…¶ä¸­å¸¸è§çš„ä¸€ç§æ”»å‡»æ–¹å¼æ˜¯ æ”»å‡»è€…åœ¨ä»–ä»¬è‡ªå·±çš„é’“é±¼ç½‘ç«™ä¸Šé€šè¿‡<code>iframe</code> åµŒå…¥ä½ çš„ç½‘é¡µï¼Œç„¶ååœ¨ç•Œé¢ä¸Šè¦†ç›–ä¸€ä¸ªé€æ˜çš„åŒºåŸŸï¼Œç”¨æˆ·ä»¥ä¸ºåœ¨æµè§ˆä½ çš„ç½‘é¡µï¼Œå…¶å®ç”¨æˆ·æäº¤çš„ä¿¡æ¯å·²ç»è¢«æ”»å‡»è€…ç›—å–ã€‚<br>é€šè¿‡è®¾ç½®<code>X-Frame-Options</code> ä½ å¯ä»¥å‘Šè¯‰æµè§ˆå™¨å½“å‰ç½‘é¡µä¸å…è®¸é€šè¿‡<code>iframe</code> åŠ è½½ã€‚<br>è¯¥é€‰é¡¹æœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼š</p><h4 id="DENY"><a href="#DENY" class="headerlink" title="DENY"></a>DENY</h4><p>è®¾ç½®ä¸º<code>DENY</code>å¯ä»¥é˜»æ­¢ä»»ä½•å…¶ä»–ç½‘é¡µé€šè¿‡<code>iframe</code>åµŒå…¥ä½ çš„ç½‘é¡µã€‚é™¤éä½ çš„ç½‘é¡µæ˜ç¡®éœ€è¦è¢«åµŒå…¥ï¼Œå¦åˆ™è¯·è®¾ç½®ä¸ºè¿™ä¸ªå€¼ã€‚</p><h4 id="SAMEORIGIN"><a href="#SAMEORIGIN" class="headerlink" title="SAMEORIGIN"></a>SAMEORIGIN</h4><p>è®¾ç½®ä¸º<code>SAMEORIGIN</code>ä¼šå…è®¸ä½ è‡ªå·±çš„ç½‘ç«™ï¼ˆåŒä¸€åŸŸåï¼‰ï¼Œä½†æ˜¯ä¼šé˜»æ­¢å…¶ä»–åŸŸï¼ˆåŒ…æ‹¬å…¶ä»–å­åŸŸï¼‰åµŒå…¥ä½ çš„ç½‘é¡µã€‚</p><h4 id="ALLOW-FROM-lt-uri-gt"><a href="#ALLOW-FROM-lt-uri-gt" class="headerlink" title="ALLOW-FROM &lt;uri\&gt;"></a>ALLOW-FROM &lt;uri\&gt;</h4><p>è¿™ç§æ–¹å¼å°†é˜»æ­¢é™¤æŒ‡å®šURIä»¥å¤–çš„å…¶ä»–æ‰€æœ‰ç½‘é¡µä½¿ç”¨iframeåŠ è½½å½“å‰ç½‘é¡µ(æ¯”å¦‚<code>ALLOW-FROM https://myothersite.com</code>)ã€‚</p><blockquote><p>æ³¨æ„ï¼šè¯¥é€‰é¡¹çš„æµè§ˆå™¨æ”¯æŒæ€§æœ‰é™</p></blockquote><h4 id="æ¨èé…ç½®"><a href="#æ¨èé…ç½®" class="headerlink" title="æ¨èé…ç½®"></a>æ¨èé…ç½®</h4><p>X-Frame-Options åº”å½“æ€»æ˜¯è®¾ç½®ä¸º<code>DENY</code>ï¼Œé™¤éæœ‰æ˜ç¡®çš„éœ€è¦é…ç½®ä¸ºå…¶ä»–å€¼</p><h4 id="å…¶ä»–è¯´æ˜"><a href="#å…¶ä»–è¯´æ˜" class="headerlink" title="å…¶ä»–è¯´æ˜"></a>å…¶ä»–è¯´æ˜</h4><p>X-Frame-Options é€‰é¡¹ç›®å‰ä»ç„¶è¢«å¹¿æ³›æ”¯æŒï¼Œä½†æ˜¯ç¨åå³å°†è®¨è®ºçš„CSPçš„<code>frame-src</code>é€‰é¡¹å¯ä»¥æ›¿ä»£è¿™ä¸ªåŠŸèƒ½ã€‚ä½†æ˜¯IEå¯¹CSPçš„æ”¯æŒä»IE11 å¼€å§‹ï¼Œè€ŒIE8ä»¥ä¸Šå·²ç»æ”¯æŒX-Frame-Optionsï¼Œæ‰€ä»¥å®ƒä»ç„¶éœ€è¦é…ç½®ã€‚</p><h3 id="X-XSS-Protection"><a href="#X-XSS-Protection" class="headerlink" title="X-XSS-Protection"></a>X-XSS-Protection</h3><p>X-XSS-Protection è¢«è®¾è®¡ç”¨äºé˜»æ­¢è·¨ç«™ç®€æœ¬æ”»å‡»(XSS)ï¼Œ<code>X-XSS-Protection</code>é€‰é¡¹å°†å¼€å¯æµè§ˆå™¨çš„XSSè¿‡æ»¤åŠŸèƒ½ã€‚XSSçš„æ”»å‡»è€…é€šè¿‡æ³¨å…¥æ¶æ„è„šæœ¬ï¼ˆä¾‹å¦‚é€šè¿‡æœªç»å®‰å…¨è¿‡æ»¤çš„ç”¨æˆ·è¾“å…¥æ¡†ï¼‰åˆ°ç½‘é¡µï¼Œåœ¨ç”¨æˆ·æµè§ˆæ—¶å½±å“ç½‘é¡µæ­£å¸¸å±•ç¤ºæˆ–è€…å·å–æµè§ˆè€…ä¸ªäººæ•°æ®ã€‚<br>æœ€è¿‘æœ‰ä¸€èµ·XSSæ”»å‡»äº‹ä»¶ï¼Œæ”»å‡»è€…é€šè¿‡è„†å¼±çš„å¹¿å‘Šç½‘ç»œæ³¨å…¥æ¶æ„è„šæœ¬ã€‚æ”»å‡»è€…æœ‰å¯èƒ½ä¼šæŠŠç”¨æˆ·çš„ä»˜æ¬¾ä¿¡æ¯è½¬å‘ä»–è‡ªå·±è€Œä¸æ˜¯ç”¨æˆ·æ‰€ä½¿ç”¨ç½‘é¡µçš„æä¾›è€…ã€‚<br><code>X-XSS-Protection</code>å¯ä»¥é€šçŸ¥æµè§ˆå™¨è¿‡æ»¤å¹¶é˜»æ­¢XSSæ”»å‡»è¿›è€Œé™ä½å®‰å…¨é£é™©ï¼Œå®ƒæœ‰å››ç§å–å€¼ï¼š</p><h4 id="0"><a href="#0" class="headerlink" title="0."></a>0.</h4><p><strong>ä¸å¯ç”¨</strong>ï¼ˆä¸æ¨èï¼‰</p><h4 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h4><p><strong>å¯ç”¨</strong>ï¼Œå¦‚æœæ£€æµ‹åˆ°æ”»å‡»ä»£ç ï¼Œå°†ä¼šåˆ é™¤æ¶æ„ä»£ç å¹¶ç»§ç»­å±•ç¤ºç½‘é¡µã€‚é€šå¸¸æ˜¯é»˜è®¤å€¼ã€‚</p><h4 id="1-mode-block"><a href="#1-mode-block" class="headerlink" title="1; mode=block"></a>1; mode=block</h4><p><strong>å¯ç”¨</strong>ï¼Œå¦‚æœæ£€æµ‹åˆ°æ”»å‡»ä»£ç ï¼Œå°†ä¼šé˜»æ­¢ç½‘é¡µç»§ç»­å±•ç¤ºã€‚</p><h4 id="1-report-lt-reporting-uri-gt"><a href="#1-report-lt-reporting-uri-gt" class="headerlink" title="1; report=&lt;reporting-uri&gt;"></a>1; report=&lt;reporting-uri&gt;</h4><p><strong>å¯ç”¨</strong>ï¼Œå¦‚æœæ£€æµ‹åˆ°æ”»å‡»ä»£ç ï¼Œå°†ä¼šé˜»æ­¢å¹¶æ¸…ç†ç½‘é¡µï¼Œç„¶åå‘æŒ‡å®šçš„uriæŠ¥å‘Šæ¶æ„æ”»å‡»äº‹ä»¶ã€‚</p><h4 id="æ¨èé…ç½®-1"><a href="#æ¨èé…ç½®-1" class="headerlink" title="æ¨èé…ç½®"></a>æ¨èé…ç½®</h4><p>X-XSS-Protectionåº”è¯¥è®¾ç½®ä¸º1ï¼Œç„¶åçœ‹æƒ…å†µå¼€å¯blockæˆ–reporté€‰é¡¹</p><h4 id="å…¶ä»–è¯´æ˜-1"><a href="#å…¶ä»–è¯´æ˜-1" class="headerlink" title="å…¶ä»–è¯´æ˜"></a>å…¶ä»–è¯´æ˜</h4><p>ä¸<code>X-Frame-Options</code>ç±»ä¼¼ï¼ŒCSPå¯ä»¥è®¾ç½®æ›´å¼ºå¤§å’Œå®‰å…¨çš„ç­–ç•¥ï¼Œå¯ä»¥å½»åº•ç¦æ­¢é¡µé¢å†…è”è„šæœ¬çš„æ‰§è¡Œã€‚ç¨åè®¨è®ºã€‚</p><h3 id="X-Content-Type-Options"><a href="#X-Content-Type-Options" class="headerlink" title="X-Content-Type-Options"></a>X-Content-Type-Options</h3><p>X-Content-Type-Optionsåªæœ‰ä¸€ä¸ªå–å€¼<code>nosniff</code>ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªç›®çš„ï¼šé˜»æ­¢æµè§ˆå™¨ä½¿ç”¨<code>Content-Type</code>ä»¥å¤–çš„ç±»å‹å¤„ç†å½“å‰å†…å®¹ã€‚<br>å½“æµè§ˆå™¨æ”¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¹‹åï¼ŒContent-Typeä¼šå‘Šè¯‰æµè§ˆå™¨è¿™ä¸ªæ–‡ä»¶çš„ç±»å‹ï¼Œæµè§ˆå™¨è‡ªå·±ä¹Ÿä¼šä½¿ç”¨å¤šç§æŠ€æœ¯åšå†…å®¹å—…æ¢ï¼ˆæˆ–è€…åª’ä½“ç±»å‹å—…æ¢æˆ–MIMEå—…æ¢ï¼‰ï¼Œææ¸…æ¥šæ–‡ä»¶çš„å…·ä½“ç±»å‹ç„¶åç›¸åº”å¤„ç†ã€‚<br>ç„¶åï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°ç”¨æˆ·æœŸæœ›çš„æ–‡ä»¶ç±»å‹ä¸äº‹å®ä¸ç¬¦çš„æƒ…å†µï¼Œè¿™æœ‰å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»æˆ–æ¶æ„è½¯ä»¶åˆ†å‘ã€‚</p><h4 id="æ¨èé…ç½®-2"><a href="#æ¨èé…ç½®-2" class="headerlink" title="æ¨èé…ç½®"></a>æ¨èé…ç½®</h4><p>ä¸Šé¢å·²ç»è¯´äº†ï¼Œåº”å½“æ€»æ˜¯è®¾ç½®X-Content-Type-Optionsä¸º<code>nosniff</code>ï¼Œé˜»æ­¢æµè§ˆå™¨é»˜è®¤è¡Œä¸ºã€‚</p><h3 id="Strict-Transport-Security"><a href="#Strict-Transport-Security" class="headerlink" title="Strict-Transport-Security"></a>Strict-Transport-Security</h3><p>HTTP Strict Transport Securityï¼Œé€šå¸¸ç®€ç§°ä¸ºHSTSï¼Œç”¨æ¥é€šçŸ¥æµè§ˆå™¨ä½¿ç”¨å®‰å…¨çš„HTTPSè¿æ¥è€Œä¸æ˜¯æœªåŠ å¯†çš„ HTTP åè®®ã€‚<br>æœ‰ä¸¤ç§å–å€¼ï¼š</p><h4 id="max-age-lt-MaxAgeInSeconds-gt"><a href="#max-age-lt-MaxAgeInSeconds-gt" class="headerlink" title="max-age=&lt;MaxAgeInSeconds&gt;"></a>max-age=&lt;MaxAgeInSeconds&gt;</h4><p>è¡¨ç¤ºåœ¨æœªæ¥çš„ä¸€æ®µæ—¶é—´ï¼ˆå•ä½ä¸ºç§’ï¼‰å†…æµè§ˆå™¨éœ€è¦è®°ä½å½“å‰ç«™ç‚¹åªèƒ½é€šè¿‡ HTTPS è®¿é—®ã€‚</p><h4 id="includeSubDomains"><a href="#includeSubDomains" class="headerlink" title="includeSubDomains"></a>includeSubDomains</h4><p>å¯é€‰å€¼ï¼Œå¦‚æœæŒ‡å®šï¼Œè¡¨ç¤ºå½“å‰ç«™ç‚¹çš„æ‰€æœ‰å­åŸŸåä¹Ÿéœ€è¦ä½¿ç”¨ HTTPS è¿æ¥è®¿é—®</p><h4 id="preloadï¼ˆè¯‘è€…åŠ ï¼‰"><a href="#preloadï¼ˆè¯‘è€…åŠ ï¼‰" class="headerlink" title="preloadï¼ˆè¯‘è€…åŠ ï¼‰"></a>preloadï¼ˆè¯‘è€…åŠ ï¼‰</h4><p>å¯é€‰å€¼ã€‚<br>è°·æ­Œç»´æŠ¤ç€ä¸€ä¸ª <a href="https://hstspreload.appspot.com/" target="_blank" rel="noopener">HSTS é¢„åŠ è½½æœåŠ¡</a>ã€‚æŒ‰ç…§å¦‚ä¸‹æŒ‡ç¤ºæˆåŠŸæäº¤ä½ çš„åŸŸååï¼Œæµè§ˆå™¨å°†ä¼šæ°¸ä¸ä½¿ç”¨éå®‰å…¨çš„æ–¹å¼è¿æ¥åˆ°ä½ çš„åŸŸåã€‚è™½ç„¶è¯¥æœåŠ¡æ˜¯ç”±è°·æ­Œæä¾›çš„ï¼Œä½†æ‰€æœ‰æµè§ˆå™¨éƒ½æœ‰ä½¿ç”¨è¿™ä»½åˆ—è¡¨çš„æ„å‘ï¼ˆæˆ–è€…å·²ç»åœ¨ç”¨äº†ï¼‰ã€‚<strong>ä½†æ˜¯ï¼Œè¿™ä¸æ˜¯ HSTS æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸è¯¥è¢«å½“ä½œæ­£å¼çš„å†…å®¹ã€‚</strong></p><h4 id="æ¨èé…ç½®-3"><a href="#æ¨èé…ç½®-3" class="headerlink" title="æ¨èé…ç½®"></a>æ¨èé…ç½®</h4><p>Strict-Transport-Security åº”å½“è®¾ç½®ä¸ºç¨å¾®å¤§ä¸€äº›çš„å€¼ä¾‹å¦‚1å¹´ï¼ˆ31536000 ç§’ï¼‰ã€‚<code>includeSubDomains</code>é€‰é¡¹å¯ä»¥çœ‹æƒ…å†µè®¾ç½®ã€‚<br><figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">Strict</span>-Transport-Security: <span class="built_in">max</span>-age=<span class="number">31536000</span>; includeSubDomains</span><br></pre></td></tr></table></figure></p><h3 id="Content-Security-Policy"><a href="#Content-Security-Policy" class="headerlink" title="Content-Security-Policy"></a>Content-Security-Policy</h3><p>æœ€é‡è¦ä¹Ÿæœ€å¤æ‚çš„Headerå¯èƒ½å°±æ˜¯CSPï¼Œå¾ˆå¤šæµè§ˆå™¨å·²ç»æ”¯æŒã€‚å¦‚æœé…ç½®å¾—å½“ï¼Œå•ä¸€çš„CSPå°±å¯ä»¥ä¸ºä½ çš„ç½‘ç«™ä¿é©¾æŠ¤èˆªã€‚ä½†æ˜¯å¦‚æœé…ç½®é”™è¯¯ï¼Œä¹Ÿå¯èƒ½å½±å“å·¨å¤§ã€‚<br>CSPçš„åŠŸèƒ½ä¸»è¦å°±æ˜¯æŒ‡ç¤ºæµè§ˆå™¨å¯ä»¥ä»å“ªé‡Œä¸‹è½½è„šèƒŒä»¥åŠæœåŠ¡å™¨èµ„æºã€‚<br>ä¸€ä¸ªCSP HeaderåŒ…å«ä¸¤éƒ¨åˆ†ï¼šä¸€ä¸ªæŒ‡ä»¤ä»¥åŠä¸€ä¸ªèµ„æºåˆ—è¡¨ã€‚æŒ‡ä»¤æŒ‡ç¤ºå½“å‰è®¾ç½®çš„èµ„æºç±»å‹ï¼Œèµ„æºåˆ—è¡¨é™åˆ¶å½“å‰æŒ‡ä»¤å¯ä»¥ä¸‹è½½çš„æºã€‚<br>æ³¨æ„ï¼ŒCSPå¯ä»¥åŒ…å«å¤šä¸ªç­–ç•¥ï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªHeaderé‡Œé¢é€šè¿‡åˆ†å·(;)åˆ†éš”å¤šæ¡æŒ‡ä»¤ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å¤šä¸ªCSP Headerã€‚<br>æ¯”å¦‚ï¼Œæˆ‘æƒ³è¦é…ç½®JSæ–‡ä»¶ä»æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨å’Œä¸€ä¸ªJS å­˜å‚¨ä»“åº“(js.example.com)ä¸‹è½½ï¼Œæ ·å¥½ä¼¼æ–‡ä»¶ä»…ä»æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ä¸‹è½½ï¼Œæˆ‘å¯ä»¥é€šè¿‡å•ä¸€Header è®¾ç½®ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">"Content-Security-Policy: script-src 'self' js.example.com; style-src 'self';"</span>, <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure></p><p>æˆ–è€…é€šè¿‡å¤šä¸ªHeader è®¾ç½®ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">"Content-Security-Policy: script-src 'self' js.example.com;"</span>, <span class="keyword">false</span>);</span><br><span class="line">header(<span class="string">"Content-Security-Policy: style-src 'self';"</span>, <span class="keyword">false</span>);</span><br></pre></td></tr></table></figure></p><blockquote><p>æ³¨æ„æœ€åä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ›¿æ¢å·²å­˜åœ¨åŒåHeaderéœ€è¦æ”¹ä¸º<code>false</code>ï¼Œç”¨æ¥åŒæ—¶è®¾ç½®å¤šä¸ªåŒåHeaderã€‚</p></blockquote><h4 id="æŒ‡ä»¤ç±»å‹"><a href="#æŒ‡ä»¤ç±»å‹" class="headerlink" title="æŒ‡ä»¤ç±»å‹"></a>æŒ‡ä»¤ç±»å‹</h4><h4 id="default-src"><a href="#default-src" class="headerlink" title="default-src"></a>default-src</h4><p>default-src ä»£è¡¨é»˜è®¤æŒ‡ä»¤ï¼Œå¦‚æœæ­£åœ¨è¯·æ±‚çš„èµ„æºç±»å‹æœªæ˜ç¡®å®šä¹‰ï¼Œå°†ä¼šä½¿ç”¨ default-src ç­–ç•¥ã€‚å¦‚æœç½‘é¡µæœ‰å›¾ç‰‡è¯·æ±‚ï¼Œä½†æ˜¯<code>img-src</code>æ²¡æœ‰é…ç½®ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨<code>default-src</code>çš„é…ç½®ã€‚</p><h4 id="child-src-å·²å¼ƒç”¨"><a href="#child-src-å·²å¼ƒç”¨" class="headerlink" title="child-src(å·²å¼ƒç”¨)"></a>child-src(å·²å¼ƒç”¨)</h4><p>ä¹‹å‰ç”¨æ¥é…ç½® web workers ä»¥åŠåµŒå¥—æµè§ˆå™¨æ‰§è¡Œç¯å¢ƒæ¯”å¦‚ iframeã€‚ç„¶è€Œï¼Œframes å’Œ workers å¯èƒ½éœ€è¦å•ç‹¬é…ç½®ä¸åŒç­–ç•¥ï¼Œè¿™ä¸ªé€‰é¡¹å·²ç»è¢«<code>frame-src</code>å’Œ<code>worker-src</code>å–ä»£ã€‚</p><h4 id="connect-src"><a href="#connect-src" class="headerlink" title="connect-src"></a>connect-src</h4><p>é™åˆ¶è„šæœ¬å¯ä»¥è¯·æ±‚çš„æºï¼ˆaæ ‡ç­¾ï¼Œpingsï¼Œfetchï¼ŒXMLHttpRequestï¼ŒWebSocketï¼ŒEventSourceï¼‰</p><h4 id="font-src"><a href="#font-src" class="headerlink" title="font-src"></a>font-src</h4><p>é™åˆ¶å­—ä½“å¯ä»¥è¯·æ±‚çš„æºï¼ˆGoogle Fontsç­‰ï¼‰</p><h4 id="frame-src"><a href="#frame-src" class="headerlink" title="frame-src"></a>frame-src</h4><p>é™åˆ¶<code>&lt;frame&gt;</code> å’Œ <code>&lt;iframe&gt;</code>å¯ä»¥åŠ è½½çš„æº</p><h4 id="frame-ancestors"><a href="#frame-ancestors" class="headerlink" title="frame-ancestors"></a>frame-ancestors</h4><p>é™åˆ¶å½“å‰é¡µé¢å¯ä»¥è¢«<code>&lt;frame&gt;</code> å’Œ <code>&lt;iframe&gt;</code>åŠ è½½çš„æºï¼Œè®¾ç½®ä¸º<code>&#39;none&#39;</code>æ•ˆæœä¸ <code>X-Frame-Options: DENY</code> ç›¸åŒ</p><h4 id="img-src"><a href="#img-src" class="headerlink" title="img-src"></a>img-src</h4><p>é™åˆ¶å›¾ç‰‡å¯ä»¥åŠ è½½çš„æº</p><h4 id="manifest-src"><a href="#manifest-src" class="headerlink" title="manifest-src"></a>manifest-src</h4><p>é™åˆ¶ Application manifest æ–‡ä»¶å¯ä»¥åŠ è½½çš„æº</p><h4 id="media-src"><a href="#media-src" class="headerlink" title="media-src"></a>media-src</h4><p>é™åˆ¶åª’ä½“ï¼ˆ&lt;audio&gt; , &lt;video&gt;, &lt;track&gt;ï¼‰å¯ä»¥åŠ è½½çš„æº</p><h4 id="object-src"><a href="#object-src" class="headerlink" title="object-src"></a>object-src</h4><p>é™åˆ¶ &lt;object&gt;, &lt;embed&gt;, and &lt;applet&gt; å¯ä»¥åŠ è½½çš„æº</p><h4 id="prefech-src"><a href="#prefech-src" class="headerlink" title="prefech-src"></a>prefech-src</h4><p>é™åˆ¶é¢„è¯·æ±‚æˆ–é¢„æ¸²æŸ“çš„æº</p><h4 id="script-src"><a href="#script-src" class="headerlink" title="script-src"></a>script-src</h4><p>é™åˆ¶JSè„šæœ¬çš„æºã€‚åº”å½“æŒ‰éœ€æ±‚é…ç½®ä¸º<code>&#39;self&#39;</code>ä»¥åŠå¯ä¿¡çš„ç¬¬ä¸‰æ–¹CDNæºã€‚<strong>æ°¸è¿œä¸è¦å…è®¸</strong><code>&#39;unsafe-inline&#39;</code>ï¼Œå¦åˆ™å†…è”è„šæœ¬çš„æ‰§è¡Œå¯èƒ½ä¼šå¯¼è‡´XSSæ”»å‡»ï¼Œä»è€Œç ´åæ•´ä¸ªCSPé…ç½®çš„åŠŸèƒ½ã€‚</p><h4 id="style-src"><a href="#style-src" class="headerlink" title="style-src"></a>style-src</h4><p>é™åˆ¶CSSæ ·å¼çš„æº</p><h4 id="webrtc-src"><a href="#webrtc-src" class="headerlink" title="webrtc-src"></a>webrtc-src</h4><p>é™åˆ¶WebRTC(Web Real-Time Communications)å¯ä»¥è¿æ¥çš„æº</p><h4 id="worker-src"><a href="#worker-src" class="headerlink" title="worker-src"></a>worker-src</h4><p>é™åˆ¶Worker/SharedWorker/ServiceWorkerè„šæœ¬çš„æº</p><h4 id="form-action"><a href="#form-action" class="headerlink" title="form-action"></a>form-action</h4><p>é™åˆ¶è¡¨å•æäº¤çš„æº</p><h4 id="report-uri"><a href="#report-uri" class="headerlink" title="report-uri"></a>report-uri</h4><p>æŒ‡å®šç ´åCSPè§„åˆ™ä¸ŠæŠ¥çš„uri</p><h4 id="block-all-mixed-content"><a href="#block-all-mixed-content" class="headerlink" title="block-all-mixed-content"></a>block-all-mixed-content</h4><p>å¦‚æœé¡µé¢æ˜¯é€šè¿‡HTTPSåŠ è½½çš„ï¼Œè·³è¿‡æ‰€æœ‰HTTPèµ„æºè¯·æ±‚</p><h4 id=""><a href="#" class="headerlink" title="*"></a>*</h4><p>å…è®¸æ‰€æœ‰data stream(blob:, data:, filesystem:)ä»¥å¤–çš„æº</p><h4 id="â€˜noneâ€™"><a href="#â€˜noneâ€™" class="headerlink" title="â€˜noneâ€™"></a>â€˜noneâ€™</h4><p>ç¦æ­¢å½“å‰èµ„æºç±»å‹ä»ä»»æ„æºåŠ è½½</p><h4 id="â€˜selfâ€™"><a href="#â€˜selfâ€™" class="headerlink" title="â€˜selfâ€™"></a>â€˜selfâ€™</h4><p>å½“å‰é¡µé¢æ‰€åœ¨æºï¼ˆåŒåè®®ï¼ŒåŒä¸»æœºåï¼ŒåŒç«¯å£ï¼‰</p><h4 id="Data"><a href="#Data" class="headerlink" title="Data:"></a>Data:</h4><p>æ•°æ®æµï¼ˆä¾‹å¦‚base64 ç¼–ç çš„å›¾ç‰‡åœ°å€ï¼‰</p><h4 id="domain-example-com"><a href="#domain-example-com" class="headerlink" title="domain.example.com"></a>domain.example.com</h4><p>æŸä¸€ä¸ªæŒ‡å®šåŸŸå</p><h4 id="example-com"><a href="#example-com" class="headerlink" title="*.example.com"></a>*.example.com</h4><p>æŸä¸€ä¸ªæŒ‡å®šåŸŸåä»¥åŠæ‰€æœ‰å­åŸŸå</p><h4 id="https-domain-example-com"><a href="#https-domain-example-com" class="headerlink" title="https://domain.example.com"></a><em><a href="https://domain.example.com" target="_blank" rel="noopener">https://domain.example.com</a></em></h4><p>æŸä¸€ä¸ªæŒ‡å®šåŸŸåå¹¶ä¸”åªèƒ½é€šè¿‡HTTPS è¿æ¥</p><h4 id="https"><a href="#https" class="headerlink" title="https:"></a>https:</h4><p>ä»»æ„é€šè¿‡HTTPSè¿æ¥çš„åŸŸå</p><h4 id="â€˜unsafe-inlineâ€™"><a href="#â€˜unsafe-inlineâ€™" class="headerlink" title="â€˜unsafe-inlineâ€™"></a>â€˜unsafe-inlineâ€™</h4><p>å…è®¸å†…è”ä»£ç ï¼ŒåŒ…æ‹¬å†…è”æ ·å¼æˆ–è„šæœ¬å—ï¼ˆè¯·å°½é‡é¿å…ä½¿ç”¨ï¼‰</p><h4 id="â€˜unsafe-evalâ€™"><a href="#â€˜unsafe-evalâ€™" class="headerlink" title="â€˜unsafe-evalâ€™"></a>â€˜unsafe-evalâ€™</h4><p>å…è®¸javascript<code>eval()</code>æ–¹æ³•</p><h4 id="â€˜nonce-lt-noncevalue-gt-â€™"><a href="#â€˜nonce-lt-noncevalue-gt-â€™" class="headerlink" title="â€˜nonce-&lt;noncevalue&gt;â€™"></a>â€˜nonce-&lt;noncevalue&gt;â€™</h4><p>å¯ä»¥åœ¨script/styleæ ‡ç­¾ä¸Šå¢åŠ ä¸€ä¸ªéšæœºæ•°ï¼Œåªæœ‰éšæœºæ•°ä¸noncevalueåŒ¹é…æ—¶ï¼Œç›¸åº”æ ‡ç­¾ä»£ç æ‰å¯ä»¥æ‰§è¡Œã€‚æ³¨æ„è¿™ä¸ªç­–ç•¥å·²ç»ç ´è§£ï¼Œå¯èƒ½ä¸å®‰å…¨ã€‚</p><h4 id="â€˜sha256-lt-hashvalue-gt-â€™"><a href="#â€˜sha256-lt-hashvalue-gt-â€™" class="headerlink" title="â€˜sha256-&lt;hashvalue&gt;â€™"></a>â€˜sha256-&lt;hashvalue&gt;â€™</h4><p>script/styleçš„SHA256å“ˆå¸Œå€¼ä¸hashvalueåŒ¹é…ï¼Œç›¸åº”ä»£ç æ‰å¯ä»¥æ‰§è¡Œ</p><h4 id="æ¨èé…ç½®-4"><a href="#æ¨èé…ç½®-4" class="headerlink" title="æ¨èé…ç½®"></a>æ¨èé…ç½®</h4><p>è¿™ä¸€é¡¹å¾ˆéš¾æœ‰ä¸€ä¸ªé€šç”¨çš„ç¡®åˆ‡å€¼ï¼Œå› ä¸ºéœ€è¦æ ¹æ®æ¯ä¸ªç½‘ç«™å…·ä½“é…ç½®ã€‚æˆ‘çš„åšæ³•ï¼ˆåœ¨ä»»ä½•å®‰å…¨ç›¸å…³çš„é—®é¢˜ï¼‰æ˜¯å°½å¯èƒ½æŠŠè§„åˆ™é…çš„å…·ä½“ï¼Œç„¶åæ‰¾åˆ°å†²çªçš„ç‚¹ï¼Œè§£å†³å†²çªæˆ–è€…æ”¾æ¾è§„åˆ™ï¼Œç›´åˆ°æ‰€æœ‰çš„é…ç½®éƒ½æ­£å¸¸å·¥ä½œã€‚è¿™é‡Œä¹Ÿå¯ä»¥è¿™ä¹ˆåšï¼Œä½†æ˜¯è¯·è€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š<br>æ¯”å¦‚<code>style-src</code>ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±ä¼šé…ç½®ä¸º<code>&#39;self&#39;</code>ç­–ç•¥ï¼Œè¡¨ç¤ºåªèƒ½ä»æœ¬åŸŸåŠ è½½ (.css) æ–‡ä»¶ã€‚ä½†ä½ çš„ä»£ç é‡Œé¢å¯èƒ½ä¼šæœ‰å°‘é‡å†…è”æ ·å¼ï¼Œè¿™æ—¶å€™æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿæœ€å¥½æ˜¯æŠŠè¿™äº›å†…è”æ ·å¼éƒ½ç§»åˆ°æŸä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œè¿™å¹¶ä¸æ€»æ˜¯å¯ä»¥å¾ˆç®€å•çš„å®Œæˆï¼Œä½ å¯èƒ½ä¼šéœ€è¦å…è®¸<code>&#39;unsafe-inline&#39;</code>ã€‚<br>æˆ‘è§‰å¾—ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹å¼æ˜¯é€šè¿‡ä¸€é¡¹é¡¹æŸ¥çœ‹æˆ‘çš„æŸä¸ªé¡¹ç›®çš„CSPé…ç½®ï¼Œè¯´æ˜ä¸€ä¸‹æˆ‘ä¸ºä»€ä¹ˆè¿™ä¹ˆé…ç½®ï¼Œä»¥åŠè¿™ä¹ˆé…ç½®çš„è´Ÿé¢å½±å“ã€‚<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">default</span>-src <span class="string">'none'</span>;</span><br></pre></td></tr></table></figure></p><p>é»˜è®¤é…ç½®ä¸ºæ‹’ç»æ‰€æœ‰æœªæŒ‡å®šèµ„æºç±»å‹çš„ä»»æ„åŠ è½½æºã€‚è€ƒè™‘åˆ°æˆ‘å·²ç»ä»”ç»†æ£€æŸ¥äº†å…¶ä»–æ‰€æœ‰èµ„æºç±»å‹çš„åŠ è½½ç­–ç•¥ï¼Œä¸åº”è¯¥æœ‰èµ„æºä¼šå›é€€åˆ°è¿™ä¸ªé…ç½®ï¼Œå¦‚æœæœ‰ï¼Œé‚£ä¹ˆè¿™ä¸ªèµ„æºä¸€å®šä¸æ˜¯ç”±æˆ‘æ·»åŠ çš„ã€‚æ³¨æ„ï¼šå…¶ä»–äººåœ¨æ–°å¢èµ„æºä½†æ˜¯æ— æ³•åŠ è½½æ—¶å¯èƒ½æ¥æ‰¾ä½ éº»çƒ¦ï¼Œå› æ­¤å¾ˆå¤šäººä¼šè®¾ç½®ä¸º<code>&#39;self&#39;</code>ã€‚<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script-src <span class="string">'self'</span> <span class="string">https:</span><span class="comment">//js.stripe.com;</span></span><br></pre></td></tr></table></figure></p><p>æ‰€æœ‰çš„è„šæœ¬éƒ½å·²ç»æ‰“åŒ…ã€å‹ç¼©ï¼Œå› æ­¤ä¸åº”è¯¥å‡ºç°å†…è”è„šæœ¬ï¼Œåº”å½“é…ç½®ä¸º<code>&#39;self&#39;</code>ã€‚å¦å¤–ï¼Œæˆ‘ä½¿ç”¨ Stripe ä½œä¸ºæ”¯ä»˜ç½‘å…³ï¼Œæ‰€ä»¥è¦å…è®¸ Stripe çš„è„šæœ¬åº“ã€‚<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">connect</span>-src <span class="string">'self'</span> https:<span class="comment">//api.stripe.com;</span></span><br></pre></td></tr></table></figure></p><p>æˆ‘çš„åº”ç”¨å¤§é‡ä½¿ç”¨Ajaxè¯·æ±‚ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ <code>&#39;self&#39;</code>ã€‚Stripe ä¹Ÿéœ€è¦ä½¿ç”¨è„šæœ¬è¯·æ±‚æ¥å£ï¼Œæ‰€ä»¥ä¹Ÿæ·»åŠ äº† Stripe çš„æœåŠ¡åŸŸåã€‚<br><figure class="highlight csp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">img-src</span> <span class="string">'self'</span> data:;</span><br></pre></td></tr></table></figure></p><p>80å¹´ä»£çš„ç½‘é¡µæœ‰ä¸€ä¸ªæ˜æ˜¾çš„é—®é¢˜å°±æ˜¯æ‰€æœ‰çš„å›¾ç‰‡éƒ½æ˜¯ç”±è‡ªå·±çš„æœåŠ¡å™¨æ‰˜ç®¡ï¼Œæ‰€ä»¥éœ€è¦<code>&#39;self&#39;</code>ã€‚å½“ç„¶ï¼Œç½‘é¡µé‡Œé¢ä¹Ÿä¼šç”¨åˆ°å†…è”SVGå›¾åƒï¼Œæ‰€ä»¥åŒ…å«äº†<code>&#39;data:&#39;</code>ã€‚<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">style-src <span class="string">'self'</span> <span class="string">'unsafe-inline'</span> <span class="string">https:</span><span class="comment">//fonts.googleapis.com;</span></span><br></pre></td></tr></table></figure></p><p>æ ·å¼ä¸»è¦éƒ½æ˜¯è‡ªå·±æœåŠ¡å™¨æ‰˜ç®¡ï¼Œå°‘é‡ä½¿ç”¨ Google Fontsï¼Œæ‰€ä»¥æ·»åŠ äº†<code>&#39;self&#39;</code>å’ŒGoogle Fontsã€‚å¾ˆæƒ­æ„§æˆ‘ï¼ˆè™½ç„¶å¾ˆå°‘ä½†æ˜¯å¶å°”ä¼šï¼‰ä¹Ÿä½¿ç”¨äº†é¡µé¢å†…è”æ ·å¼ï¼Œæ‰€ä»¥æˆ‘æ·»åŠ äº†<code>&#39;unsafe-inline&#39;</code>ã€‚æ³¨æ„ï¼šå·²ç»æœ‰è¯æ®è¯æ˜å¯ä»¥é€šè¿‡CSSæ³¨å…¥è¯»å–è¡¨å•ä¿¡æ¯ï¼Œæ‰€ä»¥ä½ éœ€è¦é¢å¤–æ³¨æ„ä½¿ç”¨è¿™ä¸ªç­–ç•¥å¯èƒ½å¯¼è‡´çš„åº”ç”¨ç¨‹åºè„†å¼±æ€§ã€‚<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">font-src <span class="string">'self'</span> <span class="string">https:</span><span class="comment">//fonts.gstatic.com;</span></span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªä¹Ÿç›¸å½“ç®€å•ï¼Œæˆ‘è¦ç”¨åˆ°æˆ‘ä»¬è‡ªå·±çš„å’Œ Google æä¾›çš„å­—ä½“ï¼Œæ‰€ä»¥æ·»åŠ äº†<code>&#39;self&#39;</code>å’ŒGoogleçš„å­—ä½“åº“ã€‚<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame-src <span class="string">'self'</span> https:<span class="regexp">//</span>*.stripe.com https:<span class="regexp">//</span>stripe.com;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªç•¥å¾®æœ‰äº›å¤æ‚ï¼ŒStripe å…è®¸ä½¿ç”¨ <em>3D Secure</em> ä¿æŠ¤å¡çš„æˆæƒç™»å½•ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå¯¹æ–¹æ¨èçš„å®ç°æ–¹å¼æ˜¯ä½¿ç”¨ Iframeï¼ˆæˆ‘ä¹Ÿè®¨åŒï¼‰ã€‚æ‰€ä»¥æˆ‘è¿™é‡Œæ·»åŠ  Stripe ä½œä¸ºæ”¯ä»˜ç½‘å…³ï¼Œ<code>&#39;self&#39;</code>åšä¸ºæˆæƒå®Œæˆä¹‹å Iframe çš„å›è·³åœ°å€ã€‚<br>å¦‚æœä½ ä¹Ÿä½¿ç”¨Stripeï¼Œä½ å¯èƒ½çŸ¥é“ä»–ä»¬çš„æ–‡æ¡£è¯´æ˜åªéœ€è¦æ·»åŠ  <strong><a href="https://js.stripe.com" target="_blank" rel="noopener">https://js.stripe.com</a></strong> ä½œä¸º frame sourceï¼Œä½†æ˜¯æˆ‘æ“ä½œçš„è¿‡ç¨‹ä¸­å‘ç°ä¸€äº›é—®é¢˜ï¼Œæˆ‘æ­£åœ¨ä¸ä»–ä»¬çš„æŠ€æœ¯æ”¯æŒå›¢é˜Ÿåˆä½œæŠŠè¿™ä¸ªç­–ç•¥å°½é‡æ”¶ç´§ã€‚<br><figure class="highlight csp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">frame-ancestors</span> <span class="string">'none'</span>;</span><br></pre></td></tr></table></figure></p><p>ä¹‹å‰å·²ç»æåˆ°ï¼Œè¿™é¡¹é…ç½®å¯ä»¥ç¦æ­¢å½“å‰ç½‘é¡µè¢«ä»»ä½•ç½‘ç«™é€šè¿‡ Iframe åµŒå…¥åŠ è½½ã€‚æ³¨æ„ï¼šæˆ‘åœ¨ <em>3D Secure</em> çš„æˆæƒå›è·³é¡µé¢ä¸Šé¢æŠŠè¿™é¡¹é…ç½®æ”¾é€åˆ°<code>&#39;self&#39;</code>ï¼Œè¿™æ ·æˆ‘è‡ªå·±çš„ç½‘ç«™æ‰å¯ä»¥é€šè¿‡IframeåŠ è½½å›è·³é¡µé¢ã€‚<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">report</span>-uri /csp-<span class="keyword">report</span>.php;</span><br></pre></td></tr></table></figure></p><p>æ‰€æœ‰ç ´åCSPè§„åˆ™çš„å¼‚å¸¸éƒ½ä¼šè¢«ä¸ŠæŠ¥ï¼ˆç”±å®¢æˆ·ç«¯æµè§ˆå™¨ï¼‰åˆ°è¿™ä¸ªåœ°å€ï¼Œè®°å½•ä¸‹æ¥ä»¥ååˆ†æä½¿ç”¨ã€‚<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">block</span>-all-mixed-<span class="built_in">content</span>;</span><br></pre></td></tr></table></figure></p><p>æœ€åï¼Œå°½ç®¡æˆ‘æ²¡æœ‰ä»»ä½•æ··åˆå†…å®¹ï¼ˆè¯‘è€…ï¼šä¸é¡µé¢åè®®ä¸ä¸€è‡´çš„åŠ è½½æ–¹å¼ï¼Œä¾‹å¦‚é¡µé¢ä½¿ç”¨HTTPSï¼Œè€ŒæŸä¸€å›¾ç‰‡ä½¿ç”¨HTTPï¼‰ï¼Œé˜²æ­¢æ„å¤–æˆ‘è¿˜æ˜¯æ·»åŠ äº†è¿™æ¡ç¦æ­¢ç­–ç•¥ã€‚</p><p>å…¶ä»–æŒ‡ä»¤çš„æ³¨æ„ç‚¹ï¼šã€€ã€€ã€€<br>ç»å¤§éƒ¨åˆ†å…¶ä»–æŒ‡ä»¤ç­–ç•¥éƒ½ä¼šå›é€€åˆ° default-src ç„¶åè¢«ç¦æ­¢ã€‚æœ‰ä¸€ä¸ªä¾‹å¤–ï¼šworker-src åœ¨å¾ˆå¤šæµè§ˆå™¨ï¼ˆChrome 59ä»¥ä¸Šä¼šå¿½ç•¥child-srcç›´æ¥å›é€€åˆ°default-src, Edge 17 ä¼šå¿½ç•¥ script-srcï¼‰ä¸­ä¼šå›é€€åˆ° child-src -&gt; script-src ã€‚<br>ä¸è®¾ç½® <strong>plugin-types</strong> æŒ‡ä»¤ï¼Œåœ¨æŠ€æœ¯ä¸Šä¼šé»˜è®¤å…è®¸æ‰€æœ‰çš„æ‰©å±•ç±»å‹ (&lt;embed&gt;, &lt;object&gt;, &lt;applet&gt;)ï¼Œä½†åŒæ—¶æˆ‘ä»¬æ²¡æœ‰é…ç½® <strong>object-src</strong>ï¼Œè¿™é¡¹ç­–ç•¥ä¼šé™çº§åˆ° <strong>default-src</strong> ä»è€Œåœ¨åŠ è½½å±‚é¢ç¦æ­¢æ‰€æœ‰çš„æ‰©å±•ã€‚</p><h2 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h2><h3 id="Apache-Web-Server-1"><a href="#Apache-Web-Server-1" class="headerlink" title="Apache Web Server"></a>Apache Web Server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Header <span class="built_in">set</span> X-Frame-Options <span class="string">"SAMEORIGIN"</span></span><br><span class="line">Header <span class="built_in">set</span> X-XSS-Protection <span class="string">"1; mode=block"</span></span><br><span class="line">Header <span class="built_in">set</span> X-Content-Type-Options <span class="string">"nosniff"</span></span><br><span class="line">Header <span class="built_in">set</span> Strict-Transport-Security <span class="string">"max-age=31536000; includeSubDomains"</span></span><br><span class="line">Header <span class="built_in">set</span> Content-Security-Policy <span class="string">"default-src 'none'; script-src 'self' https://js.stripe.com; connect-src 'self' https://api.stripe.com; img-src 'self' data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https://*.stripe.com https://stripe.com; frame-ancestors 'none'; report-uri /csp_report.php; block-all-mixed-content;"</span></span><br></pre></td></tr></table></figure><h3 id="Nginx-1"><a href="#Nginx-1" class="headerlink" title="Nginx"></a>Nginx</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">add_header X-Frame-Options <span class="string">"SAMEORIGIN"</span></span><br><span class="line">add_header X-XSS-Protection <span class="string">"1; mode=block"</span></span><br><span class="line">add_header X-Content-Type-Options <span class="string">"nosniff"</span></span><br><span class="line">add_header Strict-Transport-Security <span class="string">"max-age=31536000; includeSubDomains"</span></span><br><span class="line">add_header Content-Security-Policy <span class="string">"default-src 'none'; script-src 'self' https://js.stripe.com; connect-src 'self' https://api.stripe.com; img-src 'self' data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https://*.stripe.com https://stripe.com; frame-ancestors 'none'; report-uri /csp_report.php; block-all-mixed-content;"</span></span><br></pre></td></tr></table></figure><h3 id="IIS-1"><a href="#IIS-1" class="headerlink" title="IIS"></a>IIS</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">httpProtocol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">customHeaders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"X-Frame-Options"</span> <span class="attr">value</span>=<span class="string">"SAMEORIGIN"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"X-XSS-Protection"</span> <span class="attr">value</span>=<span class="string">"1; mode=block"</span> /&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"X-Content-Type-Options"</span> <span class="attr">value</span>=<span class="string">"nosniff"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"Strict-Transport-Security"</span> <span class="attr">value</span>=<span class="string">"max-age=31536000; includeSubDomains"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"Content-Security-Policy"</span> <span class="attr">value</span>=<span class="string">"default-src 'none'; script-src 'self' https://js.stripe.com; connect-src 'self' https://api.stripe.com; img-src 'self' data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https://*.stripe.com https://stripe.com; frame-ancestors 'none'; report-uri /csp_report.php; block-all-mixed-content;"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">customHeaders</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">httpProtocol</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="PHP-1"><a href="#PHP-1" class="headerlink" title="PHP"></a>PHP</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">'[HeaderName]: [HeaderValue]'</span>, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">header(<span class="string">'X-Frame-Options: SAMEORIGIN'</span>);</span><br><span class="line">header(<span class="string">'X-XSS-Protection: 1; mode=block'</span>);</span><br><span class="line">header(<span class="string">'X-Content-Type-Options: nosniff'</span>);</span><br><span class="line">header(<span class="string">'Strict-Transport-Security: max-age=31536000; includeSubDomains'</span>);</span><br><span class="line">header(<span class="string">'Content-Security-Policy: default-src \'none\'; script-src \'self\' https://js.stripe.com; connect-src \'self\' https://api.stripe.com; img-src \'self\' data:; style-src \'self\' \'unsafe-inline\' https://fonts.googleapis.com; font-src \'self\' https://fonts.gstatic.com; frame-src \'self\' https://*.stripe.com https://stripe.com; frame-ancestors \'none\'; report-uri /csp_report.php; block-all-mixed-content;'</span>);</span><br></pre></td></tr></table></figure><h3 id="ASP-NET"><a href="#ASP-NET" class="headerlink" title="ASP.NET"></a><span>ASP.NET</span></h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Application_BeginRequest</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HttpContext.Current.Response.AddHeader(<span class="string">"X-Frame-Options"</span>, <span class="string">"SAMEORIGIN"</span>);</span><br><span class="line">    HttpContext.Current.Response.AddHeader(<span class="string">"X-XSS-Protection"</span>, <span class="string">"1; mode=block"</span>);</span><br><span class="line">    HttpContext.Current.Response.AddHeader(<span class="string">"X-Content-Type-Options"</span>, <span class="string">"nosniff"</span>);</span><br><span class="line">    HttpContext.Current.Response.AddHeader(<span class="string">"Strict-Transport-Security"</span>, <span class="string">"max-age=31536000; includeSubDomains"</span>);</span><br><span class="line">    HttpContext.Current.Response.AddHeader(<span class="string">"Content-Security-Policy"</span>, </span><br><span class="line">      <span class="string">"default-src 'none'; script-src 'self' https://js.stripe.com; connect-src 'self' https://api.stripe.com; img-src 'self' data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https://*.stripe.com https://stripe.com; frame-ancestors 'none'; report-uri /csp_report.php; block-all-mixed-content;"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‹é›†é¢„å‘Š"><a href="#ä¸‹é›†é¢„å‘Š" class="headerlink" title="ä¸‹é›†é¢„å‘Š"></a>ä¸‹é›†é¢„å‘Š</h2><p>è¯·å…ˆé˜…è¯»æœ‰å…³ä½¿ç”¨ HSTS Preloading çš„<a href="https://int64software.com/blog/2018/11/10/hardening-website-security-part-1a-hsts-preloading/" target="_blank" rel="noopener">é™„å½•</a>ï¼Œç„¶åç»§ç»­é˜…è¯»ç¬¬äºŒç¯‡ï¼š<a href="https://int64software.com/blog/2018/11/13/hardening-website-security-part-2-user-session-cookie-security/" target="_blank" rel="noopener">Cookieæ”»é˜²å®æˆ˜</a>ã€‚<br>å…³æ³¨ä½œè€…ï¼š<a href="https://twitter.com/Int64Software" target="_blank" rel="noopener">Twitter</a><br>è¯‘è€…å¾®è–„ï¼š<a href="https://weibo.com/zzspace" target="_blank" rel="noopener">æ–°æµªå¾®åš</a></p><h2 id="åˆŠè¯¯"><a href="#åˆŠè¯¯" class="headerlink" title="åˆŠè¯¯"></a>åˆŠè¯¯</h2><p>å¦‚æœä½ æœ‰ä»»ä½•æ„è§æˆ–å»ºè®®ï¼Œè¯·è”ç³»ï¼š<a href="mailto:support@int64software.com" target="_blank" rel="noopener">support@int64software.com</a> ã€‚<br>è¯‘è€…é‚®ç®±ï¼š<a href="mailto:mrzzcn+blog@gmail.com" target="_blank" rel="noopener">mrzzcn@gmail.com</a> ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åŸæ–‡ï¼š&lt;a href=&quot;https://int64software.com/blog/2018/11/05/hardening-website-security-part-1-http-security-headers/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hardening Website Security â€“ Part 1: HTTP Security Headers&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h2&gt;&lt;p&gt;æ„Ÿè§‰æ¯å‘¨éƒ½ä¼šå‡ºç°æ–°çš„ä¸ªäººä¿¡æ¯è¢«ç›—äº‹ä»¶ï¼ŒåŸå› æ˜¯æŸä¸€å®¶å…¬å¸ç½‘ç«™è¢«&lt;strong&gt;é»‘&lt;/strong&gt;äº†ã€‚   &lt;/p&gt;
&lt;p&gt;å¤§éƒ¨åˆ†æ”»å‡»éƒ½æ˜¯é€šè¿‡ç¤¾ä¼šå·¥ç¨‹å­¦è¯±éª—æŸäº›ç”¨æˆ·ä¸»åŠ¨æäº¤ä¸€äº›ä¿¡æ¯ï¼Œé»‘å®¢å€ŸåŠ©è¿™äº›ä¿¡æ¯è·å–æ›´é«˜æƒé™å¹¶æœ€ç»ˆè·å–ä¸ªäººèµ„æ–™ã€‚   &lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³è¦åœ¨21ä¸–çºªè¿è¥ä¸€ä¸ªå®‰å…¨çš„ç½‘ç«™ï¼Œä½ éœ€è¦éµå¾ªä¸€äº›å®‰å…¨å‡†åˆ™ï¼Œæˆ‘ä¼šå†™ä¸€ä¸ªç³»åˆ—ä¸“æ è¯´æ˜è¿™äº›å®‰å…¨å‡†åˆ™ï¼Œè¿™æ˜¯ç¬¬ä¸€ç¯‡ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Translate" scheme="https://mrzzcn.github.io/categories/Translate/"/>
    
      <category term="Technology" scheme="https://mrzzcn.github.io/categories/Translate/Technology/"/>
    
    
      <category term="Web" scheme="https://mrzzcn.github.io/tags/Web/"/>
    
      <category term="HTTP" scheme="https://mrzzcn.github.io/tags/HTTP/"/>
    
      <category term="Headers" scheme="https://mrzzcn.github.io/tags/Headers/"/>
    
      <category term="Security" scheme="https://mrzzcn.github.io/tags/Security/"/>
    
  </entry>
  
  <entry>
    <title>BFC</title>
    <link href="https://mrzzcn.github.io/2018/12/28/bfc/"/>
    <id>https://mrzzcn.github.io/2018/12/28/bfc/</id>
    <published>2018-12-28T02:19:51.000Z</published>
    <updated>2019-04-27T01:43:35.929Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-å«ä¹‰"><a href="#1-å«ä¹‰" class="headerlink" title="1. å«ä¹‰"></a>1. å«ä¹‰</h2><blockquote><p>å—æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼ˆBlock Formatting Contextï¼ŒBFCï¼‰ æ˜¯Webé¡µé¢çš„å¯è§†åŒ–CSSæ¸²æŸ“çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯å¸ƒå±€è¿‡ç¨‹ä¸­ç”Ÿæˆå—çº§ç›’å­çš„åŒºåŸŸï¼Œä¹Ÿæ˜¯æµ®åŠ¨å…ƒç´ ä¸å…¶ä»–å…ƒç´ çš„äº¤äº’é™å®šåŒºåŸŸã€‚   </p></blockquote><p>ä¸‹åˆ—æ–¹å¼ä¼šåˆ›å»ºå—æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼š</p><ul><li>æ ¹å…ƒç´ æˆ–åŒ…å«æ ¹å…ƒç´ çš„å…ƒç´ </li><li>æµ®åŠ¨å…ƒç´ ï¼ˆå…ƒç´ çš„ float ä¸æ˜¯ noneï¼‰</li><li>ç»å¯¹å®šä½å…ƒç´ ï¼ˆå…ƒç´ çš„ position ä¸º absolute æˆ– fixedï¼‰</li><li>è¡Œå†…å—å…ƒç´ ï¼ˆå…ƒç´ çš„ display ä¸º inline-blockï¼‰</li><li>è¡¨æ ¼å•å…ƒæ ¼ï¼ˆå…ƒç´ çš„ displayä¸º table-cellï¼ŒHTMLè¡¨æ ¼å•å…ƒæ ¼é»˜è®¤ä¸ºè¯¥å€¼ï¼‰</li><li>è¡¨æ ¼æ ‡é¢˜ï¼ˆå…ƒç´ çš„ display ä¸º table-captionï¼ŒHTMLè¡¨æ ¼æ ‡é¢˜é»˜è®¤ä¸ºè¯¥å€¼ï¼‰</li><li>åŒ¿åè¡¨æ ¼å•å…ƒæ ¼å…ƒç´ ï¼ˆå…ƒç´ çš„ displayä¸º tableã€table-rowã€ table-row-groupã€table-header-groupã€table-footer-groupï¼ˆåˆ†åˆ«æ˜¯HTML tableã€rowã€tbodyã€theadã€tfootçš„é»˜è®¤å±æ€§ï¼‰æˆ– inline-tableï¼‰</li><li>overflow å€¼ä¸ä¸º visible çš„å—å…ƒç´ </li><li>display å€¼ä¸º flow-root çš„å…ƒç´ </li><li>contain å€¼ä¸º layoutã€contentæˆ– strict çš„å…ƒç´ </li><li>å¼¹æ€§å…ƒç´ ï¼ˆdisplayä¸º flex æˆ– inline-flexå…ƒç´ çš„ç›´æ¥å­å…ƒç´ ï¼‰</li><li>ç½‘æ ¼å…ƒç´ ï¼ˆdisplayä¸º grid æˆ– inline-grid å…ƒç´ çš„ç›´æ¥å­å…ƒç´ ï¼‰</li><li>å¤šåˆ—å®¹å™¨ï¼ˆå…ƒç´ çš„ column-count æˆ– column-width ä¸ä¸º autoï¼ŒåŒ…æ‹¬ column-count ä¸º 1ï¼‰<br>column-span ä¸º all çš„å…ƒç´ å§‹ç»ˆä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„BFCï¼Œå³ä½¿è¯¥å…ƒç´ æ²¡æœ‰åŒ…è£¹åœ¨ä¸€ä¸ªå¤šåˆ—å®¹å™¨ä¸­ï¼ˆæ ‡å‡†å˜æ›´ï¼ŒChrome bugï¼‰ã€‚<a id="more"></a></li></ul><p>å—æ ¼å¼åŒ–ä¸Šä¸‹æ–‡åŒ…å«åˆ›å»ºå®ƒçš„å…ƒç´ å†…éƒ¨çš„æ‰€æœ‰å†…å®¹.</p><p>å—æ ¼å¼åŒ–ä¸Šä¸‹æ–‡å¯¹æµ®åŠ¨å®šä½ï¼ˆå‚è§ floatï¼‰ä¸æ¸…é™¤æµ®åŠ¨ï¼ˆå‚è§ clearï¼‰éƒ½å¾ˆé‡è¦ã€‚æµ®åŠ¨å®šä½å’Œæ¸…é™¤æµ®åŠ¨æ—¶åªä¼šåº”ç”¨äºåŒä¸€ä¸ªBFCå†…çš„å…ƒç´ ã€‚æµ®åŠ¨ä¸ä¼šå½±å“å…¶å®ƒBFCä¸­å…ƒç´ çš„å¸ƒå±€ï¼Œè€Œæ¸…é™¤æµ®åŠ¨åªèƒ½æ¸…é™¤åŒä¸€BFCä¸­åœ¨å®ƒå‰é¢çš„å…ƒç´ çš„æµ®åŠ¨ã€‚å¤–è¾¹è·æŠ˜å ï¼ˆMargin collapsingï¼‰ä¹Ÿåªä¼šå‘ç”Ÿåœ¨å±äºåŒä¸€BFCçš„å—çº§å…ƒç´ ä¹‹é—´ã€‚<br>â€“ MDN <a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Block_formatting_context" target="_blank" rel="noopener">æˆ³æ­¤æŸ¥çœ‹</a></p><h2 id="2-åº”ç”¨"><a href="#2-åº”ç”¨" class="headerlink" title="2. åº”ç”¨"></a>2. åº”ç”¨</h2><h3 id="åŒä¸€ä¸ª-BFC-ä¸‹å¤–è¾¹è·ä¼šå‘ç”ŸæŠ˜å "><a href="#åŒä¸€ä¸ª-BFC-ä¸‹å¤–è¾¹è·ä¼šå‘ç”ŸæŠ˜å " class="headerlink" title="åŒä¸€ä¸ª BFC ä¸‹å¤–è¾¹è·ä¼šå‘ç”ŸæŠ˜å "></a>åŒä¸€ä¸ª BFC ä¸‹å¤–è¾¹è·ä¼šå‘ç”ŸæŠ˜å </h3><iframe height="265" scrolling="no" title="aPyrXL" src="//codepen.io/zhangzhen/embed/aPyrXL/?height=265&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 100%;">See the Pen <a href="https://codepen.io/zhangzhen/pen/aPyrXL/" target="_blank" rel="noopener">aPyrXL</a> by Jack (<a href="https://codepen.io/zhangzhen" target="_blank" rel="noopener">@zhangzhen</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>   <p>å‰ä¸¤ä¸ªå…ƒç´ ï¼ˆ1-1 1-2ï¼‰ä½äºåŒä¸€ä¸ªBFCå†…éƒ¨ï¼Œæ‰€ä»¥ä¸Šè¾¹å…ƒç´ çš„ <code>margin-bottom</code> ä¸ ä¸‹è¾¹å…ƒç´ çš„ <code>margin-top</code> å‘ç”Ÿåç¼©ï¼Œåç¼©çš„ç»“æœä¸ºæœ€ç»ˆçš„ <code>margin</code> å€¼æ˜¯ä¸¤è€…ä¸­çš„è¾ƒå¤§å€¼.<br>åä¸¤ä¸ªå…ƒç´ ï¼ˆ2-1 3-1ï¼‰ä½äºä¸åŒBFCå†…éƒ¨ï¼Œæ‰€ä»¥æ²¡æœ‰å‘ç”Ÿåç¼©ï¼Œæœ€ç»ˆ <code>margin</code> ç­‰äºä¸Šè¾¹å…ƒç´ çš„ <code>margin-bottom</code> åŠ ä¸‹è¾¹å…ƒç´ çš„ <code>margin-top</code></p><h3 id="åŒ…å«æµ®åŠ¨çš„å…ƒç´ ï¼ˆæ¸…é™¤æµ®åŠ¨ï¼‰"><a href="#åŒ…å«æµ®åŠ¨çš„å…ƒç´ ï¼ˆæ¸…é™¤æµ®åŠ¨ï¼‰" class="headerlink" title="åŒ…å«æµ®åŠ¨çš„å…ƒç´ ï¼ˆæ¸…é™¤æµ®åŠ¨ï¼‰"></a>åŒ…å«æµ®åŠ¨çš„å…ƒç´ ï¼ˆæ¸…é™¤æµ®åŠ¨ï¼‰</h3><iframe height="265" scrolling="no" title=" BFC å¯ä»¥åŒ…å«æµ®åŠ¨çš„å…ƒç´ ï¼ˆæ¸…é™¤æµ®åŠ¨ï¼‰" src="//codepen.io/zhangzhen/embed/ebEwNR/?height=265&theme-id=dark&default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 100%;">See the Pen <a href="https://codepen.io/zhangzhen/pen/ebEwNR/" target="_blank" rel="noopener"> BFC å¯ä»¥åŒ…å«æµ®åŠ¨çš„å…ƒç´ ï¼ˆæ¸…é™¤æµ®åŠ¨ï¼‰</a> by Jack (<a href="https://codepen.io/zhangzhen" target="_blank" rel="noopener">@zhangzhen</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe><p>ä¸Šæ–¹å®¹å™¨Parent 1å†…å…ƒç´ æµ®åŠ¨ï¼Œè„±ç¦»äº†æ–‡æ¡£æµï¼Œæ‰€ä»¥å®¹å™¨åªå‰©ä¸‹ 2px çš„è¾¹è·é«˜åº¦ã€‚å¦‚æœä½¿è§¦å‘å®¹å™¨çš„ BFCï¼Œé‚£ä¹ˆå®¹å™¨å°†ä¼šåŒ…è£¹ç€æµ®åŠ¨å…ƒç´ ï¼ˆParent 2ï¼‰ã€‚</p><h3 id="é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–"><a href="#é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–" class="headerlink" title="é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–"></a>é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–</h3><iframe height="406" scrolling="no" title="BFC å¯ä»¥é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–" src="//codepen.io/zhangzhen/embed/YdrKzx/?height=406&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 100%;">See the Pen <a href="https://codepen.io/zhangzhen/pen/YdrKzx/" target="_blank" rel="noopener">BFC å¯ä»¥é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–</a> by Jack (<a href="https://codepen.io/zhangzhen" target="_blank" rel="noopener">@zhangzhen</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe><p>ä¸Šè¾¹çš„å¸ƒå±€æ˜¯ä¸€ä¸ªå¸¸è§çš„å›¾æ–‡æ··æ’çš„æ¨¡ç‰ˆï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ä¸éœ€è¦è¿™ç§å¸ƒå±€ï¼Œæˆ‘ä»¬æœŸæœ›ä¸€ä¸ªå·¦å³å¸ƒå±€çš„é¡µé¢ï¼Œå¦‚ä¸‹è¾¹çš„Demoå±•ç¤ºçš„è¿™ç§ï¼Œå°±å¯ä»¥é€šè¿‡è§¦å‘ä¸‹é¢å…ƒç´ çš„ <strong>BFC</strong> æ¥å®ç°ã€‚</p><p>è¿™ä¸ªæ–¹æ³•æ¥å®ç°ä¸¤åˆ—è‡ªé€‚åº”å¸ƒå±€ï¼Œå·¦è¾¹å®½åº¦å›ºå®šï¼Œå³è¾¹çš„å†…å®¹è‡ªé€‚åº”å®½åº¦(å»æ‰ä¸Šé¢å³è¾¹å†…å®¹çš„å®½åº¦)ã€‚</p><p>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨æ¥å®ç°å¤šåˆ—å¸ƒå±€ï¼Œä¹Ÿæ˜¯ç›¸å½“æ–¹ä¾¿ã€‚</p><h2 id="3-FC"><a href="#3-FC" class="headerlink" title="3. (*)FC"></a>3. (*)FC</h2><p>FC å³ <code>Formatting Contexts</code>ï¼ŒåŒ…å«ï¼šIFCã€BFCã€GFC ä¸ FFC ã€‚FCæ˜¯ç½‘é¡µCSSè§†è§‰æ¸²æŸ“çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå†³å®šç›’å­æ¨¡å‹çš„å¸ƒå±€ã€å…¶å­å…ƒç´ å°†å¦‚ä½•å®šä½ä»¥åŠå’Œå…¶ä»–å…ƒç´ çš„å…³ç³»å’Œç›¸äº’ä½œç”¨ã€‚<br>å…¶ä¸­ï¼šIFCï¼ˆInline Formatting Contextsï¼‰ä¸ BFCï¼ˆBlock Formatting Contextsï¼‰æ˜¯ CSS2.1 è§„èŒƒä¸­å¼•è¿›çš„ï¼›åé¢ä¸¤ä¸ªæ˜¯ CSS3 æ–°å¢è§„èŒƒï¼ŒGFCï¼ˆGridLayout Formatting Contextsï¼‰ä»¥åŠ FFCï¼ˆFlex Formatting Contextï¼‰ã€‚</p><p>å…³äºè¿™å‡ ä¸ª FC çš„å…·ä½“åŒºåˆ«å¯å‚è€ƒï¼š<a href="https://github.com/chokcoco/iCSS/issues/5" target="_blank" rel="noopener">https://github.com/chokcoco/iCSS/issues/5</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://zhuanlan.zhihu.com/p/25321647" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/25321647</a><br><a href="https://www.zhangxinxu.com/wordpress/2015/02/css-deep-understand-flow-bfc-column-two-auto-layout/" target="_blank" rel="noopener">https://www.zhangxinxu.com/wordpress/2015/02/css-deep-understand-flow-bfc-column-two-auto-layout/</a><br><a href="https://github.com/chokcoco/iCSS/issues/5" target="_blank" rel="noopener">https://github.com/chokcoco/iCSS/issues/5</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-å«ä¹‰&quot;&gt;&lt;a href=&quot;#1-å«ä¹‰&quot; class=&quot;headerlink&quot; title=&quot;1. å«ä¹‰&quot;&gt;&lt;/a&gt;1. å«ä¹‰&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;å—æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼ˆBlock Formatting Contextï¼ŒBFCï¼‰ æ˜¯Webé¡µé¢çš„å¯è§†åŒ–CSSæ¸²æŸ“çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯å¸ƒå±€è¿‡ç¨‹ä¸­ç”Ÿæˆå—çº§ç›’å­çš„åŒºåŸŸï¼Œä¹Ÿæ˜¯æµ®åŠ¨å…ƒç´ ä¸å…¶ä»–å…ƒç´ çš„äº¤äº’é™å®šåŒºåŸŸã€‚   &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸‹åˆ—æ–¹å¼ä¼šåˆ›å»ºå—æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ ¹å…ƒç´ æˆ–åŒ…å«æ ¹å…ƒç´ çš„å…ƒç´ &lt;/li&gt;
&lt;li&gt;æµ®åŠ¨å…ƒç´ ï¼ˆå…ƒç´ çš„ float ä¸æ˜¯ noneï¼‰&lt;/li&gt;
&lt;li&gt;ç»å¯¹å®šä½å…ƒç´ ï¼ˆå…ƒç´ çš„ position ä¸º absolute æˆ– fixedï¼‰&lt;/li&gt;
&lt;li&gt;è¡Œå†…å—å…ƒç´ ï¼ˆå…ƒç´ çš„ display ä¸º inline-blockï¼‰&lt;/li&gt;
&lt;li&gt;è¡¨æ ¼å•å…ƒæ ¼ï¼ˆå…ƒç´ çš„ displayä¸º table-cellï¼ŒHTMLè¡¨æ ¼å•å…ƒæ ¼é»˜è®¤ä¸ºè¯¥å€¼ï¼‰&lt;/li&gt;
&lt;li&gt;è¡¨æ ¼æ ‡é¢˜ï¼ˆå…ƒç´ çš„ display ä¸º table-captionï¼ŒHTMLè¡¨æ ¼æ ‡é¢˜é»˜è®¤ä¸ºè¯¥å€¼ï¼‰&lt;/li&gt;
&lt;li&gt;åŒ¿åè¡¨æ ¼å•å…ƒæ ¼å…ƒç´ ï¼ˆå…ƒç´ çš„ displayä¸º tableã€table-rowã€ table-row-groupã€table-header-groupã€table-footer-groupï¼ˆåˆ†åˆ«æ˜¯HTML tableã€rowã€tbodyã€theadã€tfootçš„é»˜è®¤å±æ€§ï¼‰æˆ– inline-tableï¼‰&lt;/li&gt;
&lt;li&gt;overflow å€¼ä¸ä¸º visible çš„å—å…ƒç´ &lt;/li&gt;
&lt;li&gt;display å€¼ä¸º flow-root çš„å…ƒç´ &lt;/li&gt;
&lt;li&gt;contain å€¼ä¸º layoutã€contentæˆ– strict çš„å…ƒç´ &lt;/li&gt;
&lt;li&gt;å¼¹æ€§å…ƒç´ ï¼ˆdisplayä¸º flex æˆ– inline-flexå…ƒç´ çš„ç›´æ¥å­å…ƒç´ ï¼‰&lt;/li&gt;
&lt;li&gt;ç½‘æ ¼å…ƒç´ ï¼ˆdisplayä¸º grid æˆ– inline-grid å…ƒç´ çš„ç›´æ¥å­å…ƒç´ ï¼‰&lt;/li&gt;
&lt;li&gt;å¤šåˆ—å®¹å™¨ï¼ˆå…ƒç´ çš„ column-count æˆ– column-width ä¸ä¸º autoï¼ŒåŒ…æ‹¬ column-count ä¸º 1ï¼‰&lt;br&gt;column-span ä¸º all çš„å…ƒç´ å§‹ç»ˆä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„BFCï¼Œå³ä½¿è¯¥å…ƒç´ æ²¡æœ‰åŒ…è£¹åœ¨ä¸€ä¸ªå¤šåˆ—å®¹å™¨ä¸­ï¼ˆæ ‡å‡†å˜æ›´ï¼ŒChrome bugï¼‰ã€‚
    
    </summary>
    
      <category term="Technology" scheme="https://mrzzcn.github.io/categories/Technology/"/>
    
      <category term="CSS" scheme="https://mrzzcn.github.io/categories/Technology/CSS/"/>
    
    
      <category term="éšç¬”" scheme="https://mrzzcn.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="CSS" scheme="https://mrzzcn.github.io/tags/CSS/"/>
    
      <category term="BFC" scheme="https://mrzzcn.github.io/tags/BFC/"/>
    
  </entry>
  
  <entry>
    <title>[ç¿»è¯‘]Arrow Functions in Class Properties Might Not Be As Great As We Think</title>
    <link href="https://mrzzcn.github.io/2018/11/17/arrow-function-in-class-property/"/>
    <id>https://mrzzcn.github.io/2018/11/17/arrow-function-in-class-property/</id>
    <published>2018-11-17T06:34:52.000Z</published>
    <updated>2019-04-27T01:43:35.928Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Javascript æ–°å¢äº† <code>arrow function</code> å’Œ <code>class</code>ï¼Œè¿™ä¸¤è€…çš„æ¦‚å¿µå¯å‚è€ƒï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="noopener">arrow function</a>ï¼Œ<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Classes" target="_blank" rel="noopener">ç±»</a>ã€‚<br>React é‡Œé¢çš„æ–¹æ³•æƒ³è¦åœ¨JSXä¸­ä½¿ç”¨ï¼Œå¿…é¡»æ‰‹åŠ¨ç»‘å®š <code>this</code>ï¼Œæœ‰äº›äººä¼šåœ¨è¿™å„¿ä½¿ç”¨ç®­å¤´å‡½æ•°ç®€å†™æ‰ <code>this.method = this.method.bind(this);</code> è¿™è¡Œä»£ç ï¼Œæœ¬æ–‡ä½œè€…å¯¹è¿™ç§å†™æ³•è¿›è¡Œäº†åˆ†æï¼ŒåŸæ–‡åœ¨æ­¤ï¼š<a href="https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1" target="_blank" rel="noopener">Arrow Functions in Class Properties Might Not Be As Great As We Think</a><br><a id="more"></a></p></blockquote><p>è‡ª2016å¹´ä»¥æ¥ï¼Œ<a href="https://github.com/tc39/proposal-class-fields" target="_blank" rel="noopener"> Class Properties Proposal</a> è®©æˆ‘ä»¬çš„ä»£ç ç®€æ´äº†è®¸å¤šï¼Œç‰¹åˆ«æ˜¯åœ¨ <code>React</code> çš„ <code>state</code> ä¹¦å†™æˆ–è€…åœ¨å£°æ˜é™æ€æˆå‘˜ <code>propTypes</code> å’Œ <code>defaultProps</code> çš„æ—¶å€™ã€‚<br>çœ‹ä¸‹ä»£ç ç¤ºä¾‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Class properties ä»¥å‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      isLoading: <span class="literal">false</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Greeting.protoTypes = &#123;</span><br><span class="line">  name: ProtoTypes.String.Required</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Greeting.defaultProps = &#123;</span><br><span class="line">  name: <span class="string">'Stranger'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Class properties ä¹‹å</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> protoTypes = &#123;</span><br><span class="line">    name: ProtoTypes.String.Required</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">    name: <span class="string">'Stranger'</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  state = &#123;</span><br><span class="line">    isLoading: <span class="literal">false</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¦å¤–ï¼Œåœ¨ React é‡Œé¢éœ€è¦å¤„ç†<code>this</code>ç»‘å®šçš„æ—¶å€™ï¼Œç›´æ¥ä»¥å±æ€§å£°æ˜è€Œä¸å†ä½¿ç”¨ <code>constructor</code> èµ‹å€¼æ–¹å¼åœ¨è¿‡å»çš„å‡ ä¸ªæœˆé‡Œé¢ä¹Ÿè¶Šæ¥è¶Šæˆä¸ºä¸€ç§è¶‹åŠ¿ã€‚<br><a href="https://dwz.cn/EffCghws" target="_blank" rel="noopener">Twitteré“¾æ¥</a><br><img src="http://img.zhugeliang.me/react-bind.png.engineerlife" alt="åœ¨React ä¸­æ€ä¹ˆç»‘å®šthisåˆ°æ–¹æ³•"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Usage example of arrow function in a class property.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComponentA</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç®­å¤´å‡½æ•°åœ¨å£°æ˜å±æ€§æ—¶å€™å¾ˆæ–¹ä¾¿ï¼Œè‡ªåŠ¨ç»‘å®š <code>this</code>ï¼Œä¸éœ€è¦åœ¨ <code>constructor</code> é‡Œæ·»åŠ  <code>this.handleClick = this.handleClick.bind(this)</code>.<br>ä½†æ˜¯ï¼Œæˆ‘ä»¬çœŸçš„å¯ä»¥è¿™ä¹ˆç”¨å—ï¼Ÿ<br>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ç±»å±æ€§ç©¶ç«Ÿæ˜¯æ€ä¹ˆå®ç°è‡ªåŠ¨ç»‘å®šçš„ï¼š   </p><h2 id="ç®­å¤´å‡½æ•°æ˜¯æ€ä¹ˆç¼–è¯‘åˆ°ES2017çš„"><a href="#ç®­å¤´å‡½æ•°æ˜¯æ€ä¹ˆç¼–è¯‘åˆ°ES2017çš„" class="headerlink" title="ç®­å¤´å‡½æ•°æ˜¯æ€ä¹ˆç¼–è¯‘åˆ°ES2017çš„"></a>ç®­å¤´å‡½æ•°æ˜¯æ€ä¹ˆç¼–è¯‘åˆ°ES2017çš„</h2><p>ç¼–å†™ä¸€ä¸ªåŒ…å«é™æ€å±æ€§ï¼Œå®ä¾‹å±æ€§ï¼Œç®­å¤´å‡½æ•°å±æ€§ï¼Œå¦å¤–ä¸€ä¸ªå¸¸è§æˆå‘˜æ–¹æ³•çš„ç±»ï¼Œä½¿ç”¨ <code>transform-class-properties</code> æ’ä»¶ç¼–è¯‘.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> color = <span class="string">"red"</span>;</span><br><span class="line">  counter = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.counter++;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  handleLongClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.counter++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨ <a href="https://babeljs.io/repl/" target="_blank" rel="noopener">Babel REPL</a> ç¼–è¯‘è¿™ä¸ªç±»åˆ°ES2017 æ ¼å¼ï¼Œç¼–è¯‘æ’ä»¶ï¼š<code>es2017</code> <code>stage-2</code>ï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹ä»£ç ï¼š</p><blockquote><p>æ‰“å¼€ Babel é‡Œé¢æŸ¥çœ‹ä»£ç æ—¶å¦‚æœç¼–è¯‘å‡ºé”™ï¼Œè¯·åœ¨å·¦ä¸‹è§’æ·»åŠ  Plugin ï¼š babel-plugin-transform-class-properties</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.counter++;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleLongClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.counter++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">A.color = <span class="string">"red"</span>;</span><br></pre></td></tr></table></figure><blockquote><p>æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥çœ‹ä¸€ä¸‹ï¼š<a href="https://dwz.cn/YRcMqUwG" target="_blank" rel="noopener">ç‚¹å‡»æŸ¥çœ‹</a></p></blockquote><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ å®ä¾‹å±æ€§è¢«ç§»åŠ¨åˆ° <code>constructor</code> å†…éƒ¨ï¼Œé™æ€æˆå‘˜è¢«ç§»åŠ¨åˆ°ç±»å£°æ˜å®Œæˆä¹‹å<br><code>static</code>  å…³é”®å­—å¯ä»¥çœç•¥é¢å¤–çš„é™æ€å±æ€§å£°æ˜ä»£ç ï¼Œç„¶åå¯ä»¥ç›´æ¥<code>export class XXX extends Component</code>ï¼Œä¸ªäººæ¯”è¾ƒå–œæ¬¢è¿™ç‚¹<br>å®ä¾‹å±æ€§è¡¨ç°ä¹Ÿä¸é”™ï¼Œåœ¨æ²¡æœ‰ç¼–è¯‘çš„ç‰ˆæœ¬ä¸­ï¼Œç±»å£°æ˜ç®€æ´äº†è®¸å¤š<br>ä½†æ˜¯ï¼Œç®­å¤´å‡½æ•°å£°æ˜çš„å±æ€§ <code>handleClick</code> ä¹Ÿè¢«ç§»åŠ¨åˆ°äº† <code>constructor</code>ï¼Œä¸æ™®é€šçš„å®ä¾‹å±æ€§ç±»ä¼¼<br>æ­£å¸¸çš„æˆå‘˜æ–¹æ³• <code>handleLongClick</code> æ²¡æœ‰æ”¹å˜<br>å±æ€§è‡ªåŠ¨åˆå§‹åŒ–å¯¹äºæ­£å¸¸çš„å±æ€§æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ä½¿ç”¨ç®­å¤´å‡½æ•°å£°æ˜çš„å±æ€§ï¼Œå±äºHackå¾—åˆ°ä¸€ä¸ª <code>this</code> ç»‘å®š<br>ä½ æœ‰æ²¡æœ‰å‘ç°é—®é¢˜ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸‹æˆ‘çš„å‘ç°</p><h2 id="Mockability"><a href="#Mockability" class="headerlink" title="Mockability"></a>Mockability</h2><p>å¦‚æœæˆ‘ä»¬æƒ³è¦ mock ä¸€ä¸ªç±»çš„æŸä¸€ä¸ªæ–¹æ³•ï¼Œ æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä¿®æ”¹ <code>prototype</code>ï¼Œè¿™ä¼šå¯¹è¿™ä¸ªç±»åŸå‹é“¾ä¸Šæ‰€æœ‰çš„å¯¹è±¡ç”Ÿæ•ˆ<br>æˆ‘ä»¬çœ‹ä¸‹ä½¿ç”¨è¿™ç§æ–¹å¼æµ‹è¯•ä¹‹å‰çš„ç±» <code>A</code> ä¼šå‘ç”Ÿä»€ä¹ˆï¼š<br>æˆ‘ä»¬ç»§ç»­æŠŠä¹‹å‰çš„ç±» <code>A</code> ç¼–è¯‘åˆ° ES2015: <a href="https://dwz.cn/hBMapixL" target="_blank" rel="noopener">ç‚¹å‡»æŸ¥çœ‹</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> color = <span class="string">"red"</span>;</span><br><span class="line">  counter = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.counter++;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  handleLongClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.counter++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¼–è¯‘è¾“å‡º</span></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_classCallCheck</span>(<span class="params">instance, Constructor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!(instance <span class="keyword">instanceof</span> Constructor)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Cannot call a class as a function"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> A = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">    _classCallCheck(<span class="keyword">this</span>, A);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      _this.counter++;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  A.prototype.handleLongClick = <span class="function"><span class="keyword">function</span> <span class="title">handleLongClick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.counter++;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">A.color = <span class="string">"red"</span>;</span><br></pre></td></tr></table></figure></p><p><code>A.prototype.handleLongClick</code> æœ‰æ•ˆ.<br><code>A.prototype.handleClick</code> æœªå®šä¹‰.</p><p>å®~ï¼Œ ä½¿ç”¨ç®­å¤´å‡½æ•°å®šä¹‰çš„ <code>handleClick</code> ç¼–è¯‘ä¹‹åè¢«ç§»åŠ¨åˆ°æ„é€ å‡½æ•°é‡Œé¢ä½¿ç”¨å®ä¾‹å£°æ˜ï¼Œè€Œä¸æ˜¯ç±»æ–¹æ³•ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨å®ä¾‹ä¸Š Mock è¿™ç§æ–¹å¼å®šä¹‰çš„æ–¹æ³•ï¼Œè¿™äº›æ›´æ”¹æ— æ³•åŒæ­¥åˆ°å…¶ä»–å¯¹è±¡ã€‚</p><h2 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h2><p>é¦–å…ˆå®šä¹‰ class A .<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"A.handleClick"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleLongClick() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"A.handleLongClick"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(A.prototype);</span><br><span class="line"><span class="comment">// &#123;constructor: Æ’, handleLongClick: Æ’&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> A().handleClick();</span><br><span class="line"><span class="comment">// A.handleClick</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> A().handleLongClick();</span><br><span class="line"><span class="comment">// A.handleLongClick</span></span><br></pre></td></tr></table></figure></p><p>å¦‚æœ class B ç»§æ‰¿ class Aï¼Œç”±äº <code>handleClick</code> æ˜¯ä¸åœ¨ <code>prototype</code> ä¸Šå®šä¹‰çš„ï¼Œclass B å†…éƒ¨æ— æ³•é€šè¿‡ <code>super.handleClick</code> è°ƒç”¨çˆ¶ç±»æ–¹æ³•<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.handleClick();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"B.handleClick"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleLongClick() &#123;</span><br><span class="line">    <span class="keyword">super</span>.handleLongClick();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"B.handleLongClick"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(B.prototype);</span><br><span class="line"><span class="comment">// A &#123;constructor: Æ’, handleLongClick: Æ’&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(B.prototype.__proto__);</span><br><span class="line"><span class="comment">// &#123;constructor: Æ’, handleLongClick: Æ’&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> B().handleClick();</span><br><span class="line"><span class="comment">// Uncaught TypeError: (intermediate value).handleClick is not a function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> B().handleLongClick();</span><br><span class="line"><span class="comment">// A.handleLongClick</span></span><br><span class="line"><span class="comment">// B.handleLongClick</span></span><br></pre></td></tr></table></figure></p><p>class C ç»§æ‰¿ class Aï¼Œä½†æ˜¯ä½¿ç”¨ç±»æˆå‘˜è€Œä¸æ˜¯ç®­å¤´å‡½æ•°é‡æ–°å®ç°äº† <code>handleClick</code> æ–¹æ³•ï¼Œè¿™æ—¶ <code>handleClick</code> å°†åªä¼šæ‰§è¡Œ <code>super.handleClick</code>, è€Œä¸ä¼šæ‰§è¡Œè‡ªå·±å®šä¹‰çš„ä»£ç ï¼ˆåªæ‰§è¡Œçˆ¶ç±»å®šä¹‰çš„æ–¹æ³•ï¼‰ï¼Œå¥‡æ€ªäº†ï¼Ÿ</p><p>è¿™æ—¶å› ä¸ºçˆ¶ç±»çš„æ„é€ å‡½æ•°é‡å†™äº†<code>handleClick</code>æ–¹æ³•ã€‚</p><p><code>C.prototype.handleClick()</code>ä¼šè°ƒç”¨class Cçš„ <code>handleClick</code>æ–¹æ³•ï¼Œä½†æ˜¯ä¼šæŠ¥é”™: Uncaught TypeError: (intermediate value).handleClick is not a function .<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="keyword">super</span>.handleClick();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"C.handleClick"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(C.prototype);</span><br><span class="line"><span class="comment">// A &#123;constructor: Æ’, handleClick: Æ’&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(C.prototype.__proto__);</span><br><span class="line"><span class="comment">// &#123;constructor: Æ’, handleLongClick: Æ’&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> C().handleClick();</span><br><span class="line"><span class="comment">// A.handleClick</span></span><br></pre></td></tr></table></figure></p><p>æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥<a href="https://dwz.cn/d339GQNj" target="_blank" rel="noopener">ç‚¹å‡»é“¾æ¥</a>æŸ¥çœ‹åŸå› ã€‚</p><p>class D ä»¥å­—é¢é‡å¯¹è±¡æ–¹å¼ç»§æ‰¿ class Aï¼ŒD å°†æ‹¥æœ‰ä¸€ä¸ªç©ºçš„ prototypeï¼Œ<code>new D().handleClick()</code> ä¼šæ‰“å° <code>A.handleClick</code>:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(D.prototype);</span><br><span class="line"><span class="comment">// A &#123;constructor: Æ’&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(D.prototype.__proto__);</span><br><span class="line"><span class="comment">// &#123;constructor: Æ’, handleLongClick: Æ’&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> D().handleClick();</span><br><span class="line"><span class="comment">// A.handleClick</span></span><br></pre></td></tr></table></figure></p><h2 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h2><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ¯”è¾ƒæœ‰è¶£çš„éƒ¨åˆ†ï¼šæ€§èƒ½   </p><p>æˆ‘ä»¬çŸ¥é“æ–¹æ³•é€šå¸¸éƒ½æ˜¯å®šä¹‰åœ¨åŸå‹ä¸Šé¢ï¼Œè¿™æ ·å®šä¹‰çš„æ–¹æ³•ä¼šåœ¨æ‰€æœ‰å®ä¾‹ä¸Šå…±äº«. ä¸€ä¸ªç»„ä»¶åˆ—è¡¨é‡Œé¢çš„æ‰€æœ‰ç»„ä»¶éƒ½åˆ†äº«ç›¸åŒçš„æ–¹æ³•. åˆ—è¡¨é‡Œé¢çš„æ¯ä¸ªç»„ä»¶è¢«ç‚¹å‡», éƒ½ä¼šæ‰§è¡Œç‚¹å‡»äº‹ä»¶, ä½†æ˜¯æ— è®ºå“ªä¸ªç»„ä»¶ç‚¹å‡»éƒ½æ˜¯è°ƒç”¨åŸå‹é“¾ä¸ŠåŒä¸€ä¸ªæ–¹æ³•. å› ä¸ºæ˜¯åŒä¸€ä¸ªæ–¹æ³•å¤šæ¬¡è°ƒç”¨, JSå¼•æ“ä¼šä¼˜åŒ–è¿™ä¸ªæ–¹æ³•.</p><p>ä¸æ­¤ç›¸å¯¹, ç±»ä¸­ç®­å¤´å‡½æ•°å®šä¹‰çš„æ–¹æ³•, åœ¨å¤šä¸ªç»„ä»¶å®ä¾‹ä¸­ä¼šåˆ›å»ºå¤šä¸ªæ–¹æ³•. è¿˜è®°å¾—åˆšæ‰æˆ‘ä»¬çœ‹åˆ°çš„ç¼–è¯‘è¾“å‡ºå—, ç®­å¤´å‡½æ•°æˆå‘˜åœ¨æ„é€ æ–¹æ³•ä¸­å£°æ˜. æ¯ä¸ªç»„ä»¶è¢«ç‚¹å‡», æ‰§è¡Œçš„éƒ½æ˜¯ä¸åŒçš„æ–¹æ³•.</p><p>æˆ‘ä»¬çœ‹ä¸‹åœ¨V8 Engine(Chrome)ä¸‹äºŒè€…çš„è¡¨ç°å·®å¼‚:</p><p>ç¬¬ä¸€ä¸ªæµ‹è¯•æ¯”è¾ƒç®€å•, åªæµ‹è¯•åˆå§‹åŒ–æ—¶é—´, ç„¶åè°ƒç”¨æ–¹æ³•ä¸€æ¬¡.</p><p>æ³¨æ„è¿™ä¸ªæµ‹è¯•ä¸­æ•°å­—å¹¶ä¸é‡è¦, å› ä¸ºå•ä¸ªå®ä¾‹åŒ–è¿‡ç¨‹åœ¨åº”ç”¨ç¨‹åºä¸­æ— å…³å¤§ç¢, æˆ‘ä»¬è®¨è®ºçš„æ˜¯æ¯ç§’èƒ½æ‰§è¡Œå¤šå°‘æ¬¡æ“ä½œå¹¶ä¸”é¢‘ç‡è¶³å¤Ÿé«˜. æˆ‘æ¯”è¾ƒæ‹…å¿ƒæ–¹æ³•ä¹‹é—´çš„å·®å¼‚.<br><img src="http://img.zhugeliang.me/arrow-functions-test-1.png.engineerlife" alt="Ops/s of initialization and call"></p><p> For the second one, I used a representative use case. The instantiation of 100 componentsâ€Šâ€”â€Šlike a listâ€Šâ€”â€Šwhich after we called the method one time on each.</p><p>ç¬¬äºŒä¸ªæµ‹è¯•, ä½¿ç”¨ä¸€ä¸ªæ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„ä½¿ç”¨ç¤ºä¾‹. åˆå§‹åŒ–100ä¸ªç»„ä»¶å½¢æˆä¸€ä¸ªç»„ä»¶åˆ—è¡¨, å¯¹æ¯ä¸ªç»„ä»¶è°ƒç”¨ä¸€æ¬¡æ–¹æ³•.<br><img src="http://img.zhugeliang.me/arrow-functions-test-2.png.engineerlife" alt="Ops/s of instantiation of 100 components and method call"></p><blockquote><p>All benchmarks were run on a MacBook Pro 13â€ 2016 2GHz on Mac OS X 10.13.1 and Chrome 62.0.3202.</p></blockquote><p>æ€»çš„æ¥è¯´, ä¸ºäº†æ›´å¥½çš„ä»£ç æ‰§è¡Œæ€§èƒ½, æˆ‘ä»¬éœ€è¦åœ¨åŸå‹ä¸Šå£°æ˜æ–¹æ³•ç„¶ååœ¨éœ€è¦æ—¶<code>bind</code>åˆ°å®ä¾‹ä¸Š(å½“ä½œå±æ€§æˆ–è€…å›è°ƒå‡½æ•°ä¼ é€’). åœ¨åŸå‹ä¸Šå£°æ˜æ–¹æ³•å¹¶åœ¨æ„é€ æ–¹æ³•ä¸­å£°æ˜å¹¶ç»‘å®šè‡ªå·±çš„å±æ€§æ˜¯æœ‰æ„ä¹‰çš„, è€Œä¸”æ–¹æ³•å¹¶ä¸æ˜¯ç‰¹åˆ«å¤š.<br>æˆ‘ä»¬è®¨è®ºçš„æ˜¯é«˜é¢‘æ“ä½œ, ä½†æ˜¯æˆ‘ä»¬æ¸…æ¥šçœ‹åˆ°ç®­å¤´å‡½æ•°åœ¨ç±»å£°æ˜ä¸­æ€§èƒ½è¡¨ç°å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸå¾…çš„æƒ…å†µ.<br>æœ‰äººä¼šè¯´è¿™ç‚¹å„¿æ€§èƒ½æŸå¤±å¹¶æ— å¤§ç¢, æˆ‘ä»¬ç»å¤§å¤šæ•°æƒ…å†µå¹¶ä¸ä¼šå¯¹ä¸€ä¸ªç»„ä»¶å£°æ˜å¾ˆå¤šå®ä¾‹, çš„ç¡®è¿™æ ·.<br>ä½ ä¹Ÿå¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæå‰ä¼˜åŒ–(æå‰ä¼˜åŒ–æ˜¯ä¸‡æ¶ä¹‹æº), ä½†æ˜¯, æˆ‘ä»¬èƒ½æŠŠç®­å¤´å‡½æ•°åœ¨ç±»å±æ€§ä¸­çš„ä½¿ç”¨å½“ä½œç®€åŒ–ä½¿ç”¨è¿˜æ˜¯ä¸å½“ä½¿ç”¨å‘¢? å¸Œæœ›JSå¼•æ“å°†æ¥ä¼šä¼˜åŒ–ç±»å±æ€§ä¸­çš„ç®­å¤´å‡½æ•°.</p><blockquote><p>P.S: Class properties for properties are such a great improvement!</p></blockquote><p>æˆ‘åœ¨å¾ˆå¤šåº”ç”¨ç¨‹åºå’Œè½¯ä»¶åŒ…ä¸­éƒ½è§åˆ°è¿‡è¿™ç±»ä½¿ç”¨æ–¹å¼, å¾ˆå¤šå¯ä»¥å¤šå®ä¾‹æ–¹å¼ä½¿ç”¨çš„ç»„ä»¶ä¹Ÿæ˜¯. æ—¢ç„¶å·²ç»çŸ¥é“è¿™ç§æ–¹å¼ç°åœ¨ä¼šå½±å“ç¨‹åºæ€§èƒ½, æˆ‘ä»¬çœŸçš„åº”è¯¥ç»§ç»­ä½¿ç”¨å—?</p><p>æˆ‘ä¸ªäººè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªç‰ºç‰²æ€§èƒ½, è€Œä¸”å¹¶ä¸æ€»æ˜¯é‚£ä¹ˆå¥½ç”¨çš„åšæ³•.</p><p>è§£å†³æ–¹æ¡ˆæ˜¯ <a href="https://github.com/andreypopp/autobind-decorator" target="_blank" rel="noopener">autobind-decorator</a>, ä¸å¹¸çš„æ˜¯å½“å‰åªèƒ½å€ŸåŠ©babel ä½¿ç”¨, å®ƒè¿˜åªæ˜¯ä¸€ä¸ª<code>stage 2</code>çš„ææ¡ˆ.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(value) &#123;</span><br><span class="line">    <span class="keyword">this</span>.value = value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @autobind</span><br><span class="line">  method() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å°½ç®¡å¦‚æ­¤, ä»–ä»¬ä¹Ÿå»ºè®®æœ€å¥½ä¸è¦æ»¥ç”¨ autobind:</p><blockquote><p>It is unnecessary to do that to every function. This is just as bad as autobinding (on a class). You only need to bind functions that you pass around. e.g. <code>onClick={this.doSomething}</code>. Or <code>fetch.then(this.hanldeDone)</code> â€”â€ŠDan Abramov.        â€<br>I was the guy who came up with autobinding in older Reacts and Iâ€™m glad to see it gone. It might save you a few keystrokes but it allocates functions thatâ€™ll never be called in 90% of cases and has noticeable performance degradation. Getting rid of autobinding is a good thingâ€Šâ€”â€ŠPeter Hunt</p></blockquote><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>ä½¿ç”¨ç®­å¤´å‡½æ•°å£°æ˜çš„ç±»æˆå‘˜ä¼šè¢«ç¼–è¯‘åˆ°æ„é€ å‡½æ•°ä¸­å®šä¹‰åˆ°<strong>å½“å‰å¯¹è±¡</strong>ä¸Šé¢è€Œä¸æ˜¯åœ¨å½“å‰ç±»çš„åŸå‹ä¸Š.</p><p>æˆ‘ä»¬æ— æ³•ä½¿ç”¨<code>super</code>è°ƒç”¨è¿™äº›æ–¹æ³•.</p><p>ç®­å¤´å‡½æ•°å£°æ˜ç±»å±æ€§æ¯”ç»‘å®šæ–¹æ³•æ…¢å¾ˆå¤š, å®ƒä»¬éƒ½æ¯”æ­£å¸¸æ–¹æ³•è¦æ…¢.</p><p>æˆ‘ä»¬åªéœ€è¦<code>.bind()</code>å¯èƒ½ä¼šè¢«ä¼ é€’çš„æ–¹æ³•.</p><hr><p>çŸ¥é“ç®­å¤´å‡½æ•°å£°æ˜çš„ç±»å±æ€§æ˜¯å¦‚ä½•å·¥ä½œä»¥åŠçœŸå®çš„æ€§èƒ½è¡¨ç°ä¹‹å, ä½ åº”è¯¥å¯ä»¥åšå‡ºèªæ˜çš„é€‰æ‹©å¹¶æ¸…æ¥šè¿™äº›é€‰æ‹©çš„ç»“æœ.<br>ä½ è§‰å¾—å‘¢? ä½ ä¼šç»§ç»­è¿™ä¹ˆä½¿ç”¨å—? è¿™ç¯‡æ–‡ç« ä¼šä¸ä¼šè®©ä½ æ”¹å˜æƒ³æ³•?<br>æ¬¢è¿äº¤æµæƒ³æ³•.</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Javascript æ–°å¢äº† &lt;code&gt;arrow function&lt;/code&gt; å’Œ &lt;code&gt;class&lt;/code&gt;ï¼Œè¿™ä¸¤è€…çš„æ¦‚å¿µå¯å‚è€ƒï¼š&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;arrow function&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Classes&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ç±»&lt;/a&gt;ã€‚&lt;br&gt;React é‡Œé¢çš„æ–¹æ³•æƒ³è¦åœ¨JSXä¸­ä½¿ç”¨ï¼Œå¿…é¡»æ‰‹åŠ¨ç»‘å®š &lt;code&gt;this&lt;/code&gt;ï¼Œæœ‰äº›äººä¼šåœ¨è¿™å„¿ä½¿ç”¨ç®­å¤´å‡½æ•°ç®€å†™æ‰ &lt;code&gt;this.method = this.method.bind(this);&lt;/code&gt; è¿™è¡Œä»£ç ï¼Œæœ¬æ–‡ä½œè€…å¯¹è¿™ç§å†™æ³•è¿›è¡Œäº†åˆ†æï¼ŒåŸæ–‡åœ¨æ­¤ï¼š&lt;a href=&quot;https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Arrow Functions in Class Properties Might Not Be As Great As We Think&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Translate" scheme="https://mrzzcn.github.io/categories/Translate/"/>
    
      <category term="Technology" scheme="https://mrzzcn.github.io/categories/Translate/Technology/"/>
    
    
      <category term="éšç¬”" scheme="https://mrzzcn.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="React" scheme="https://mrzzcn.github.io/tags/React/"/>
    
      <category term="Javascript" scheme="https://mrzzcn.github.io/tags/Javascript/"/>
    
      <category term="ES6" scheme="https://mrzzcn.github.io/tags/ES6/"/>
    
      <category term="Class" scheme="https://mrzzcn.github.io/tags/Class/"/>
    
      <category term="Arrow functions" scheme="https://mrzzcn.github.io/tags/Arrow-functions/"/>
    
  </entry>
  
  <entry>
    <title>core-js ES6 ES7 cheatsheet</title>
    <link href="https://mrzzcn.github.io/2018/04/27/core-js-es/"/>
    <id>https://mrzzcn.github.io/2018/04/27/core-js-es/</id>
    <published>2018-04-27T06:06:23.000Z</published>
    <updated>2019-04-27T01:43:35.929Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ECMAScript 5 (ES5)ï¼šECMAScript çš„ç¬¬äº”ç‰ˆä¿®è®¢ï¼Œäº 2009 å¹´å®Œæˆæ ‡å‡†åŒ–ã€‚è¿™ä¸ªè§„èŒƒåœ¨æ‰€æœ‰ç°ä»£æµè§ˆå™¨ä¸­éƒ½ç›¸å½“å®Œå…¨çš„å®ç°äº†ã€‚</p></blockquote><blockquote><p>ECMAScript 6 (ES2015/ES6) / ECMAScript 2015 (ES2015)ï¼šECMAScript çš„ç¬¬å…­ç‰ˆä¿®è®¢ï¼Œäº 2015 å¹´å®Œæˆæ ‡å‡†åŒ–ã€‚è¿™ä¸ªæ ‡å‡†è¢«éƒ¨åˆ†å®ç°äºå¤§éƒ¨åˆ†ç°ä»£æµè§ˆå™¨ã€‚å¯ä»¥æŸ¥é˜…<a href="https://kangax.github.io/compat-table/es6/" target="_blank" rel="noopener">è¿™å¼ å…¼å®¹æ€§è¡¨</a>æ¥æŸ¥çœ‹ä¸åŒæµè§ˆå™¨å’Œå·¥å…·çš„å®ç°æƒ…å†µã€‚</p></blockquote><blockquote><p>ECMAScript 2016 (ES2016/ES7)ï¼šç¬¬ä¸ƒç‰ˆ ECMAScript ä¿®è®¢.</p></blockquote><blockquote><p>ECMAScript 2017 (ES2017)</p></blockquote><p>å¯¹å¸¸ç”¨çš„APIä½œä¸ªç®€å•è¯´æ˜(æŒ‰éœ€å¼•å…¥polyfill), <a href="https://github.com/zloirock/core-js" target="_blank" rel="noopener">ç‚¹æ­¤æŸ¥çœ‹Githubé“¾æ¥åŸæ–‡</a><br><a id="more"></a><br>ä¸‹æ–‡ä¸­<code>.</code> è¡¨ç¤ºç±»æ–¹æ³•/å±æ€§, <code>#</code> è¡¨ç¤ºå®ä¾‹æ–¹æ³•/å±æ€§<br>ES5: All features moved to the es6 namespace, here just a list of features:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span></span><br><span class="line">  .create(proto | <span class="literal">null</span>, descriptors?)    -&gt; object</span><br><span class="line">  .getPrototypeOf(object)                -&gt; proto | <span class="literal">null</span></span><br><span class="line">  .defineProperty(target, key, desc)     -&gt; target, cap <span class="keyword">for</span> ie8-</span><br><span class="line">  .defineProperties(target, descriptors) -&gt; target, cap <span class="keyword">for</span> ie8-</span><br><span class="line">  .getOwnPropertyDescriptor(object, key) -&gt; desc</span><br><span class="line">  .getOwnPropertyNames(object)           -&gt; array</span><br><span class="line">  .keys(object)                          -&gt; array</span><br><span class="line">  .seal(object)                          -&gt; object, cap <span class="keyword">for</span> ie8-</span><br><span class="line">  .freeze(object)                        -&gt; object, cap <span class="keyword">for</span> ie8-</span><br><span class="line">  .preventExtensions(object)             -&gt; object, cap <span class="keyword">for</span> ie8-</span><br><span class="line">  .isSealed(object)                      -&gt; bool, cap <span class="keyword">for</span> ie8-</span><br><span class="line">  .isFrozen(object)                      -&gt; bool, cap <span class="keyword">for</span> ie8-</span><br><span class="line">  .isExtensible(object)                  -&gt; bool, cap <span class="keyword">for</span> ie8-</span><br><span class="line"><span class="built_in">Array</span></span><br><span class="line">  .isArray(<span class="keyword">var</span>)                                -&gt; bool</span><br><span class="line">  #slice(start?, end?)                         -&gt; array, fix for ie7-</span><br><span class="line">  #join(string = ',')                          -&gt; string, fix for ie7-</span><br><span class="line">  #indexOf(var, from?)                         -&gt; int</span><br><span class="line">  #lastIndexOf(var, from?)                     -&gt; int</span><br><span class="line">  #every(fn(val, index, @), that)              -&gt; bool</span><br><span class="line">  #some(fn(val, index, @), that)               -&gt; bool</span><br><span class="line">  #forEach(fn(val, index, @), that)            -&gt; void</span><br><span class="line">  #map(fn(val, index, @), that)                -&gt; array</span><br><span class="line">  #filter(fn(val, index, @), that)             -&gt; array</span><br><span class="line">  #reduce(fn(memo, val, index, @), memo?)      -&gt; var</span><br><span class="line">  #reduceRight(fn(memo, val, index, @), memo?) -&gt; var</span><br><span class="line">  #sort(fn?)                                   -&gt; @, fixes for some engines</span><br><span class="line"><span class="built_in">Function</span></span><br><span class="line">  #bind(object, ...args) -&gt; boundFn(...args)</span><br><span class="line"><span class="built_in">String</span></span><br><span class="line">  #split(separator, limit) -&gt; array</span><br><span class="line">  #trim()                  -&gt; str</span><br><span class="line"><span class="built_in">RegExp</span></span><br><span class="line">  #toString() -&gt; str</span><br><span class="line"><span class="built_in">Number</span></span><br><span class="line">  #toFixed(digits)        -&gt; string</span><br><span class="line">  #toPrecision(precision) -&gt; string</span><br><span class="line"><span class="built_in">parseInt</span>(str, radix) -&gt; int</span><br><span class="line"><span class="built_in">parseFloat</span>(str)      -&gt; num</span><br><span class="line"><span class="built_in">Date</span></span><br><span class="line">  .now()         -&gt; int</span><br><span class="line">  #toISOString() -&gt; string</span><br><span class="line">  #toJSON()      -&gt; string</span><br></pre></td></tr></table></figure></p><hr><p>ES6: <code>Object</code><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span></span><br><span class="line">  .assign(target, ...src)                -&gt; target</span><br><span class="line">  .is(a, b)                              -&gt; bool</span><br><span class="line">  .setPrototypeOf(target, proto | <span class="literal">null</span>)  -&gt; target (required __proto__ - IE11+)</span><br><span class="line">  .create(object | <span class="literal">null</span>, descriptors?)   -&gt; object</span><br><span class="line">  .getPrototypeOf(<span class="keyword">var</span>)                   -&gt; object | <span class="literal">null</span></span><br><span class="line">  .defineProperty(object, key, desc)     -&gt; target</span><br><span class="line">  .defineProperties(object, descriptors) -&gt; target</span><br><span class="line">  .getOwnPropertyDescriptor(<span class="keyword">var</span>, key)    -&gt; desc | <span class="literal">undefined</span></span><br><span class="line">  .keys(<span class="keyword">var</span>)                             -&gt; array</span><br><span class="line">  .getOwnPropertyNames(<span class="keyword">var</span>)              -&gt; array</span><br><span class="line">  .freeze(<span class="keyword">var</span>)                           -&gt; <span class="keyword">var</span></span><br><span class="line">  .seal(<span class="keyword">var</span>)                             -&gt; <span class="keyword">var</span></span><br><span class="line">  .preventExtensions(<span class="keyword">var</span>)                -&gt; <span class="keyword">var</span></span><br><span class="line">  .isFrozen(<span class="keyword">var</span>)                         -&gt; bool</span><br><span class="line">  .isSealed(<span class="keyword">var</span>)                         -&gt; bool</span><br><span class="line">  .isExtensible(<span class="keyword">var</span>)                     -&gt; bool</span><br><span class="line">  #toString()                            -&gt; string, ES6 fix: @@toStringTag support</span><br></pre></td></tr></table></figure></p><p>ES6: <code>Function</code><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span></span><br><span class="line">  #bind(object, ...args) -&gt; boundFn(...args)</span><br><span class="line">  #name                  -&gt; string (IE9+)</span><br><span class="line">  #@@hasInstance(var)    -&gt; bool</span><br></pre></td></tr></table></figure></p><p>ES6: <code>Array</code><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span></span><br><span class="line">  .from(iterable | array-like, mapFn(val, index)?, that) -&gt; array</span><br><span class="line">  .of(...args)                                           -&gt; array</span><br><span class="line">  .isArray(<span class="keyword">var</span>)                                          -&gt; bool</span><br><span class="line">  #copyWithin(target = 0, start = 0, end = @length)      -&gt; @</span><br><span class="line">  #fill(val, start = 0, end = @length)                   -&gt; @</span><br><span class="line">  #find(fn(val, index, @), that)                         -&gt; val</span><br><span class="line">  #findIndex(fn(val, index, @), that)                    -&gt; index | -1</span><br><span class="line">  #values()                                              -&gt; iterator</span><br><span class="line">  #keys()                                                -&gt; iterator</span><br><span class="line">  #entries()                                             -&gt; iterator</span><br><span class="line">  #join(string = ',')                                    -&gt; string, fix for ie7-</span><br><span class="line">  #slice(start?, end?)                                   -&gt; array, fix for ie7-</span><br><span class="line">  #indexOf(var, from?)                                   -&gt; index | -1</span><br><span class="line">  #lastIndexOf(var, from?)                               -&gt; index | -1</span><br><span class="line">  #every(fn(val, index, @), that)                        -&gt; bool</span><br><span class="line">  #some(fn(val, index, @), that)                         -&gt; bool</span><br><span class="line">  #forEach(fn(val, index, @), that)                      -&gt; void</span><br><span class="line">  #map(fn(val, index, @), that)                          -&gt; array</span><br><span class="line">  #filter(fn(val, index, @), that)                       -&gt; array</span><br><span class="line">  #reduce(fn(memo, val, index, @), memo?)                -&gt; var</span><br><span class="line">  #reduceRight(fn(memo, val, index, @), memo?)           -&gt; var</span><br><span class="line">  #sort(fn?)                                             -&gt; @, invalid arguments fix</span><br><span class="line">  #@@iterator()                                          -&gt; iterator (values)</span><br><span class="line">  #@@unscopables                                         -&gt; object (cap)</span><br><span class="line">Arguments</span><br><span class="line">  #@@iterator() -&gt; iterator (values, available only in core-js methods)</span><br></pre></td></tr></table></figure></p><p>ES6: <code>String</code><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span></span><br><span class="line">  .fromCodePoint(...codePoints) -&gt; str</span><br><span class="line">  .raw(&#123;raw&#125;, ...substitutions) -&gt; str</span><br><span class="line">  #includes(str, from?) -&gt; bool</span><br><span class="line">  #startsWith(str, from?) -&gt; bool</span><br><span class="line">  #endsWith(str, from?) -&gt; bool</span><br><span class="line">  #repeat(num) -&gt; str</span><br><span class="line">  #codePointAt(pos) -&gt; uint</span><br><span class="line">  #trim() -&gt; str, ES6 fix</span><br><span class="line">  #anchor(name)     -&gt; str</span><br><span class="line">  #big()            -&gt; str</span><br><span class="line">  #blink()          -&gt; str</span><br><span class="line">  #bold()           -&gt; str</span><br><span class="line">  #fixed()          -&gt; str</span><br><span class="line">  #fontcolor(color) -&gt; str</span><br><span class="line">  #fontsize(size)   -&gt; str</span><br><span class="line">  #italics()        -&gt; str</span><br><span class="line">  #link(url)        -&gt; str</span><br><span class="line">  #small()          -&gt; str</span><br><span class="line">  #strike()         -&gt; str</span><br><span class="line">  #sub()            -&gt; str</span><br><span class="line">  #sup()            -&gt; str</span><br><span class="line">  #@@iterator() -&gt; iterator (code points)</span><br></pre></td></tr></table></figure></p><p>ES6: <code>RegExp</code><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">new</span>] <span class="built_in">RegExp</span>(pattern, flags?) -&gt; regexp, ES6 fix: can alter flags (IE9+)</span><br><span class="line">  #flags -&gt; str (IE9+)</span><br><span class="line">  #toString() -&gt; str, ES6 fixes</span><br><span class="line">  #@@match(str)             -&gt; array | null</span><br><span class="line">  #@@replace(str, replacer) -&gt; string</span><br><span class="line">  #@@search(str)            -&gt; index</span><br><span class="line">  #@@split(str, limit)      -&gt; array</span><br><span class="line"><span class="built_in">String</span></span><br><span class="line">  #match(tpl)             -&gt; var, ES6 fix for support @@match</span><br><span class="line">  #replace(tpl, replacer) -&gt; var, ES6 fix for support @@replace</span><br><span class="line">  #search(tpl)            -&gt; var, ES6 fix for support @@search</span><br><span class="line">  #split(tpl, limit)      -&gt; var, ES6 fix for support @@split, some fixes for old engines</span><br></pre></td></tr></table></figure></p><p>ES6: <code>Number</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">new</span>] <span class="built_in">Number</span>(<span class="keyword">var</span>)         -&gt; number | number object</span><br><span class="line">  .isFinite(num)          -&gt; bool</span><br><span class="line">  .isNaN(num)             -&gt; bool</span><br><span class="line">  .isInteger(num)         -&gt; bool</span><br><span class="line">  .isSafeInteger(num)     -&gt; bool</span><br><span class="line">  .parseFloat(str)        -&gt; num</span><br><span class="line">  .parseInt(str)          -&gt; int</span><br><span class="line">  .EPSILON                -&gt; num</span><br><span class="line">  .MAX_SAFE_INTEGER       -&gt; int</span><br><span class="line">  .MIN_SAFE_INTEGER       -&gt; int</span><br><span class="line">  #toFixed(digits)        -&gt; string, fixes</span><br><span class="line">  #toPrecision(precision) -&gt; string, fixes</span><br><span class="line"><span class="built_in">parseFloat</span>(str)           -&gt; num, fixes</span><br><span class="line"><span class="built_in">parseInt</span>(str)             -&gt; int, fixes</span><br></pre></td></tr></table></figure></p><p>ES6: <code>Math</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Math</span></span><br><span class="line">  .acosh(num)     -&gt; num</span><br><span class="line">  .asinh(num)     -&gt; num</span><br><span class="line">  .atanh(num)     -&gt; num</span><br><span class="line">  .cbrt(num)      -&gt; num</span><br><span class="line">  .clz32(num)     -&gt; uint</span><br><span class="line">  .cosh(num)      -&gt; num</span><br><span class="line">  .expm1(num)     -&gt; num</span><br><span class="line">  .fround(num)    -&gt; num</span><br><span class="line">  .hypot(...args) -&gt; num</span><br><span class="line">  .imul(num, num) -&gt; int</span><br><span class="line">  .log1p(num)     -&gt; num</span><br><span class="line">  .log10(num)     -&gt; num</span><br><span class="line">  .log2(num)      -&gt; num</span><br><span class="line">  .sign(num)      -&gt; <span class="number">1</span> | <span class="number">-1</span> | <span class="number">0</span> | <span class="number">-0</span> | <span class="literal">NaN</span></span><br><span class="line">  .sinh(num)      -&gt; num</span><br><span class="line">  .tanh(num)      -&gt; num</span><br><span class="line">  .trunc(num)     -&gt; num</span><br></pre></td></tr></table></figure></p><p>ES6: <code>Date</code><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Date</span></span><br><span class="line">  .now()               -&gt; int</span><br><span class="line">  #toISOString()       -&gt; string</span><br><span class="line">  #toJSON()            -&gt; string</span><br><span class="line">  #toString()          -&gt; string</span><br><span class="line">  #@@toPrimitive(hint) -&gt; primitive</span><br></pre></td></tr></table></figure></p><p>ES6: <code>Promise</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(executor(resolve(<span class="keyword">var</span>), reject(<span class="keyword">var</span>))) -&gt; promise</span><br><span class="line">  #then(resolved(var), rejected(var))            -&gt; promise</span><br><span class="line">  #catch(rejected(var))                          -&gt; promise</span><br><span class="line">  .resolve(promise | <span class="keyword">var</span>)                        -&gt; promise</span><br><span class="line">  .reject(<span class="keyword">var</span>)                                   -&gt; promise</span><br><span class="line">  .all(iterable)                                 -&gt; promise</span><br><span class="line">  .race(iterable)                                -&gt; promise</span><br></pre></td></tr></table></figure></p><p>ES6: <code>Collections</code><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Map</span>(iterable (entries) ?)     -&gt; map</span><br><span class="line">  #clear()                        -&gt; void</span><br><span class="line">  #delete(key)                    -&gt; bool</span><br><span class="line">  #forEach(fn(val, key, @), that) -&gt; void</span><br><span class="line">  #get(key)                       -&gt; val</span><br><span class="line">  #has(key)                       -&gt; bool</span><br><span class="line">  #set(key, val)                  -&gt; @</span><br><span class="line">  #size                           -&gt; uint</span><br><span class="line">  #values()                       -&gt; iterator</span><br><span class="line">  #keys()                         -&gt; iterator</span><br><span class="line">  #entries()                      -&gt; iterator</span><br><span class="line">  #@@iterator()                   -&gt; iterator (entries)</span><br><span class="line">  </span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Set</span>(iterable?)              -&gt; set</span><br><span class="line">  #add(key)                     -&gt; @</span><br><span class="line">  #clear()                      -&gt; void</span><br><span class="line">  #delete(key)                  -&gt; bool</span><br><span class="line">  #forEach(fn(el, el, @), that) -&gt; void</span><br><span class="line">  #has(key)                     -&gt; bool</span><br><span class="line">  #size                         -&gt; uint</span><br><span class="line">  #values()                     -&gt; iterator</span><br><span class="line">  #keys()                       -&gt; iterator</span><br><span class="line">  #entries()                    -&gt; iterator</span><br><span class="line">  #@@iterator()                 -&gt; iterator (values)</span><br><span class="line">  </span><br><span class="line"><span class="keyword">new</span> <span class="built_in">WeakMap</span>(iterable (entries) ?) -&gt; weakmap</span><br><span class="line">  #delete(key)                    -&gt; bool</span><br><span class="line">  #get(key)                       -&gt; val</span><br><span class="line">  #has(key)                       -&gt; bool</span><br><span class="line">  #set(key, val)                  -&gt; @</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">WeakSet</span>(iterable?) -&gt; weakset</span><br><span class="line">  #add(key)            -&gt; @</span><br><span class="line">  #delete(key)         -&gt; bool</span><br><span class="line">  #has(key)            -&gt; bool</span><br></pre></td></tr></table></figure></p><hr><p>ES6: <code>Symbol</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Symbol</span>(description?)  -&gt; symbol</span><br><span class="line">  .hasInstance        -&gt; @@hasInstance</span><br><span class="line">  .isConcatSpreadable -&gt; @@isConcatSpreadable</span><br><span class="line">  .iterator           -&gt; @@iterator</span><br><span class="line">  .match              -&gt; @@match</span><br><span class="line">  .replace            -&gt; @@replace</span><br><span class="line">  .search             -&gt; @@search</span><br><span class="line">  .species            -&gt; @@species</span><br><span class="line">  .split              -&gt; @@split</span><br><span class="line">  .toPrimitive        -&gt; @@toPrimitive</span><br><span class="line">  .toStringTag        -&gt; @@toStringTag</span><br><span class="line">  .unscopables        -&gt; @@unscopables</span><br><span class="line">  .for(key)           -&gt; symbol</span><br><span class="line">  .keyFor(symbol)     -&gt; key</span><br><span class="line">  .useSimple()        -&gt; <span class="keyword">void</span></span><br><span class="line">  .useSetter()        -&gt; <span class="keyword">void</span></span><br><span class="line"><span class="built_in">Object</span></span><br><span class="line">  .getOwnPropertySymbols(object) -&gt; array</span><br></pre></td></tr></table></figure></p><p>ES6: <code>Typed Arrays</code><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(length) -&gt; buffer</span><br><span class="line">  .isView(<span class="keyword">var</span>) -&gt; bool</span><br><span class="line">  #slice(start = 0, end = @length) -&gt; buffer</span><br><span class="line">  #byteLength -&gt; uint</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">DataView</span>(buffer, byteOffset = <span class="number">0</span>, byteLength = buffer.byteLength - byteOffset) -&gt; view</span><br><span class="line">  #getInt8(offset)                          -&gt; int8</span><br><span class="line">  #getUint8(offset)                         -&gt; uint8</span><br><span class="line">  #getInt16(offset, littleEndian = false)   -&gt; int16</span><br><span class="line">  #getUint16(offset, littleEndian = false)  -&gt; uint16</span><br><span class="line">  #getInt32(offset, littleEndian = false)   -&gt; int32</span><br><span class="line">  #getUint32(offset, littleEndian = false)  -&gt; uint32</span><br><span class="line">  #getFloat32(offset, littleEndian = false) -&gt; float32</span><br><span class="line">  #getFloat64(offset, littleEndian = false) -&gt; float64</span><br><span class="line">  #setInt8(offset, value)                          -&gt; void</span><br><span class="line">  #setUint8(offset, value)                         -&gt; void</span><br><span class="line">  #setInt16(offset, value, littleEndian = false)   -&gt; void</span><br><span class="line">  #setUint16(offset, value, littleEndian = false)  -&gt; void</span><br><span class="line">  #setInt32(offset, value, littleEndian = false)   -&gt; void</span><br><span class="line">  #setUint32(offset, value, littleEndian = false)  -&gt; void</span><br><span class="line">  #setFloat32(offset, value, littleEndian = false) -&gt; void</span><br><span class="line">  #setFloat64(offset, value, littleEndian = false) -&gt; void</span><br><span class="line">  #buffer     -&gt; buffer</span><br><span class="line">  #byteLength -&gt; uint</span><br><span class="line">  #byteOffset -&gt; uint</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">Int8Array</span>,</span><br><span class="line">  <span class="built_in">Uint8Array</span>,</span><br><span class="line">  <span class="built_in">Uint8ClampedArray</span>,</span><br><span class="line">  <span class="built_in">Int16Array</span>,</span><br><span class="line">  <span class="built_in">Uint16Array</span>,</span><br><span class="line">  <span class="built_in">Int32Array</span>,</span><br><span class="line">  <span class="built_in">Uint32Array</span>,</span><br><span class="line">  <span class="built_in">Float32Array</span>,</span><br><span class="line">  <span class="built_in">Float64Array</span></span><br><span class="line">&#125;</span><br><span class="line">  <span class="keyword">new</span> %TypedArray%(length)    -&gt; typed</span><br><span class="line">  <span class="keyword">new</span> %TypedArray%(typed)     -&gt; typed</span><br><span class="line">  <span class="keyword">new</span> %TypedArray%(arrayLike) -&gt; typed</span><br><span class="line">  <span class="keyword">new</span> %TypedArray%(iterable)  -&gt; typed</span><br><span class="line">  <span class="keyword">new</span> %TypedArray%(buffer, byteOffset = <span class="number">0</span>, length = (buffer.byteLength - byteOffset) / @BYTES_PER_ELEMENT) -&gt; typed</span><br><span class="line">  .BYTES_PER_ELEMENT -&gt; uint</span><br><span class="line">  .from(arrayLike | iterable, mapFn(val, index)?, that) -&gt; typed</span><br><span class="line">  .of(...args) -&gt; typed</span><br><span class="line">  #BYTES_PER_ELEMENT -&gt; uint</span><br><span class="line">  #copyWithin(target = 0, start = 0, end = @length) -&gt; @</span><br><span class="line">  #every(fn(val, index, @), that) -&gt; bool</span><br><span class="line">  #fill(val, start = 0, end = @length) -&gt; @</span><br><span class="line">  #filter(fn(val, index, @), that) -&gt; typed</span><br><span class="line">  #find(fn(val, index, @), that) -&gt; val</span><br><span class="line">  #findIndex(fn(val, index, @), that) -&gt; index</span><br><span class="line">  #forEach(fn(val, index, @), that) -&gt; void</span><br><span class="line">  #indexOf(var, from?) -&gt; int</span><br><span class="line">  #join(string = ',') -&gt; string</span><br><span class="line">  #lastIndexOf(var, from?) -&gt; int</span><br><span class="line">  #map(fn(val, index, @), that) -&gt; typed</span><br><span class="line">  #reduce(fn(memo, val, index, @), memo?) -&gt; var</span><br><span class="line">  #reduceRight(fn(memo, val, index, @), memo?) -&gt; var</span><br><span class="line">  #reverse() -&gt; @</span><br><span class="line">  #set(arrayLike, offset = 0) -&gt; void</span><br><span class="line">  #slice(start = 0, end = @length) -&gt; typed</span><br><span class="line">  #some(fn(val, index, @), that) -&gt; bool</span><br><span class="line">  #sort(fn(a, b)?) -&gt; @</span><br><span class="line">  #subarray(start = 0, end = @length) -&gt; typed</span><br><span class="line">  #toString() -&gt; string</span><br><span class="line">  #toLocaleString() -&gt; string</span><br><span class="line">  #values()     -&gt; iterator</span><br><span class="line">  #keys()       -&gt; iterator</span><br><span class="line">  #entries()    -&gt; iterator</span><br><span class="line">  #@@iterator() -&gt; iterator (values)</span><br><span class="line">  #buffer     -&gt; buffer</span><br><span class="line">  #byteLength -&gt; uint</span><br><span class="line">  #byteOffset -&gt; uint</span><br><span class="line">  #length     -&gt; uint</span><br></pre></td></tr></table></figure></p><p>ES6: <code>Reflect</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Reflect</span></span><br><span class="line">  .apply(target, thisArgument, argumentsList) -&gt; <span class="keyword">var</span></span><br><span class="line">  .construct(target, argumentsList, newTarget?) -&gt; object</span><br><span class="line">  .defineProperty(target, propertyKey, attributes) -&gt; bool</span><br><span class="line">  .deleteProperty(target, propertyKey) -&gt; bool</span><br><span class="line">  .enumerate(target) -&gt; iterator (removed <span class="keyword">from</span> the spec and will be removed <span class="keyword">from</span> core-js@<span class="number">3</span>)</span><br><span class="line">  .get(target, propertyKey, receiver?) -&gt; <span class="keyword">var</span></span><br><span class="line">  .getOwnPropertyDescriptor(target, propertyKey) -&gt; desc</span><br><span class="line">  .getPrototypeOf(target) -&gt; object | <span class="literal">null</span></span><br><span class="line">  .has(target, propertyKey) -&gt; bool</span><br><span class="line">  .isExtensible(target) -&gt; bool</span><br><span class="line">  .ownKeys(target) -&gt; array</span><br><span class="line">  .preventExtensions(target) -&gt; bool</span><br><span class="line">  .set(target, propertyKey, V, receiver?) -&gt; bool</span><br><span class="line">  .setPrototypeOf(target, proto) -&gt; bool (required __proto__ - IE11+)</span><br></pre></td></tr></table></figure></p><hr><p>ES7: Stage 4 proposals<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span></span><br><span class="line">  #includes(var, from?) -&gt; bool</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">Int8Array</span>,</span><br><span class="line">  <span class="built_in">Uint8Array</span>,</span><br><span class="line">  <span class="built_in">Uint8ClampedArray</span>,</span><br><span class="line">  <span class="built_in">Int16Array</span>,</span><br><span class="line">  <span class="built_in">Uint16Array</span>,</span><br><span class="line">  <span class="built_in">Int32Array</span>,</span><br><span class="line">  <span class="built_in">Uint32Array</span>,</span><br><span class="line">  <span class="built_in">Float32Array</span>,</span><br><span class="line">  <span class="built_in">Float64Array</span></span><br><span class="line">&#125;</span><br><span class="line">  #includes(var, from?) -&gt; bool</span><br><span class="line">  </span><br><span class="line"><span class="built_in">Object</span></span><br><span class="line">  .values(object) -&gt; array</span><br><span class="line">  .entries(object) -&gt; array</span><br><span class="line">  .getOwnPropertyDescriptors(object) -&gt; object</span><br><span class="line">  </span><br><span class="line"><span class="built_in">String</span></span><br><span class="line">  #padStart(length, fillStr = ' ') -&gt; string</span><br><span class="line">  #padEnd(length, fillStr = ' ') -&gt; string</span><br><span class="line">  </span><br><span class="line"><span class="built_in">Object</span></span><br><span class="line">  #__defineSetter__(key, fn) -&gt; void</span><br><span class="line">  #__defineGetter__(key, fn) -&gt; void</span><br><span class="line">  #__lookupSetter__(key) -&gt; fn | void</span><br><span class="line">  #__lookupGetter__(key) -&gt; fn | void</span><br></pre></td></tr></table></figure></p><p>ES7: Stage 3 proposals<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">global -&gt; object</span><br><span class="line">System</span><br><span class="line">  .global -&gt; object (obsolete)</span><br><span class="line"></span><br><span class="line">global.Array === <span class="built_in">Array</span>; <span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span></span><br><span class="line">  #finally(onFinally()) -&gt; promise</span><br><span class="line">  </span><br><span class="line"><span class="built_in">Symbol</span></span><br><span class="line">  .asyncIterator -&gt; @@asyncIterator</span><br></pre></td></tr></table></figure></p><p>ES7: Stage 2 proposals<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span></span><br><span class="line">  #trimLeft()  -&gt; string</span><br><span class="line">  #trimRight() -&gt; string</span><br><span class="line">  #trimStart() -&gt; string</span><br><span class="line">  #trimEnd()   -&gt; string</span><br></pre></td></tr></table></figure></p><p>ES7: Stage 1 proposals<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span></span><br><span class="line">  .try(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)) -&gt; <span class="title">promise</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Array</span></span></span><br><span class="line"><span class="function">  #<span class="title">flatten</span>(<span class="params">depthArg = <span class="number">1</span></span>) -&gt; <span class="title">array</span></span></span><br><span class="line"><span class="function">  #<span class="title">flatMap</span>(<span class="params">fn(val, key, @</span>), <span class="title">that</span>) -&gt; <span class="title">array</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Set</span></span></span><br><span class="line"><span class="function">  .<span class="title">of</span>(<span class="params">...args</span>) -&gt; <span class="title">set</span></span></span><br><span class="line"><span class="function">  .<span class="title">from</span>(<span class="params">iterable, mapFn(val, index</span>)?, <span class="title">that</span>?) -&gt; <span class="title">set</span></span></span><br><span class="line"><span class="function"><span class="title">Map</span></span></span><br><span class="line"><span class="function">  .<span class="title">of</span>(<span class="params">...args</span>) -&gt; <span class="title">map</span></span></span><br><span class="line"><span class="function">  .<span class="title">from</span>(<span class="params">iterable, mapFn(val, index</span>)?, <span class="title">that</span>?) -&gt; <span class="title">map</span></span></span><br><span class="line"><span class="function"><span class="title">WeakSet</span></span></span><br><span class="line"><span class="function">  .<span class="title">of</span>(<span class="params">...args</span>) -&gt; <span class="title">weakset</span></span></span><br><span class="line"><span class="function">  .<span class="title">from</span>(<span class="params">iterable, mapFn(val, index</span>)?, <span class="title">that</span>?) -&gt; <span class="title">weakset</span></span></span><br><span class="line"><span class="function"><span class="title">WeakMap</span></span></span><br><span class="line"><span class="function">  .<span class="title">of</span>(<span class="params">...args</span>) -&gt; <span class="title">weakmap</span></span></span><br><span class="line"><span class="function">  .<span class="title">from</span>(<span class="params">iterable, mapFn(val, index</span>)?, <span class="title">that</span>?) -&gt; <span class="title">weakmap</span></span></span><br><span class="line"><span class="function">  </span></span><br><span class="line"><span class="function"><span class="title">String</span></span></span><br><span class="line"><span class="function">  #<span class="title">matchAll</span>(<span class="params">regexp</span>) -&gt; <span class="title">iterator</span></span></span><br><span class="line"><span class="function">  </span></span><br><span class="line"><span class="function"><span class="title">new</span> <span class="title">Observable</span>(<span class="params">fn</span>)             -&gt; <span class="title">observable</span></span></span><br><span class="line"><span class="function">  #<span class="title">subscribe</span>(<span class="params">observer</span>)         -&gt; <span class="title">subscription</span></span></span><br><span class="line"><span class="function">  #<span class="title">forEach</span>(<span class="params">fn</span>)                 -&gt; <span class="title">promise</span></span></span><br><span class="line"><span class="function">  #@@<span class="title">observable</span>(<span class="params"></span>)              -&gt; @</span></span><br><span class="line"><span class="function">  .<span class="title">of</span>(<span class="params">...items</span>)                -&gt; <span class="title">observable</span></span></span><br><span class="line"><span class="function">  .<span class="title">from</span>(<span class="params">observable | iterable</span>) -&gt; <span class="title">observable</span></span></span><br><span class="line"><span class="function">  .@@<span class="title">species</span>                   -&gt; @</span></span><br><span class="line"><span class="function"><span class="title">Symbol</span></span></span><br><span class="line"><span class="function">  .<span class="title">observable</span>                  -&gt; @@<span class="title">observable</span></span></span><br><span class="line"><span class="function">  </span></span><br><span class="line"><span class="function"><span class="title">Math</span></span></span><br><span class="line"><span class="function">  .<span class="title">DEG_PER_RAD</span> -&gt; <span class="title">number</span></span></span><br><span class="line"><span class="function">  .<span class="title">RAD_PER_DEG</span> -&gt; <span class="title">number</span></span></span><br><span class="line"><span class="function">  .<span class="title">clamp</span>(<span class="params">x, lower, upper</span>) -&gt; <span class="title">number</span></span></span><br><span class="line"><span class="function">  .<span class="title">degrees</span>(<span class="params">radians</span>) -&gt; <span class="title">number</span></span></span><br><span class="line"><span class="function">  .<span class="title">fscale</span>(<span class="params">x, inLow, inHigh, outLow, outHigh</span>) -&gt; <span class="title">number</span></span></span><br><span class="line"><span class="function">  .<span class="title">radians</span>(<span class="params">degrees</span>) -&gt; <span class="title">number</span></span></span><br><span class="line"><span class="function">  .<span class="title">scale</span>(<span class="params">x, inLow, inHigh, outLow, outHigh</span>) -&gt; <span class="title">number</span></span></span><br><span class="line"><span class="function">  </span></span><br><span class="line"><span class="function"><span class="title">Math</span></span></span><br><span class="line"><span class="function">  .<span class="title">signbit</span>(<span class="params">x</span>) -&gt; <span class="title">bool</span></span></span><br></pre></td></tr></table></figure></p><p>â€¦ES7: Stage 0 proposals and below</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ECMAScript 5 (ES5)ï¼šECMAScript çš„ç¬¬äº”ç‰ˆä¿®è®¢ï¼Œäº 2009 å¹´å®Œæˆæ ‡å‡†åŒ–ã€‚è¿™ä¸ªè§„èŒƒåœ¨æ‰€æœ‰ç°ä»£æµè§ˆå™¨ä¸­éƒ½ç›¸å½“å®Œå…¨çš„å®ç°äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ECMAScript 6 (ES2015/ES6) / ECMAScript 2015 (ES2015)ï¼šECMAScript çš„ç¬¬å…­ç‰ˆä¿®è®¢ï¼Œäº 2015 å¹´å®Œæˆæ ‡å‡†åŒ–ã€‚è¿™ä¸ªæ ‡å‡†è¢«éƒ¨åˆ†å®ç°äºå¤§éƒ¨åˆ†ç°ä»£æµè§ˆå™¨ã€‚å¯ä»¥æŸ¥é˜…&lt;a href=&quot;https://kangax.github.io/compat-table/es6/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™å¼ å…¼å®¹æ€§è¡¨&lt;/a&gt;æ¥æŸ¥çœ‹ä¸åŒæµè§ˆå™¨å’Œå·¥å…·çš„å®ç°æƒ…å†µã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ECMAScript 2016 (ES2016/ES7)ï¼šç¬¬ä¸ƒç‰ˆ ECMAScript ä¿®è®¢.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ECMAScript 2017 (ES2017)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯¹å¸¸ç”¨çš„APIä½œä¸ªç®€å•è¯´æ˜(æŒ‰éœ€å¼•å…¥polyfill), &lt;a href=&quot;https://github.com/zloirock/core-js&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ç‚¹æ­¤æŸ¥çœ‹Githubé“¾æ¥åŸæ–‡&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Technology" scheme="https://mrzzcn.github.io/categories/Technology/"/>
    
      <category term="Javascript" scheme="https://mrzzcn.github.io/categories/Technology/Javascript/"/>
    
    
      <category term="Javascript" scheme="https://mrzzcn.github.io/tags/Javascript/"/>
    
      <category term="core-js" scheme="https://mrzzcn.github.io/tags/core-js/"/>
    
      <category term="babel" scheme="https://mrzzcn.github.io/tags/babel/"/>
    
      <category term="es6" scheme="https://mrzzcn.github.io/tags/es6/"/>
    
      <category term="es7" scheme="https://mrzzcn.github.io/tags/es7/"/>
    
  </entry>
  
  <entry>
    <title>Git å·¥ä½œæµ</title>
    <link href="https://mrzzcn.github.io/2015/11/17/git-flow/"/>
    <id>https://mrzzcn.github.io/2015/11/17/git-flow/</id>
    <published>2015-11-17T07:24:44.000Z</published>
    <updated>2019-04-27T01:43:35.930Z</updated>
    
    <content type="html"><![CDATA[<p>ç®€å•æ•´ç†ä¸€ä¸‹å¤šäººåŒä¸€è¿œç¨‹ä»“åº“gitå·¥ä½œæµæ¨¡å¼ã€‚</p><h2 id="1-åˆå§‹åŒ–æœ¬åœ°ä»“åº“"><a href="#1-åˆå§‹åŒ–æœ¬åœ°ä»“åº“" class="headerlink" title="1. åˆå§‹åŒ–æœ¬åœ°ä»“åº“"></a>1. åˆå§‹åŒ–æœ¬åœ°ä»“åº“</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// å·²æœ‰é¡¹ç›®</span><br><span class="line">git <span class="built_in">clone</span> git@github.com:mrzzcn/mrzzcn.github.io.git</span><br><span class="line"></span><br><span class="line">// æ–°å»ºé¡¹ç›®</span><br><span class="line">git init</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="2-åˆ†æ”¯"><a href="#2-åˆ†æ”¯" class="headerlink" title="2. åˆ†æ”¯"></a>2. åˆ†æ”¯</h2><p>ä¸‰ä¸ªåŸºæœ¬åˆ†æ”¯ï¼š<br>master: ç¨³å®šåˆ†æ”¯ï¼Œç”¨äºå‘å¸ƒå’Œä¿®æ”¹äº§å“bug;<br>test: æµ‹è¯•åˆ†æ”¯ï¼Œç”¨äºå‘å¸ƒæµ‹è¯•æœåŠ¡å™¨å…±å†…éƒ¨æµ‹è¯•;<br>dev: å¼€å‘åˆ†æ”¯ï¼Œç”¨äºå¼€å‘æ—¶æµ‹è¯•å’Œå‘å¸ƒï¼Œéšæ—¶åˆå¹¶æ–°åŠŸèƒ½ä»£ç æˆ–bugä¿®å¤;<br><img src="/2015/11/17/git-flow/basic-branch.png" title="åŸºæœ¬åˆ†æ”¯"></p><h2 id="3-å¼€å‘æµç¨‹"><a href="#3-å¼€å‘æµç¨‹" class="headerlink" title="3. å¼€å‘æµç¨‹"></a>3. å¼€å‘æµç¨‹</h2><p>1 æ¯ä¸ªæ–°åŠŸèƒ½åŸºäº<code>dev</code>åˆ†æ”¯ï¼Œåˆ›å»ºæ–°åˆ†æ”¯å¼€å§‹ï¼Œä¾‹å¦‚ç°åœ¨è¦å¢åŠ ä¸€ä¸ªç™»å½•åŠŸèƒ½ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// å½“å‰ä½äºdevåˆ†æ”¯</span><br><span class="line">git checkout -b feature-login</span><br><span class="line"></span><br><span class="line">// more coding</span><br><span class="line"></span><br><span class="line">git add -A</span><br><span class="line">git commit -m <span class="string">'feature-login completed'</span></span><br></pre></td></tr></table></figure></p><p>2 æ–°åŠŸèƒ½å®Œæˆï¼Œè‡ªå·±æµ‹è¯•ä¹‹åï¼Œéœ€è¦åˆå¹¶åˆ°devåˆ†æ”¯ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// å½“å‰ä½äºdevåˆ†æ”¯</span><br><span class="line">git pull // é¦–å…ˆæ‹‰å–è¿œç¨‹åˆ†æ”¯</span><br><span class="line"></span><br><span class="line">// devåˆ†æ”¯ï¼ˆå†²çªè§£å†³å®Œæˆï¼‰cleanä¹‹å</span><br><span class="line">git checkout feature-login</span><br><span class="line">git rebase dev // ä¿ç•™devçš„å…¶ä»–äººçš„æäº¤è®°å½•å¹¶åˆå¹¶devåˆ†æ”¯åˆ°å½“å‰æ–°åŠŸèƒ½åˆ†æ”¯</span><br><span class="line"></span><br><span class="line">// dev åˆ†æ”¯åˆå¹¶ä¹‹åï¼ˆå¯èƒ½æœ‰å†²çªéœ€è¦è§£å†³ï¼‰</span><br><span class="line">git checkout dev</span><br><span class="line">git rebase feature-login</span><br></pre></td></tr></table></figure></p><p>è¿™æ—¶çš„åˆ†æ”¯çŠ¶æ€ï¼š<br><img src="/2015/11/17/git-flow/feature-login-rebased.png" title="feature-login è¢«åˆå¹¶åˆ°devåˆ†æ”¯ä¹‹å"><br>3 æ¥ä¸‹æ¥ï¼Œå¯ä»¥åˆ é™¤feature-loginåˆ†æ”¯ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å½“å‰ä½äºdevåˆ†æ”¯</span><br><span class="line">git branch -d feature-login</span><br></pre></td></tr></table></figure></p><p>4 è¿™æ—¶ï¼Œfeature-login åŸºæœ¬å¼€å‘å®Œæˆï¼Œå¯ä»¥åˆå¹¶åˆ°teståˆ†æ”¯ï¼Œå‘å¸ƒç»™QAæµ‹è¯•<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å½“å‰ä½äº <span class="built_in">test</span> åˆ†æ”¯</span><br><span class="line">git rebase dev</span><br></pre></td></tr></table></figure></p><p>5 å¦‚æœQAæµ‹å‡ºbugéœ€è¦ä¿®æ”¹ï¼Œæˆ–è€…ä¸´æ—¶æœ‰éœ€æ±‚å˜åŠ¨ï¼Œéœ€è¦é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œä¸è¿‡å‘½åå¯ä»¥ä¿®æ”¹ï¼Œä¾‹å¦‚ fix-login-bug-1024ã€‚å¦‚æœæ˜¯ç»†èŠ‚è°ƒæ•´æˆ–è€…æ˜¯æ™“å¾—ä¿®æ”¹åˆ™å¯ä»¥åœ¨devåˆ†æ”¯ç›´æ¥æ‰§è¡Œã€‚<br>6 æ‰€æœ‰åŠŸèƒ½æµ‹è¯•æ— è¯¯ä¹‹åï¼Œå¯ä»¥åˆå¹¶åˆ° <code>master</code> åˆ†æ”¯ï¼Œå‘å¸ƒç”Ÿäº§ç¯å¢ƒ<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// å½“å‰ä½äº master åˆ†æ”¯</span><br><span class="line">git rebase dev </span><br><span class="line"></span><br><span class="line">// ä¹Ÿå¯èƒ½æ ¹æ®ä¸åŒåŠŸèƒ½çš„æµ‹è¯•çŠ¶æ€ï¼Œä¼šæ‰§è¡Œä¸åŒçš„åˆå¹¶æ“ä½œ</span><br><span class="line">git merge ...</span><br></pre></td></tr></table></figure></p><h2 id="4-çº¿ä¸Šbugä¸´æ—¶ä¿®æ”¹"><a href="#4-çº¿ä¸Šbugä¸´æ—¶ä¿®æ”¹" class="headerlink" title="4. çº¿ä¸Šbugä¸´æ—¶ä¿®æ”¹"></a>4. çº¿ä¸Šbugä¸´æ—¶ä¿®æ”¹</h2><p>å¦‚æœç”Ÿäº§ç¯å¢ƒçªç„¶å‡ºç°bugéœ€è¦ä¿®æ”¹ï¼Œæˆ–è€…è¦æ”¹ä¸€äº›ç»†èŠ‚éƒ¨åˆ†ï¼Œåˆ™éœ€è¦ç›´æ¥åœ¨ <code>master</code> ä¸Šæ‰§è¡Œï¼Œç„¶ååˆå¹¶åˆ° <code>dev</code>ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// å½“å‰ä½äº master åˆ†æ”¯</span><br><span class="line">git checkout -b hotfix-bug1117</span><br><span class="line"></span><br><span class="line">// more coding</span><br><span class="line"></span><br><span class="line">git add -A</span><br><span class="line">git commit -m <span class="string">'fixed hotfix-bug1117'</span></span><br><span class="line"></span><br><span class="line">git checkout master</span><br><span class="line">git rebase hotfix-bug1117</span><br><span class="line"></span><br><span class="line">// ç„¶åå‘å¸ƒ</span><br><span class="line"></span><br><span class="line">// æœ€åï¼Œéœ€è¦æŠŠä¿®æ”¹åˆå¹¶åˆ°devåˆ†æ”¯ï¼Œå‡å¦‚åˆšæ‰çš„æäº¤commitæ˜¯abcdefg</span><br><span class="line">git checkout dev</span><br><span class="line">git cherry-pick abcdefg</span><br><span class="line">// å¯èƒ½éœ€è¦è§£å†³å†²çª</span><br><span class="line"></span><br><span class="line">// æœ€å åˆ é™¤ `hotfix-bug1117` åˆ†æ”¯</span><br><span class="line">git branch -d hotfix-bug1117</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç®€å•æ•´ç†ä¸€ä¸‹å¤šäººåŒä¸€è¿œç¨‹ä»“åº“gitå·¥ä½œæµæ¨¡å¼ã€‚&lt;/p&gt;
&lt;h2 id=&quot;1-åˆå§‹åŒ–æœ¬åœ°ä»“åº“&quot;&gt;&lt;a href=&quot;#1-åˆå§‹åŒ–æœ¬åœ°ä»“åº“&quot; class=&quot;headerlink&quot; title=&quot;1. åˆå§‹åŒ–æœ¬åœ°ä»“åº“&quot;&gt;&lt;/a&gt;1. åˆå§‹åŒ–æœ¬åœ°ä»“åº“&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;// å·²æœ‰é¡¹ç›®&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; git@github.com:mrzzcn/mrzzcn.github.io.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// æ–°å»ºé¡¹ç›®&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git init&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Technology" scheme="https://mrzzcn.github.io/categories/Technology/"/>
    
      <category term="Git" scheme="https://mrzzcn.github.io/categories/Technology/Git/"/>
    
    
      <category term="éšç¬”" scheme="https://mrzzcn.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="Git" scheme="https://mrzzcn.github.io/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript The Good Parts</title>
    <link href="https://mrzzcn.github.io/2015/05/24/JavaScript-The-Good-Parts/"/>
    <id>https://mrzzcn.github.io/2015/05/24/JavaScript-The-Good-Parts/</id>
    <published>2015-05-24T09:30:57.000Z</published>
    <updated>2019-04-27T01:43:35.928Z</updated>
    
    <content type="html"><![CDATA[<h5 id="ä½¿ç”¨ä¸€ä¸ªmethod-æ–¹æ³•å®šä¹‰æ–°æ–¹æ³•"><a href="#ä½¿ç”¨ä¸€ä¸ªmethod-æ–¹æ³•å®šä¹‰æ–°æ–¹æ³•" class="headerlink" title="ä½¿ç”¨ä¸€ä¸ªmethod æ–¹æ³•å®šä¹‰æ–°æ–¹æ³•"></a>ä½¿ç”¨ä¸€ä¸ªmethod æ–¹æ³•å®šä¹‰æ–°æ–¹æ³•</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.method = <span class="function"><span class="keyword">function</span> (<span class="params">name, func</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.prototype[name]) &#123;</span><br><span class="line">        <span class="keyword">this</span>.prototype[name] = func;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h5 id="æ ¹æ®æ•°å­—çš„æ­£è´Ÿæ¥åˆ¤æ–­æ˜¯ä½¿ç”¨Math-ceiling-è¿˜æ˜¯Math-floor"><a href="#æ ¹æ®æ•°å­—çš„æ­£è´Ÿæ¥åˆ¤æ–­æ˜¯ä½¿ç”¨Math-ceiling-è¿˜æ˜¯Math-floor" class="headerlink" title="æ ¹æ®æ•°å­—çš„æ­£è´Ÿæ¥åˆ¤æ–­æ˜¯ä½¿ç”¨Math.ceiling è¿˜æ˜¯Math.floor"></a>æ ¹æ®æ•°å­—çš„æ­£è´Ÿæ¥åˆ¤æ–­æ˜¯ä½¿ç”¨Math.ceiling è¿˜æ˜¯Math.floor</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Number</span>.method(<span class="string">"integer"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>[<span class="keyword">this</span> &lt; <span class="number">0</span> ? <span class="string">'ceil'</span> : <span class="string">'floor'</span>](<span class="keyword">this</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><a id="more"></a><hr><h5 id="ç§»é™¤å­—ç¬¦ä¸²é¦–å°¾çš„ç©ºç™½"><a href="#ç§»é™¤å­—ç¬¦ä¸²é¦–å°¾çš„ç©ºç™½" class="headerlink" title="ç§»é™¤å­—ç¬¦ä¸²é¦–å°¾çš„ç©ºç™½"></a>ç§»é™¤å­—ç¬¦ä¸²é¦–å°¾çš„ç©ºç™½</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.method(<span class="string">"trim"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.replace(<span class="regexp">/^\s+|\s+$/g</span>, <span class="string">''</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><hr><h5 id="é—­åŒ…æ¼”ç¤º"><a href="#é—­åŒ…æ¼”ç¤º" class="headerlink" title="é—­åŒ…æ¼”ç¤º"></a>é—­åŒ…æ¼”ç¤º</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObject = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> value = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        increment: <span class="function"><span class="keyword">function</span> (<span class="params">inc</span>) </span>&#123;</span><br><span class="line">            value += <span class="keyword">typeof</span> inc === <span class="string">"number"</span> ? inc : <span class="number">1</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        getValue: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure><hr><h5 id="ç¼“å­˜ä¸­é—´è®¡ç®—ç»“æœ-æ–æ³¢çº³æŒˆæ•°ç»„"><a href="#ç¼“å­˜ä¸­é—´è®¡ç®—ç»“æœ-æ–æ³¢çº³æŒˆæ•°ç»„" class="headerlink" title="ç¼“å­˜ä¸­é—´è®¡ç®—ç»“æœ - æ–æ³¢çº³æŒˆæ•°ç»„"></a>ç¼“å­˜ä¸­é—´è®¡ç®—ç»“æœ - æ–æ³¢çº³æŒˆæ•°ç»„</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰</span></span><br><span class="line"><span class="keyword">var</span> memoizer = <span class="function"><span class="keyword">function</span> (<span class="params">memo, formula</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> recur = <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> result = memo[n];</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> result !== <span class="string">'number'</span>) &#123;</span><br><span class="line">            result = formula(recur, n);</span><br><span class="line">            memo[n] = result;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> recur;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">var</span> fibonacci = memoizer([<span class="number">0</span>, <span class="number">1</span>], <span class="function"><span class="keyword">function</span> (<span class="params">recur, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> recur(n<span class="number">-1</span>) + recur(n - <span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"%d : %d"</span>, i, fibonacci(i));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰©å±•ç”¨æ³• é˜¶ä¹˜</span></span><br><span class="line"><span class="keyword">var</span> factorial = memoizer([<span class="number">1</span>, <span class="number">1</span>], <span class="function"><span class="keyword">function</span> (<span class="params">recur, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n * recur (n - <span class="number">1</span>)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"%d : %d"</span>, i, factorial(i));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h5 id="å¦‚ä½•å®ç°ç»§æ‰¿-å‡½æ•°åŒ–"><a href="#å¦‚ä½•å®ç°ç»§æ‰¿-å‡½æ•°åŒ–" class="headerlink" title="å¦‚ä½•å®ç°ç»§æ‰¿ - å‡½æ•°åŒ–"></a>å¦‚ä½•å®ç°ç»§æ‰¿ - å‡½æ•°åŒ–</h5><ol><li>åˆ›å»ºä¸€ä¸ªå¯¹è±¡</li><li>æœ‰é€‰æ‹©åœ°å®šä¹‰ç§æœ‰å®ä¾‹å˜é‡å’Œæ–¹æ³•ã€‚è¿™äº›å°±æ˜¯å‡½æ•°ä¸­é€šè¿‡<code>var</code>è¯­å¥å®šä¹‰çš„æ™®é€šå˜é‡</li><li>ç»™è¿™ä¸ªæ–°å¯¹è±¡æ‰©å……æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æ‹¥æœ‰ç‰¹æƒå»è®¿é—®å‚æ•°ï¼Œä»¥åŠä¸Šä¸€æ­¥ä¸­å®šä¹‰çš„å˜é‡ã€‚</li><li>è¿”å›è¿™ä¸ªæ–°å¯¹è±¡</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™é‡Œæ˜¯ä¸€ä¸ªå‡½æ•°åŒ–æ„é€ å™¨çš„ä¼ªä»£ç æ¨¡æ¿ï¼ˆåŠ ç²—çš„æ–‡æœ¬è¡¨ç¤ºå¼ºè°ƒï¼‰ï¼š</span></span><br><span class="line"><span class="keyword">var</span> **<span class="keyword">constructor</span>** = function (spec, my) &#123;</span><br><span class="line">    <span class="comment">// ä»£ç å¿«å†…éƒ¨ä¸çŸ¥é“æ€ä¹ˆåŠ ç²—ï¼Œå“ªä½å¤§ç¥æŒ‡ç‚¹ä¸€ä¸‹</span></span><br><span class="line">    <span class="keyword">var</span> that, **å…¶ä»–ç§æœ‰å˜é‡**;</span><br><span class="line">    my = my || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// **æŠŠå…±äº«çš„å˜é‡å’Œå‡½æ•°æ·»åŠ åˆ°myä¸­**</span></span><br><span class="line"></span><br><span class="line">    that = &#123;</span><br><span class="line">        name: <span class="string">"**ä¸€ä¸ªæ–°å¯¹è±¡**"</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// **ç»™thatæ·»åŠ ç‰¹æƒæ–¹æ³•**</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> that;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// spec å¯¹è±¡åŒ…å«æ„é€ å™¨éœ€è¦æ„é€ ä¸€ä¸ªæ–°å®ä¾‹çš„æ‰€å“Ÿä¿¡æ¯ã€‚spec çš„å†…å®¹å¯èƒ½ä¼šè¢«å¤åˆ¶åˆ°ç§æœ‰å˜é‡ä¸­ï¼Œæˆ–è€…è¢«å…¶ä»–å‡½æ•°æ”¹å˜ï¼Œæˆ–è€…æ–¹æ³•å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™è®¿é—®specçš„ä¿¡æ¯ã€‚ï¼ˆä¸€ä¸ªç®€åŒ–çš„æ–¹å¼æ˜¯æ›¿æ¢specä¸ºä¸€ä¸ªå•ä¸€çš„å€¼ã€‚å½“æ„é€ å¯¹è±¡è¿‡ç¨‹ä¸­å¹¶ä¸éœ€è¦æ•´ä¸ªspecå¯¹è±¡çš„æ—¶å€™ï¼Œè¿™æ˜¯æœ‰ç”¨çš„ã€‚ï¼‰</span></span><br><span class="line"><span class="comment">// my å¯¹è±¡æ˜¯ä¸€ä¸ªä¸ºç»§æ‰¿é“¾ä¸­çš„æ„é€ å™¨æä¾›ç§˜å¯†å…±äº«çš„å®¹å™¨ã€‚myå¯¹è±¡å¯ä»¥é€‰æ‹©æ€§åœ°ä½¿ç”¨ã€‚å¦‚æœæ²¡æœ‰ä¼ å…¥ä¸€ä¸ªmyå¯¹è±¡ï¼Œé‚£ä¹ˆä¼šåˆ›å»ºä¸€ä¸ªmyå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// demo</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mammal = <span class="function"><span class="keyword">function</span> (<span class="params">spec</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> that = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    that.get_name = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> spec.name;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    that.says = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> spec.saying || <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> that;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cat = <span class="function"><span class="keyword">function</span> (<span class="params">spec</span>) </span>&#123;</span><br><span class="line">    spec.saying = spec.saying || <span class="string">'meow'</span>;</span><br><span class="line">    <span class="keyword">var</span> that = mammal(spec);</span><br><span class="line">    that.purr = <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> i, s = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s) &#123;</span><br><span class="line">                s += <span class="string">"-"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            s += <span class="string">"r"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;;</span><br><span class="line">    that.get_name = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> that.says() + <span class="string">" "</span> + spec.name + <span class="string">" "</span> + that.says();</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> that;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myCat = cat(&#123;<span class="attr">name</span>: <span class="string">"Henrietta"</span>&#125;);</span><br></pre></td></tr></table></figure><h5 id="å‡½æ•°åŒ–æ¨¡å¼è¿˜æä¾›äº†ä¸€ä¸ªå¤„ç†çˆ¶ç±»æ–¹æ³•çš„æ–¹æ³•ã€‚æˆ‘ä»¬ä¼šæ„é€ ä¸€ä¸ªsuperioræ–¹æ³•ï¼Œå®ƒå–å¾—ä¸€ä¸ªæ–¹æ³•åå¹¶è¿”å›è°ƒç”¨é‚£ä¸ªæ–¹æ³•çš„å‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šè°ƒç”¨åŸæ¥çš„æ–¹æ³•ï¼Œå°½ç®¡å±æ€§å·²ç»å˜åŒ–äº†ã€‚"><a href="#å‡½æ•°åŒ–æ¨¡å¼è¿˜æä¾›äº†ä¸€ä¸ªå¤„ç†çˆ¶ç±»æ–¹æ³•çš„æ–¹æ³•ã€‚æˆ‘ä»¬ä¼šæ„é€ ä¸€ä¸ªsuperioræ–¹æ³•ï¼Œå®ƒå–å¾—ä¸€ä¸ªæ–¹æ³•åå¹¶è¿”å›è°ƒç”¨é‚£ä¸ªæ–¹æ³•çš„å‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šè°ƒç”¨åŸæ¥çš„æ–¹æ³•ï¼Œå°½ç®¡å±æ€§å·²ç»å˜åŒ–äº†ã€‚" class="headerlink" title="å‡½æ•°åŒ–æ¨¡å¼è¿˜æä¾›äº†ä¸€ä¸ªå¤„ç†çˆ¶ç±»æ–¹æ³•çš„æ–¹æ³•ã€‚æˆ‘ä»¬ä¼šæ„é€ ä¸€ä¸ªsuperioræ–¹æ³•ï¼Œå®ƒå–å¾—ä¸€ä¸ªæ–¹æ³•åå¹¶è¿”å›è°ƒç”¨é‚£ä¸ªæ–¹æ³•çš„å‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šè°ƒç”¨åŸæ¥çš„æ–¹æ³•ï¼Œå°½ç®¡å±æ€§å·²ç»å˜åŒ–äº†ã€‚"></a>å‡½æ•°åŒ–æ¨¡å¼è¿˜æä¾›äº†ä¸€ä¸ªå¤„ç†çˆ¶ç±»æ–¹æ³•çš„æ–¹æ³•ã€‚æˆ‘ä»¬ä¼šæ„é€ ä¸€ä¸ªsuperioræ–¹æ³•ï¼Œå®ƒå–å¾—ä¸€ä¸ªæ–¹æ³•åå¹¶è¿”å›è°ƒç”¨é‚£ä¸ªæ–¹æ³•çš„å‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šè°ƒç”¨åŸæ¥çš„æ–¹æ³•ï¼Œå°½ç®¡å±æ€§å·²ç»å˜åŒ–äº†ã€‚</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.method(<span class="string">'superior'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> that = <span class="keyword">this</span>,</span><br><span class="line">        method = that[name];</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> method.apply(that, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬åœ¨coolcatä¸Šè¯•éªŒä¸€ä¸‹ï¼Œcoolcatå°±åƒcatä¸€æ ·ï¼Œé™¤äº†å®ƒæœ‰ä¸€ä¸ªæ›´é…·çš„è°ƒç”¨çˆ¶ç±»æ–¹æ³•çš„get_nameæ–¹æ³•ã€‚å®ƒåªéœ€è¦ä¸€ç‚¹ç‚¹çš„å‡†å¤‡å·¥ä½œã€‚æˆ‘ä»¬ä¼šå£°æ˜ä¸€ä¸ªsuper_get_nameå˜é‡ï¼Œå¹¶ä¸”æŠŠè°ƒç”¨superioræ–¹æ³•æ‰€è¿”å›çš„ç»“æœèµ‹å€¼ç»™å®ƒã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> coolcat = <span class="function"><span class="keyword">function</span> (<span class="params">spec</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> that = cat(spec),</span><br><span class="line">        super_get_name = that.superior(<span class="string">'get_name'</span>);</span><br><span class="line">    that.get_name = <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'like '</span> + super_get_name() + <span class="string">' baby'</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> that;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myCoolCat = coolcat(&#123;<span class="attr">name</span>: <span class="string">'Bix'</span>&#125;);</span><br><span class="line"><span class="keyword">var</span> name = myCoolCat.get_name();</span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// "like meow Bix meow baby"</span></span><br></pre></td></tr></table></figure></p><hr><h5 id="éƒ¨ä»¶"><a href="#éƒ¨ä»¶" class="headerlink" title="éƒ¨ä»¶"></a>éƒ¨ä»¶</h5><p>æˆ‘ä»¬å¯ä»¥ä»ä¸€å¥—éƒ¨ä»¶ä¸­æŠŠå¯¹è±¡ç»„è£…å‡ºæ¥ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªç»™ä»»ä½•å¯¹è±¡æ·»åŠ ç®€å•äº‹ä»¶å¤„ç†ç‰¹æ€§çš„å‡½æ•°ã€‚ä»–ä¼šç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ª<code>on</code>æ–¹æ³•ã€ä¸€ä¸ª<code>fire</code>æ–¹æ³•å’Œä¸€ä¸ªç§æœ‰çš„äº‹ä»¶æ³¨å†Œè¡¨å¯¹è±¡ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> eventuality = <span class="function"><span class="keyword">function</span> (<span class="params">that</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> registry = &#123;&#125;;</span><br><span class="line">    that.fire = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šè§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚è¯¥äº‹ä»¶å¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«äº‹ä»¶åç§°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="comment">// æˆ–è€…æ˜¯ä¸€ä¸ªæ‹¥æœ‰åŒ…å«äº‹ä»¶åç§°çš„ type å±æ€§çš„å¯¹è±¡ã€‚</span></span><br><span class="line">        <span class="comment">// é€šè¿‡'on'æ–¹æ³•æ³¨å†Œçš„äº‹ä»¶å¤„ç†ç¨‹åºä¸­åŒ¹é…äº‹ä»¶åç§°çš„å‡½æ•°å°†è¢«è°ƒç”¨ã€‚</span></span><br><span class="line">        <span class="keyword">var</span> array,</span><br><span class="line">            func,</span><br><span class="line">            handler,</span><br><span class="line">            i,</span><br><span class="line">            type = <span class="keyword">typeof</span> event === <span class="string">'string'</span> ? event : event.type;</span><br><span class="line">        <span class="keyword">if</span> (registry.hasOwnProperty(type)) &#123;</span><br><span class="line">            array = registry[type];</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; array.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">                handler = array[i];</span><br><span class="line">                <span class="comment">// æ¯ä¸ªå¤„ç†ç¨‹åºåŒ…å«ä¸€ä¸ªæ–¹æ³•å’Œä¸€ç»„å¯é€‰çš„å‚æ•°ã€‚</span></span><br><span class="line">                <span class="comment">// å¦‚æœè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„åå­—ï¼Œé‚£ä¹ˆå¯»æ‰¾åˆ°è¯¥å‡½æ•°ã€‚</span></span><br><span class="line">                func = handler.method;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> func === <span class="string">'string'</span>) &#123;</span><br><span class="line">                    func = <span class="keyword">this</span>[func];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// è°ƒç”¨ä¸€ä¸ªå¤„ç†ç¨‹åºã€‚å¦‚æœè¯¥æ¡ç›®åŒ…å«å‚æ•°ï¼Œé‚£ä¹ˆä¼ é€’å®ƒä»¬è¿‡å»ã€‚å¦åˆ™ï¼Œä¼ é€’è¯¥äº‹ä»¶å¯¹è±¡ã€‚</span></span><br><span class="line">                func.apply(<span class="keyword">this</span>, handler.parameters || [event]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    that.on = <span class="function"><span class="keyword">function</span> (<span class="params">type, method, parameters</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// æ³¨å†Œä¸€ä¸ªäº‹ä»¶ã€‚æ„é€ ä¸€æ¡å¤„ç†ç¨‹åºæ¡ç›®ã€‚å°†å®ƒæ’å…¥åˆ°å¤„ç†ç¨‹åºæ•°ç»„ä¸­ï¼Œ</span></span><br><span class="line">        <span class="comment">// å¦‚æœè¿™ç§ç±»å‹çš„äº‹ä»¶è¿˜ä¸å­˜åœ¨ï¼Œå°±æ„é€ ä¸€ä¸ªã€‚</span></span><br><span class="line">        <span class="keyword">var</span> handler = &#123;</span><br><span class="line">            method: method,</span><br><span class="line">            parameters: parameters</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">if</span> (registry.hasOwnProperty(type)) &#123;</span><br><span class="line">            registry[type].push(handler);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            registry[type] = [handler];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> that;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•å•ç‹¬çš„å¯¹è±¡ä¸Šè°ƒç”¨eventuality, æˆäºˆå®ƒäº‹ä»¶å¤„ç†æ–¹æ³•ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥èµ¶åœ¨<code>that</code>è¢«è¿”å›ä¹‹å‰åœ¨ä¸€ä¸ªæ„é€ å™¨å‡½æ•°ä¸­è°ƒç”¨å®ƒ <code>eventuality(that);</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">eventuality(myCoolCat);</span><br><span class="line">myCoolCat.health = <span class="number">100</span>;</span><br><span class="line">myCoolCat.on(<span class="string">'dead'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> date = event.date;</span><br><span class="line">    <span class="keyword">var</span> killer = event.killer;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"%s killed me at %s"</span>, killer, date);</span><br><span class="line">&#125;);</span><br><span class="line">myCoolCat.on(<span class="string">'hurt'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.health -= <span class="number">50</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.health &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> event = &#123;</span><br><span class="line">            type: <span class="string">'dead'</span>,</span><br><span class="line">            killer: <span class="string">'stone from sky'</span>,</span><br><span class="line">            date: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">this</span>.fire(event);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'nothing, who is the strong guy.'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">myCoolCat.fire(<span class="string">"hurt"</span>); <span class="comment">//nothing, who is the strong guy.</span></span><br><span class="line">myCoolCat.fire(<span class="string">"hurt"</span>); <span class="comment">//stone from sky killed me at Sat Mar 14 2015 15:47:29 GMT+0800 (CST)</span></span><br></pre></td></tr></table></figure></p><hr><h5 id="æ•°ç»„ä¸å¯¹è±¡"><a href="#æ•°ç»„ä¸å¯¹è±¡" class="headerlink" title="æ•°ç»„ä¸å¯¹è±¡"></a>æ•°ç»„ä¸å¯¹è±¡</h5><p>javascript ç¼–ç¨‹ä¸­ï¼Œä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯åœ¨å¿…é¡»ä½¿ç”¨æ•°ç»„æ—¶ä½¿ç”¨äº†å¯¹è±¡ï¼Œæˆ–è€…åœ¨å¿…é¡»ä½¿ç”¨å¯¹è±¡æ—¶ä½¿ç”¨äº†æ•°ç»„ã€‚å…¶å®è§„åˆ™å¾ˆç®€å•ï¼šå½“å±æ€§åæ˜¯å°è€Œè¿ç»­çš„æ•´æ•°æ—¶ï¼Œä½ åº”è¯¥ä½¿ç”¨æ•°ç»„ã€‚å¦åˆ™ï¼Œä½¿ç”¨å¯¹è±¡ã€‚<br>javascript æœ¬èº«æ²¡æœ‰ä¸€ä¸ªå¥½çš„æœºåˆ¶æ¥åŒºåˆ†æ•°ç»„å’Œå¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å®šä¹‰è‡ªå·±çš„is_arrayå‡½æ•°æ¥å¼¥è¡¥è¿™ä¸ªç¼ºé™·ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> is_array = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">        &amp;&amp; <span class="keyword">typeof</span> value === <span class="string">'object'</span></span><br><span class="line">        &amp;&amp; value.constructor === <span class="built_in">Array</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ä¸è¿‡è¯¥æ–¹æ³•åœ¨è¯†åˆ«ä»ä¸åŒçš„çª—å£(window)æˆ–è€…frameé‡Œæ„é€ çš„æ•°ç»„æ—¶ä¼šå¤±è´¥ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ›´å¥½çš„æ–¹å¼</span></span><br><span class="line"><span class="comment">// ä¸Šé¢è¿™å¥è¯è¿™é‡Œæœ¬äººå°šæœªç†è§£ï¼Œè¯·é«˜æ‰‹æŒ‡ç‚¹</span></span><br><span class="line"><span class="keyword">var</span> is_array = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.apply(value) === <span class="string">'[object Array]'</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h5 id="ä¸ºæ•°ç»„æ‰©å……reduceå‡½æ•°"><a href="#ä¸ºæ•°ç»„æ‰©å……reduceå‡½æ•°" class="headerlink" title="ä¸ºæ•°ç»„æ‰©å……reduceå‡½æ•°"></a>ä¸ºæ•°ç»„æ‰©å……reduceå‡½æ•°</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.method(<span class="string">'reduce'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">f, value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">        value = f(<span class="keyword">this</span>[i], value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// DEMO</span></span><br><span class="line"><span class="keyword">var</span> data = [<span class="number">4</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">42</span>];</span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> mult = <span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> sum = data.reduce(add, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">console</span>.log(sum);<span class="comment">// 108</span></span><br><span class="line"><span class="keyword">var</span> product = data.reduce(mult, <span class="number">1</span>);</span><br><span class="line"><span class="built_in">console</span>.log(product); <span class="comment">// 7418880</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å› ä¸ºæ•°ç»„å…¶å®å°±æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ç»™ä¸€ä¸ªå•ç‹¬çš„æ•°ç»„æ·»åŠ æ–¹æ³•</span></span><br><span class="line">data.total = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.reduce(add, <span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> total = data.total();</span><br><span class="line"><span class="built_in">console</span>.log(total); <span class="comment">// 108</span></span><br></pre></td></tr></table></figure><h5 id="ä¸ºæ•°ç»„æŒ‡å®šåˆå§‹å€¼"><a href="#ä¸ºæ•°ç»„æŒ‡å®šåˆå§‹å€¼" class="headerlink" title="ä¸ºæ•°ç»„æŒ‡å®šåˆå§‹å€¼"></a>ä¸ºæ•°ç»„æŒ‡å®šåˆå§‹å€¼</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.dim = <span class="function"><span class="keyword">function</span> (<span class="params">dimension, initial</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = [], i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; dimension; i += <span class="number">1</span>) &#123;</span><br><span class="line">        a[i] = initial;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> myArray = <span class="built_in">Array</span>.dim(<span class="number">10</span>, <span class="number">0</span>); <span class="comment">//[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">// æ³¨æ„è¿™é‡Œä¸èƒ½ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰è¯´çš„methodæ–¹æ³•ï¼Œåº”ä¸ºé‚£ä¸ªæ–¹æ³•æ˜¯ç»™æŸä¸ªç±»å‹çš„æ¯ä¸€ä¸ªå…·ä½“çš„å¯¹è±¡å¢åŠ æ–¹æ³•çš„ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬æ˜¯ç»™Arrayè¿™ä¸ª ç±»å‹ å¢åŠ æ–¹æ³•ï¼Œç±»ä¼¼äºæŸäº›é™æ€è¯­è¨€ä¸­çš„é™æ€æ–¹æ³•æˆ–è€…ç±»æ–¹æ³•</span></span><br></pre></td></tr></table></figure><h5 id="æ•°ç»„æ’åº"><a href="#æ•°ç»„æ’åº" class="headerlink" title="æ•°ç»„æ’åº"></a>æ•°ç»„æ’åº</h5><p><code>sort</code> æ–¹æ³•ä¼š<code>array</code>ä¸­çš„å†…å®¹è¿›è¡Œæ’åºã€‚ä½†æ˜¯å®ƒä¸èƒ½æ­£ç¡®ç¬¬ç»™ä¸€ç»„æ•°å­—æ’åºï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myNumbers = [<span class="number">4</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">42</span>];</span><br><span class="line">myNumbers.sort(); <span class="comment">// [15, 16, 23, 4, 42, 8]</span></span><br></pre></td></tr></table></figure></p><p>javascript çš„é»˜è®¤æ¯”è¾ƒå‡½æ•°æŠŠè¦è¢«æ’åºçš„å…ƒç´ éƒ½è§†ä¸ºå­—ç¬¦ä¸²ã€‚å®ƒå°šæœªè¶³å¤Ÿæ™ºèƒ½åˆ°åœ¨æ¯”è¾ƒè¿™äº›å…ƒç´ ä¹‹å‰å…ˆæ£€æµ‹ä»–ä»¬çš„ç±»å‹ï¼Œæ‰€ä»¥å½“å®ƒæ¯”è¾ƒè¿™äº›æ•°å­—çš„æ—¶å€™ï¼Œä¼šæŠŠå®ƒä»¬è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œäºæ˜¯å¾—åˆ°ä¸€ä¸ªé”™çš„ç¦»è°±çš„ç»“æœã€‚<br>è¾›è¿çš„æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨è‡ªå·±çš„æ¯”è¾ƒå‡½æ•°æ¥æ›¿æ¢é»˜è®¤çš„æ¯”è¾ƒå‡½æ•°ã€‚</p><blockquote><p>ä½ çš„æ¯”è¾ƒå‡½æ•°åº”è¯¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶ä¸”å¦‚æœè¿™ä¸¤ä¸ªå‚æ•°ç›¸ç­‰åˆ™è¿”å›0ï¼Œå¦‚æœç¬¬1ä¸ªå‚æ•°åº”è¯¥æ’åˆ—åœ¨å‰é¢ï¼Œåˆ™è¿”å›ä¸€ä¸ªè´Ÿæ•°ï¼Œå¦‚æœç¬¬2ä¸ªå‚æ•°åº”è¯¥æ’åœ¨å‰é¢ï¼Œåˆ™è¿”å›ä¸€ä¸ªæ­£æ•°ã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myNumbers.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a - b;</span><br><span class="line">&#125;); <span class="comment">// [4, 8, 15, 16, 23, 42]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸ªå‡½æ•°å¯ä»¥ä½¿æ•°å­—æ­£ç¡®æ’åºï¼Œä½†å®ƒä¸èƒ½ä½¿å­—ç¬¦ä¸²æ’åºã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ç»™ä»»ä½•åŒ…å«ç®€å•å€¼çš„æ•°ç»„æ’åºï¼Œå¿…é¡»è¦åšæ›´å¤šçš„å·¥ä½œï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myStrings = [<span class="string">'aa'</span>, <span class="string">'bb'</span>, <span class="string">'a'</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">42</span>];</span><br><span class="line">myStrings.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a === b) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="keyword">typeof</span> b) &#123;</span><br><span class="line">        <span class="keyword">return</span> a &lt; b ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> a &lt; <span class="keyword">typeof</span> b ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">&#125;); <span class="comment">//[4, 8, 15, 16, 23, 42, "a", "aa", "bb"]</span></span><br></pre></td></tr></table></figure></p><h5 id="å¯¹è±¡æ•°ç»„æ’åº"><a href="#å¯¹è±¡æ•°ç»„æ’åº" class="headerlink" title="å¯¹è±¡æ•°ç»„æ’åº"></a>å¯¹è±¡æ•°ç»„æ’åº</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// by å‡½æ•°æ¥å—ä¸€ä¸ªæˆå‘˜åå­—å­—ç¬¦ä¸²åšä¸ºå‚æ•°ï¼Œ</span></span><br><span class="line"><span class="comment">// å¹¶è¿”å›ä¸€ä¸ªå¯ä»¥ç”¨æ¥å¯¹åŒ…å«è¯¥æˆå‘˜çš„å¯¹è±¡æ•°ç»„çš„è¿›è¡Œæ’åºçš„æ¯”è¾ƒå‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> by = <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">o, p</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a, b;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> o === <span class="string">'object'</span> &amp;&amp; <span class="keyword">typeof</span> p === <span class="string">'object'</span> &amp;&amp; o &amp;&amp; p) &#123;</span><br><span class="line">            a = o[name];</span><br><span class="line">            b = p[name];</span><br><span class="line">            <span class="keyword">if</span> (a === b) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="keyword">typeof</span> b) &#123;</span><br><span class="line">                <span class="keyword">return</span> a &lt; b ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">typeof</span> a &lt; <span class="keyword">typeof</span> b ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> &#123;</span><br><span class="line">                name: <span class="string">'Error'</span>,</span><br><span class="line">                message: <span class="string">'Expected an object when sorting by '</span> + name</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> myPeople = [</span><br><span class="line">    &#123;<span class="attr">first</span>: <span class="string">'Joe'</span>,      <span class="attr">last</span>: <span class="string">'Beasser'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">first</span>: <span class="string">'Moe'</span>,      <span class="attr">last</span>: <span class="string">'Howard'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">first</span>: <span class="string">'Joe'</span>,      <span class="attr">last</span>: <span class="string">'DeRita'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">first</span>: <span class="string">'Shemp'</span>,    <span class="attr">last</span>: <span class="string">'Howard'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">first</span>: <span class="string">'Larry'</span>,    <span class="attr">last</span>: <span class="string">'Fine'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">first</span>: <span class="string">'Curly'</span>,    <span class="attr">last</span>: <span class="string">'Howard'</span>&#125;</span><br><span class="line">];</span><br><span class="line">myPeople.sort(by(<span class="string">'first'</span>));</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[</span></span><br><span class="line"><span class="comment">&#123;first: "Curly",    last: "Howard"&#125;,</span></span><br><span class="line"><span class="comment">&#123;first: "Joe",      last: "Beasser"&#125;,</span></span><br><span class="line"><span class="comment">&#123;first: "Joe",      last: "DeRita"&#125;,</span></span><br><span class="line"><span class="comment">&#123;first: "Larry",    last: "Fine"&#125;,</span></span><br><span class="line"><span class="comment">&#123;first: "Moe",      last: "Howard"&#125;,</span></span><br><span class="line"><span class="comment">&#123;tfirst: "Shemp",   last: "Howard"&#125;</span></span><br><span class="line"><span class="comment">]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>sort æ–¹æ³•æ˜¯ä¸ç¨³å®šçš„</p><blockquote><p>æ’åºçš„ç¨³å®šæ€§æ˜¯æŒ‡æ’åºåæ•°ç»„ä¸­çš„ç›¸ç­‰å€¼çš„ç›¸å¯¹ä½ç½®æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œè€Œä¸ç¨³å®šæ€§æ’åºåˆ™ä¼šæ”¹å˜ç›¸ç­‰å€¼çš„ç›¸å¯¹ä½ç½®ã€‚è¯¦ç»†å†…å®¹å‚è§<a href="http://zh.wikipedia.org/wiki/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95#.E7.A9.A9.E5.AE.9A.E7.9A.84.E6.8E.92.E5.BA.8F" target="_blank" rel="noopener">æ’åºç®—æ³•</a>ã€‚JavaScriptçš„<code>sort</code>æ–¹æ³•çš„ç¨³å®šæ€§æ ¹æ®ä¸åŒæµè§ˆå™¨çš„å®ç°è€Œä¸ä¸€è‡´ã€‚å¯å‚è§<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/sort" target="_blank" rel="noopener">Array.prototype.sort</a>ä¸­çš„ä»‹ç»ã€‚</p></blockquote><p>ä¸‹é¢çš„è°ƒç”¨ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">myPeople.sort(by(<span class="string">'last'</span>)).sort(by(<span class="string">'first'</span>));</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[</span></span><br><span class="line"><span class="comment">&#123;"first": "Curly",  "last": "Howard"&#125;,</span></span><br><span class="line"><span class="comment">&#123;"first": "Joe",    "last": "Beasser"&#125;,</span></span><br><span class="line"><span class="comment">&#123;"first": "Joe",    "last": "DeRita"&#125;,</span></span><br><span class="line"><span class="comment">&#123;"first": "Larry",  "last": "Fine"&#125;,</span></span><br><span class="line"><span class="comment">&#123;"first": "Moe",    "last": "Howard"&#125;,</span></span><br><span class="line"><span class="comment">&#123;"first": "Shemp",  "last": "Howard"&#125;]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></p><p>ä¸èƒ½ä¿è¯äº§ç”Ÿæ­£ç¡®çš„åºåˆ—ã€‚å¦‚æœä½ æƒ³åŸºäºå¤šä¸ªé”®å€¼è¿›è¡Œæ’åºï¼Œä½ éœ€è¦å†æ¬¡åšæ›´å¤šçš„å·¥ä½œã€‚æˆ‘ä»¬å¯ä»¥ä¿®æ”¹byå‡½æ•°ï¼Œè®©å…¶å¯ä»¥æ¥å—ç¬¬2ä¸ªå‚æ•°ï¼Œå½“ä¸»è¦çš„é”®å€¼äº§ç”Ÿä¸€ä¸ªåŒ¹é…çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªcompareæ–¹æ³•å°†è¢«è°ƒç”¨ä»¥å†³å‡ºé«˜ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// by å‡½æ•°æ¥å—ä¸€ä¸ªæˆå‘˜åå­—å­—ç¬¦ä¸²å’Œä¸€ä¸ªå¯é€‰çš„æ¬¡è¦æ¯”è¾ƒå‡½æ•°åšä¸ºå‚æ•°ï¼Œ</span></span><br><span class="line"><span class="comment">// å¹¶è¿”å›ä¸€ä¸ªå¯ä»¥ç”¨æ¥å¯¹åŒ…å«è¯¥æˆå‘˜çš„å¯¹è±¡æ•°ç»„è¿›è¡Œæ’åºçš„æ¯”è¾ƒå‡½æ•°ã€‚</span></span><br><span class="line"><span class="comment">// å½“ o[name] å’Œ p[name] ç›¸ç­‰æ—¶ï¼Œæ¬¡è¦æ¯”è¾ƒå‡½æ•°è¢«ç”¨æ¥å†³å‡ºé«˜ä¸‹ã€‚</span></span><br><span class="line"><span class="keyword">var</span> by = <span class="function"><span class="keyword">function</span> (<span class="params">name, minor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">o, p</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a, b;</span><br><span class="line">        <span class="keyword">if</span> (o &amp;&amp; p &amp;&amp; <span class="keyword">typeof</span> o === <span class="string">'object'</span> &amp;&amp; <span class="keyword">typeof</span> p === <span class="string">'object'</span>) &#123;</span><br><span class="line">            a = o[name];</span><br><span class="line">            b = p[name];</span><br><span class="line">            <span class="keyword">if</span> (a === b) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">typeof</span> minor === <span class="string">'function'</span> ? minor(o, p) : <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="keyword">typeof</span> b) &#123;</span><br><span class="line">                <span class="keyword">return</span> a &lt; b ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">typeof</span> a &lt; <span class="keyword">typeof</span> b ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> &#123;</span><br><span class="line">                name: <span class="string">'Error'</span>,</span><br><span class="line">                message: <span class="string">'Expected an object when sorting by '</span> + name</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line">myPeople.sort(by(<span class="string">'last'</span>, by(<span class="string">'first'</span>)));</span><br><span class="line">[</span><br><span class="line">&#123;<span class="string">"first"</span>: <span class="string">"Joe"</span>,    <span class="string">"last"</span>: <span class="string">"Beasser"</span>&#125;,</span><br><span class="line">&#123;<span class="string">"first"</span>: <span class="string">"Joe"</span>,    <span class="string">"last"</span>: <span class="string">"DeRita"</span>&#125;,</span><br><span class="line">&#123;<span class="string">"first"</span>: <span class="string">"Larry"</span>,  <span class="string">"last"</span>: <span class="string">"Fine"</span>&#125;,</span><br><span class="line">&#123;<span class="string">"first"</span>: <span class="string">"Curly"</span>,  <span class="string">"last"</span>: <span class="string">"Howard"</span>&#125;,</span><br><span class="line">&#123;<span class="string">"first"</span>: <span class="string">"Moe"</span>,    <span class="string">"last"</span>: <span class="string">"Howard"</span>&#125;,</span><br><span class="line">&#123;<span class="string">"first"</span>: <span class="string">"Shemp"</span>,  <span class="string">"last"</span>: <span class="string">"Howard"</span>&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><hr><h5 id="æ­£åˆ™è¡¨è¾¾å¼-è§£æURL"><a href="#æ­£åˆ™è¡¨è¾¾å¼-è§£æURL" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ - è§£æURL"></a>æ­£åˆ™è¡¨è¾¾å¼ - è§£æURL</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> parse_url = <span class="regexp">/^(?:([A-Za-z]+):)?(\/&#123;0,3&#125;)([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/</span>;</span><br><span class="line"><span class="keyword">var</span> url = <span class="string">"http://www.ora.com:80/goodparts?q#fragment"</span>;</span><br><span class="line"><span class="keyword">var</span> result = parse_url.exec(url);</span><br><span class="line"><span class="keyword">var</span> names = [<span class="string">'url'</span>, <span class="string">'scheme'</span>, <span class="string">'slash'</span>, <span class="string">'host'</span>, <span class="string">'port'</span>, <span class="string">'path'</span>, <span class="string">'query'</span>, <span class="string">'hash'</span>];</span><br><span class="line"><span class="keyword">var</span> blanks = <span class="string">'      '</span>;</span><br><span class="line"><span class="keyword">var</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; names.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"%s:%s%s"</span>, names[i], blanks.substring(names[i].length), result[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> url:   http://www.ora.com:80/goodparts?q#fragment</span></span><br><span class="line"><span class="comment"> scheme:http</span></span><br><span class="line"><span class="comment"> slash: //</span></span><br><span class="line"><span class="comment"> host:  www.ora.com</span></span><br><span class="line"><span class="comment"> port:  80</span></span><br><span class="line"><span class="comment"> path:  goodparts</span></span><br><span class="line"><span class="comment"> query: q</span></span><br><span class="line"><span class="comment"> hash:  fragment</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h5 id="æ­£åˆ™è¡¨è¾¾å¼-éªŒè¯æ•°å­—"><a href="#æ­£åˆ™è¡¨è¾¾å¼-éªŒè¯æ•°å­—" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ - éªŒè¯æ•°å­—"></a>æ­£åˆ™è¡¨è¾¾å¼ - éªŒè¯æ•°å­—</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> parse_number = <span class="regexp">/^-?\d+(?:\.\d*)?(?:e[+\-]?\d+)?$/i</span>;</span><br><span class="line"><span class="keyword">var</span> isNumber = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = parse_number.test(value);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"%s %s a number"</span>, value, result ? <span class="string">"is"</span> : <span class="string">"is not"</span>);</span><br><span class="line">&#125;</span><br><span class="line">isNumber(<span class="string">'1'</span>)</span><br><span class="line"><span class="comment">// 1 is a number</span></span><br><span class="line">isNumber(<span class="string">'number'</span>)</span><br><span class="line"><span class="comment">// number is not a number</span></span><br><span class="line">isNumber(<span class="string">'98.6'</span>)</span><br><span class="line"><span class="comment">// 98.6 is a number</span></span><br><span class="line">isNumber(<span class="string">'132.21.86.100'</span>)</span><br><span class="line"><span class="comment">// 132.21.86.100 is not a number</span></span><br><span class="line">isNumber(<span class="string">'123.45E-67'</span>)</span><br><span class="line"><span class="comment">// 123.45E-67 is a number</span></span><br><span class="line">isNumber(<span class="string">'123.45D-67'</span>)</span><br><span class="line"><span class="comment">//123.45D-67 is not a number</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°å­—å¯èƒ½ç”±ä¸€ä¸ªæ•´æ•°éƒ¨åˆ†åŠ ä¸Šä¸€ä¸ªå¯é€‰çš„è´Ÿå·ã€ä¸€ä¸ªå¯é€‰çš„å°æ•°éƒ¨åˆ†å’Œä¸€ä¸ªå¯é€‰çš„æŒ‡æ•°éƒ¨åˆ†æ„æˆ</span></span><br></pre></td></tr></table></figure><h5 id="æ­£åˆ™è¡¨è¾¾å¼ä¸­32ä¸ªASCIIç‰¹æ®Šå­—ç¬¦é›†åˆï¼š"><a href="#æ­£åˆ™è¡¨è¾¾å¼ä¸­32ä¸ªASCIIç‰¹æ®Šå­—ç¬¦é›†åˆï¼š" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ä¸­32ä¸ªASCIIç‰¹æ®Šå­—ç¬¦é›†åˆï¼š"></a>æ­£åˆ™è¡¨è¾¾å¼ä¸­32ä¸ªASCIIç‰¹æ®Šå­—ç¬¦é›†åˆï¼š</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">!"#$%</span></span><br><span class="line"><span class="comment">&amp;'()*</span></span><br><span class="line"><span class="comment">+,-./</span></span><br><span class="line"><span class="comment">:;&lt;=&gt;</span></span><br><span class="line"><span class="comment">?@[\]</span></span><br><span class="line"><span class="comment">^_`&#123;\</span></span><br><span class="line"><span class="comment">&#125;~</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> ascii32 = <span class="regexp">/(?:!|"|#|\$|%|&amp;|'|\(|\)|\*|\+|,|-|\/|:|;|&lt;|=|&gt;|\?|@|\[|\\|]|\^|_|`|\&#123;|\||\&#125;|~)/</span>;</span><br><span class="line"><span class="comment">// è¿™æ˜¯å…¶ä¸­ä¸€ç§ç®€å†™æ–¹å¼ï¼Œä¸è¿‡ä¾æ—§éš¾ä»¥é˜…è¯»</span></span><br><span class="line"><span class="keyword">var</span> ascii32_short1 = <span class="regexp">/[!-\/:-@\[-`&#123;-~]/</span>;</span><br><span class="line"><span class="comment">// æ­£åˆ™è¡¨è¾¾å¼çš„ä¸€ä¸ªæ–¹ä¾¿ä¹‹å¤„å°±æ˜¯ç±»çš„æ±‚åã€‚å¦‚æœ [ åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ ^ ,é‚£ä¹ˆè¿™ä¸ªç±»ä¼šæ’é™¤è¿™äº›ç‰¹æ®Šå­—ç¬¦ã€‚</span></span><br><span class="line"><span class="keyword">var</span> not_ascii = <span class="regexp">/[^!-\/:-@\[-`&#123;-~]/</span>;</span><br></pre></td></tr></table></figure><hr><h5 id="ç³Ÿç²•"><a href="#ç³Ÿç²•" class="headerlink" title="ç³Ÿç²•"></a>ç³Ÿç²•</h5><p>javascript æœ‰ä¸¤ç»„ç›¸ç­‰è¿ç®—ç¬¦ï¼š=== å’Œ !==, ä»¥åŠå®ƒä»¬é‚ªæ¶çš„å­ªç”Ÿå…„å¼Ÿ == å’Œ !=ã€‚=== å’Œ !== è¿™ä¸€ç»„è¿ç®—ç¬¦ä¼šæŒ‰ç…§ä½ æœŸæœ›çš„æ–¹å¼å·¥ä½œã€‚å¦‚æœæ¥ä¸¤ä¸ªè¿ç®—æ•°ç±»å‹ä¸€è‡´å¹¶ä¸”æ‹¥æœ‰ç›¸åŒçš„å€¼ï¼Œé‚£ä¹ˆ === è¿”å› <code>true</code>ï¼Œ!== è¿”å› <code>false</code>ã€‚è€Œå®ƒä»¬é‚ªæ¶çš„å­ªç”Ÿå…„å¼Ÿåªæœ‰åœ¨ä¸¤ä¸ªè¿ç®—æ•°ç±»å‹ä¸€è‡´æ—¶æ‰ä¼šåšå‡ºæ­£ç¡®çš„åˆ¤æ–­ï¼Œå¦‚æœä¸¤ä¸ªè¿ç®—æ•°æ˜¯ä¸åŒçš„ç±»å‹ï¼Œå®ƒä»¬è¯•å›¾å»å¼ºåˆ¶è½¬æ¢å€¼çš„ç±»å‹ã€‚è½¬æ¢çš„è§„åˆ™å¤æ‚ä¸”éš¾ä»¥è®°å¿†ã€‚è¿™é‡Œæœ‰ä¸€äº›æœ‰è¶£çš„ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">''</span> == <span class="string">'0'</span>           <span class="comment">// false</span></span><br><span class="line"><span class="number">0</span>  == <span class="string">''</span>            <span class="comment">// true</span></span><br><span class="line"><span class="number">0</span>  == <span class="string">'0'</span>           <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="literal">false</span> == <span class="string">'false'</span>    <span class="comment">// false</span></span><br><span class="line"><span class="literal">false</span> == <span class="string">'0'</span>        <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="literal">false</span> == <span class="literal">undefined</span>  <span class="comment">// false</span></span><br><span class="line"><span class="literal">false</span> == <span class="literal">null</span>       <span class="comment">// false</span></span><br><span class="line"><span class="literal">null</span>  == <span class="literal">undefined</span>  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="string">' \t\r\n'</span> == <span class="number">0</span>      <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p> == è¿ç®—ç¬¦å¯¹ä¼ é€’æ€§çš„ç¼ºä¹å€¼å¾—æˆ‘ä»¬è­¦æƒ•ã€‚æˆ‘çš„å»ºè®®æ˜¯æ°¸è¿œä¸è¦ä½¿ç”¨é‚£å¯¹é‚ªæ¶çš„å­ªç”Ÿå…„å¼Ÿã€‚ç›¸åï¼Œè¯·å§‹ç»ˆä½¿ç”¨ === å’Œ !==ã€‚å¦‚æœä»¥ä¸Šæ‰€æœ‰æ¯”è¾ƒä½¿ç”¨ === è¿ç®—ç¬¦ï¼Œç»“æœéƒ½æ˜¯<code>false</code>ã€‚</p><blockquote><p>ä¼ é€’æ€§æ˜¯ä¸€ç§ç¼–ç¨‹çº¦å®šã€‚å¯ä»¥è¿™ä¹ˆç†è§£ï¼šå¯¹äºä»»æ„çš„å¼•ç”¨å€¼xã€yå’Œzï¼Œå¦‚æœ <code>x == y</code> å’Œ <code>y == z</code> ä¸º<code>true</code>ï¼Œé‚£ä¹ˆ<code>x == z</code>ä¸º<code>true</code>ã€‚è€Œjavascriptä¸­çš„ == è¿ç®—ç¬¦åœ¨æŸäº›ç‰¹ä¾‹ä¸Šè¿èƒŒäº†ä¼ é€’æ€§ã€‚</p></blockquote><hr><h5 id="æœ€å-ä»¥ä¸€ä¸ªè‡ªå®šä¹‰çš„JSONè§£æå™¨-ç»“å°¾å§"><a href="#æœ€å-ä»¥ä¸€ä¸ªè‡ªå®šä¹‰çš„JSONè§£æå™¨-ç»“å°¾å§" class="headerlink" title="æœ€å ä»¥ä¸€ä¸ªè‡ªå®šä¹‰çš„JSONè§£æå™¨ ç»“å°¾å§"></a>æœ€å ä»¥ä¸€ä¸ªè‡ªå®šä¹‰çš„JSONè§£æå™¨ ç»“å°¾å§</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªç”¨JavaScriptç¼–å†™JSONè§£æå™¨çš„å®ç°æ–¹æ¡ˆï¼š</span></span><br><span class="line"><span class="keyword">var</span> json_parse = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªèƒ½æŠŠJSONæ–‡æœ¬è§£ææˆJavaScriptæ•°æ®ç»“æ„çš„å‡½æ•°ã€‚</span></span><br><span class="line">    <span class="comment">// å®ƒæ˜¯ä¸€ä¸ªç®€å•çš„é€’å½’é™åºè§£æå™¨ã€‚</span></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬åœ¨å¦ä¸€ä¸ªå‡½æ•°ä¸­å®šä¹‰æ­¤å‡½æ•°ï¼Œä»¥é¿å…åˆ›å»ºå…¨å±€å˜é‡ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> at,         <span class="comment">// å½“å‰å­—ç¬¦ç´¢å¼•</span></span><br><span class="line">        ch,         <span class="comment">// å½“å‰å­—ç¬¦</span></span><br><span class="line">        escapee = &#123;</span><br><span class="line">            <span class="string">'"'</span>     : <span class="string">'"'</span>,</span><br><span class="line">            <span class="string">'\\'</span>    : <span class="string">'\\'</span>,</span><br><span class="line">            <span class="string">'/'</span>     : <span class="string">'/'</span>,</span><br><span class="line">            b       : <span class="string">'b'</span>,</span><br><span class="line">            f       : <span class="string">'\f'</span>,</span><br><span class="line">            n       : <span class="string">'\n'</span>,</span><br><span class="line">            r       : <span class="string">'\r'</span>,</span><br><span class="line">            t       : <span class="string">'\t'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        text,</span><br><span class="line">        error = <span class="function"><span class="keyword">function</span> (<span class="params">m</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// å½“æŸå¤„å‡ºé”™æ—¶ï¼Œè°ƒç”¨errorã€‚</span></span><br><span class="line">            <span class="keyword">throw</span> &#123;</span><br><span class="line">                name    : <span class="string">'SyntaxError'</span>,</span><br><span class="line">                messsage: m,</span><br><span class="line">                at      : at,</span><br><span class="line">                text    : text</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;,</span><br><span class="line">        next = <span class="function"><span class="keyword">function</span> (<span class="params">c</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæä¾›äº†å‚æ•° c, é‚£ä¹ˆæ£€æŸ¥å®ƒæ˜¯å¦åŒ¹é…å½“å‰å­—ç¬¦ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (c &amp;&amp; c !== ch) &#123;</span><br><span class="line">                error(<span class="string">"Expected '"</span> + c + <span class="string">"' insttead of '"</span> + ch + <span class="string">"'"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚å½“æ²¡æœ‰ä¸‹ä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œè¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">            ch = text.charAt(at);</span><br><span class="line">            at += <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> ch;</span><br><span class="line">        &#125;,</span><br><span class="line">        number = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// è§£æä¸€ä¸ªæ•°å­—å€¼ã€‚</span></span><br><span class="line">            <span class="keyword">var</span> number,</span><br><span class="line">                string = <span class="string">''</span>;</span><br><span class="line">            <span class="keyword">if</span> (ch === <span class="string">'-'</span>) &#123;</span><br><span class="line">                string = <span class="string">'-'</span>;</span><br><span class="line">                next(<span class="string">'-'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) &#123;</span><br><span class="line">                string += ch;</span><br><span class="line">                next();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ch === <span class="string">'.'</span>) &#123;</span><br><span class="line">                string += <span class="string">"."</span>;</span><br><span class="line">                <span class="keyword">while</span> (next() &amp;&amp; ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) &#123;</span><br><span class="line">                    string += ch;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ch == <span class="string">'e'</span> || ch == <span class="string">'E'</span>) &#123;</span><br><span class="line">                string += ch;</span><br><span class="line">                next();</span><br><span class="line">                <span class="keyword">if</span> (ch === <span class="string">'-'</span> || ch === <span class="string">'+'</span>) &#123;</span><br><span class="line">                    string += ch;</span><br><span class="line">                    next();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) &#123;</span><br><span class="line">                    string += ch;</span><br><span class="line">                    next();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            number = +string;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isNaN</span>(number)) &#123;</span><br><span class="line">                error(<span class="string">"Bad number"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> number;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        string = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// è§£æä¸€ä¸ªå­—ç¬¦ä¸²å€¼ã€‚</span></span><br><span class="line">            <span class="keyword">var</span> hex,</span><br><span class="line">                i,</span><br><span class="line">                string = <span class="string">''</span>,</span><br><span class="line">                uffff;</span><br><span class="line">            <span class="comment">// å½“è§£æå­—ç¬¦ä¸²å€¼æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ° " å’Œ \ å­—ç¬¦ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (ch === <span class="string">'"'</span>) &#123;</span><br><span class="line">                <span class="keyword">while</span> (next()) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (ch === <span class="string">'"'</span>) &#123;</span><br><span class="line">                        next();</span><br><span class="line">                        <span class="keyword">return</span> string;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ch === <span class="string">'\\'</span>) &#123;</span><br><span class="line">                        next();</span><br><span class="line">                        <span class="keyword">if</span> (ch === <span class="string">'u'</span>) &#123;</span><br><span class="line">                            uffff = <span class="number">0</span>;</span><br><span class="line">                            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i += <span class="number">1</span>) &#123;</span><br><span class="line">                                hex = <span class="built_in">parseInt</span>(next(), <span class="number">16</span>);</span><br><span class="line">                                <span class="keyword">if</span> (!<span class="built_in">isFinite</span>(hex)) &#123;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                uffff = uffff * <span class="number">16</span> + hex;</span><br><span class="line">                            &#125;</span><br><span class="line">                            string += <span class="built_in">String</span>.fromCharCode(uffff);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> escapee[ch] === <span class="string">'string'</span>) &#123;</span><br><span class="line">                            string += escapee[ch];</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        string += ch;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            error(<span class="string">"Bad string"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        white = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// è·³è¿‡ç©ºç™½</span></span><br><span class="line">            <span class="keyword">while</span> (ch &amp;&amp; ch &lt;= <span class="string">' '</span>) &#123;</span><br><span class="line">                next();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        word = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// true, false æˆ–è€… null</span></span><br><span class="line">            <span class="keyword">switch</span> (ch) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'t'</span>:</span><br><span class="line">                    next(<span class="string">'t'</span>);</span><br><span class="line">                    next(<span class="string">'r'</span>);</span><br><span class="line">                    next(<span class="string">'u'</span>);</span><br><span class="line">                    next(<span class="string">'e'</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'f'</span>:</span><br><span class="line">                    next(<span class="string">'f'</span>);</span><br><span class="line">                    next(<span class="string">'a'</span>);</span><br><span class="line">                    next(<span class="string">'l'</span>);</span><br><span class="line">                    next(<span class="string">'s'</span>);</span><br><span class="line">                    next(<span class="string">'e'</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'n'</span>:</span><br><span class="line">                    next(<span class="string">'n'</span>);</span><br><span class="line">                    next(<span class="string">'u'</span>);</span><br><span class="line">                    next(<span class="string">'l'</span>);</span><br><span class="line">                    next(<span class="string">'l'</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            error(<span class="string">"Unexpected '"</span> + ch + <span class="string">"'"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        value,  <span class="comment">// å€¼å‡½æ•°çš„å ä½ç¬¦ã€‚</span></span><br><span class="line">        array = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// è§£æä¸€ä¸ªæ•°ç»„å€¼ã€‚</span></span><br><span class="line">            <span class="keyword">var</span> array = [];</span><br><span class="line">            <span class="keyword">if</span> (ch === <span class="string">'['</span>) &#123;</span><br><span class="line">                white();</span><br><span class="line">                <span class="keyword">if</span> (ch === <span class="string">']'</span>) &#123;</span><br><span class="line">                    next(<span class="string">']'</span>);</span><br><span class="line">                    <span class="keyword">return</span> array;   <span class="comment">// ç©ºæ•°ç»„</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (ch) &#123;</span><br><span class="line">                    array.push(value());</span><br><span class="line">                    white();</span><br><span class="line">                    <span class="keyword">if</span> (ch === <span class="string">"]"</span>) &#123;</span><br><span class="line">                        next(<span class="string">']'</span>);</span><br><span class="line">                        <span class="keyword">return</span> array;</span><br><span class="line">                    &#125;</span><br><span class="line">                    next(<span class="string">','</span>);</span><br><span class="line">                    white();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            error(<span class="string">"Bad array"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        object = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// è§£æä¸€ä¸ªå¯¹è±¡å€¼</span></span><br><span class="line">            <span class="keyword">var</span> key,</span><br><span class="line">                object = &#123;&#125;;</span><br><span class="line">            <span class="keyword">if</span>(ch === <span class="string">'&#123;'</span>) &#123;</span><br><span class="line">                next(<span class="string">'&#123;'</span>);</span><br><span class="line">                white();</span><br><span class="line">                <span class="keyword">if</span> (ch === <span class="string">"&#125;"</span>) &#123;</span><br><span class="line">                    next(<span class="string">'&#125;'</span>);</span><br><span class="line">                    <span class="keyword">return</span> object;  <span class="comment">// ç©ºå¯¹è±¡</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (ch) &#123;</span><br><span class="line">                    key = string();</span><br><span class="line">                    white();</span><br><span class="line">                    next(<span class="string">":"</span>);</span><br><span class="line">                    object[key] = value();</span><br><span class="line">                    white();</span><br><span class="line">                    <span class="keyword">if</span>(ch === <span class="string">'&#125;'</span>) &#123;</span><br><span class="line">                        next(<span class="string">'&#125;'</span>);</span><br><span class="line">                        <span class="keyword">return</span> object;</span><br><span class="line">                    &#125;</span><br><span class="line">                    next(<span class="string">","</span>);</span><br><span class="line">                    white();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            error(<span class="string">"Bad object"</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    value = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è§£æä¸€ä¸ªJSONå€¼ã€‚å®ƒå¯ä»¥æ˜¯å¯¹è±¡ã€æ•°ç»„ã€å­—ç¬¦ä¸²ã€æ•°å­—æˆ–ä¸€ä¸ªè¯ã€‚</span></span><br><span class="line">        white();</span><br><span class="line">        <span class="keyword">switch</span> (ch) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'&#123;'</span>:</span><br><span class="line">                <span class="keyword">return</span> object();</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'['</span>:</span><br><span class="line">                <span class="keyword">return</span> array();</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'"'</span>:</span><br><span class="line">                <span class="keyword">return</span> string();</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"-"</span>:</span><br><span class="line">                <span class="keyword">return</span> number();</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span> ? number() : word() ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// è¿”å›json_parse å‡½æ•°ã€‚å®ƒèƒ½è®¿é—®ä¸Šè¿°æ‰€æœ‰çš„å‡½æ•°å’Œå˜é‡ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">source, reviver</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> result;</span><br><span class="line">        text = source;</span><br><span class="line">        at = <span class="number">0</span>;</span><br><span class="line">        ch = <span class="string">' '</span>;</span><br><span class="line">        result = value();</span><br><span class="line">        white();</span><br><span class="line">        <span class="keyword">if</span> (ch) &#123;</span><br><span class="line">            error(<span class="string">"Syntax error"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœå­˜åœ¨reviver å‡½æ•°ï¼Œæˆ‘ä»¬å°±é€’å½’åœ°å¯¹è¿™ä¸ªæ–°ç»“æ„è°ƒç”¨walkå‡½æ•°ï¼Œ</span></span><br><span class="line">        <span class="comment">// å¼€å§‹æ—¶å…ˆåˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„å¯åŠ¨å¯¹è±¡ï¼Œå¹¶ä»¥ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ä½œä¸ºé”®åä¿å­˜ç»“æœï¼Œ</span></span><br><span class="line">        <span class="comment">// ç„¶åä¼ é€’æ¯ä¸ªé”®å€¼å¯¹ç»™reviverå‡½æ•°å»å¤„ç†å¯èƒ½å­˜åœ¨çš„è½¬æ¢ã€‚</span></span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰reviverå‡½æ•°ï¼Œæˆ‘ä»¬å°±ç®€å•åœ°è¿”å›è¿™ä¸ªç»“æœã€‚</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">typeof</span> reviver === <span class="string">'function'</span> ?</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">walk</span>(<span class="params">holder, key</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> k, v, value = holder[key];</span><br><span class="line">                <span class="keyword">if</span> (value &amp;&amp; <span class="keyword">typeof</span> value === <span class="string">'object'</span>) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (k <span class="keyword">in</span> value) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">Object</span>.hasOwnProperty.call(value, k)) &#123;</span><br><span class="line">                            v = walk(value, k);</span><br><span class="line">                            <span class="keyword">if</span> (v !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">                                value[k] = v;</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="keyword">delete</span> value[k];</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> reviver.call(holder, key, value);</span><br><span class="line">            &#125;(&#123;<span class="string">''</span>: result&#125;, <span class="string">''</span>)</span><br><span class="line">            : result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure><h2 id="This-is-the-end"><a href="#This-is-the-end" class="headerlink" title="This is the end."></a>This is the end.</h2><p>æ­£æ–‡éƒ¨åˆ†åˆ°æ­¤ç»“æŸã€‚<br>ç¬¬ä¸€æ¬¡å†™è¯»ä¹¦ç¬”è®°ï¼Œä¸€æ˜¯åŠ æ·±è‡ªå·±çš„å°è±¡ï¼ŒäºŒæ¥æ–¹ä¾¿ä»¥åæŸ¥é˜…ï¼Œæ¯•ç«Ÿçº¸å¼ æ²¡æœ‰æœç´¢åŠŸèƒ½ã€‚<br>å¦‚æœä½ ä¹Ÿå–œæ¬¢è¿™ç¯‡æ–‡ç« æ¬¢è¿è½¬è½½ï¼Œä½†æœ¬æ–‡ä»£ç ç‰ˆæƒå±äºã€ŠJavaScript è¯­è¨€ç²¾ç²¹ã€‹ï¼Œå°éƒ¨åˆ†ä»£ç æ‰©å……æ˜¯ä¸ºäº†æ¼”ç¤ºä»£ç æ•ˆæœã€‚</p>]]></content>
    
    <summary type="html">
    
      ç¬¬ä¸€æ¬¡å†™è¯»ä¹¦ç¬”è®°ï¼Œä¸€æ˜¯åŠ æ·±è‡ªå·±çš„å°è±¡ï¼ŒäºŒæ¥æ–¹ä¾¿ä»¥åæŸ¥é˜…ï¼Œæ¯•ç«Ÿçº¸å¼ æ²¡æœ‰æœç´¢åŠŸèƒ½ã€‚å¦‚æœä½ ä¹Ÿå–œæ¬¢è¿™ç¯‡æ–‡ç« æ¬¢è¿è½¬è½½ï¼Œä½†æœ¬æ–‡ä»£ç ç‰ˆæƒå±äºã€ŠJavaScriptè¯­è¨€ç²¾ç²¹ã€‹ï¼Œå°éƒ¨åˆ†ä»£ç æ‰©å……æ˜¯ä¸ºäº†æ¼”ç¤ºä»£ç æ•ˆæœã€‚
    
    </summary>
    
      <category term="Notes" scheme="https://mrzzcn.github.io/categories/Notes/"/>
    
    
      <category term="Javascript" scheme="https://mrzzcn.github.io/tags/Javascript/"/>
    
      <category term="Douglas-Crockford" scheme="https://mrzzcn.github.io/tags/Douglas-Crockford/"/>
    
      <category term="æœ€ä½³å®è·µ" scheme="https://mrzzcn.github.io/tags/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"/>
    
  </entry>
  
</feed>
